+ umask 000

+ export GIT_LFS_SKIP_SMUDGE=1

+ retry 6 git clone --branch="feature/initial-forecasting" --depth 50 https://x-token-auth:$REPOSITORY_OAUTH_ACCESS_TOKEN@bitbucket.org/$BITBUCKET_REPO_FULL_NAME.git $BUILD_DIR
Cloning into '/opt/atlassian/pipelines/agent/build'...
Updating files:   0% (25/52503)
Updating files:   0% (33/52503)
Updating files:   0% (35/52503)
Updating files:   1% (526/52503)
Updating files:   2% (1051/52503)
Updating files:   3% (1576/52503)
Updating files:   4% (2101/52503)
Updating files:   4% (2114/52503)
Updating files:   5% (2626/52503)
Updating files:   6% (3151/52503)
Updating files:   7% (3676/52503)
Updating files:   8% (4201/52503)
Updating files:   9% (4726/52503)
Updating files:  10% (5251/52503)
Updating files:  11% (5776/52503)
Updating files:  12% (6301/52503)
Updating files:  13% (6826/52503)
Updating files:  14% (7351/52503)
Updating files:  15% (7876/52503)
Updating files:  16% (8401/52503)
Updating files:  16% (8627/52503)
Updating files:  17% (8926/52503)
Updating files:  17% (9220/52503)
Updating files:  18% (9451/52503)
Updating files:  19% (9976/52503)
Updating files:  20% (10501/52503)
Updating files:  21% (11026/52503)
Updating files:  22% (11551/52503)
Updating files:  22% (11843/52503)
Updating files:  23% (12076/52503)
Updating files:  24% (12601/52503)
Updating files:  25% (13126/52503)
Updating files:  25% (13294/52503)
Updating files:  26% (13651/52503)
Updating files:  27% (14176/52503)
Updating files:  28% (14701/52503)
Updating files:  29% (15226/52503)
Updating files:  30% (15751/52503)
Updating files:  31% (16276/52503)
Updating files:  32% (16801/52503)
Updating files:  33% (17326/52503)
Updating files:  34% (17852/52503)
Updating files:  35% (18377/52503)
Updating files:  36% (18902/52503)
Updating files:  37% (19427/52503)
Updating files:  38% (19952/52503)
Updating files:  39% (20477/52503)
Updating files:  40% (21002/52503)
Updating files:  41% (21527/52503)
Updating files:  42% (22052/52503)
Updating files:  43% (22577/52503)
Updating files:  44% (23102/52503)
Updating files:  44% (23549/52503)
Updating files:  45% (23627/52503)
Updating files:  46% (24152/52503)
Updating files:  47% (24677/52503)
Updating files:  48% (25202/52503)
Updating files:  49% (25727/52503)
Updating files:  50% (26252/52503)
Updating files:  51% (26777/52503)
Updating files:  52% (27302/52503)
Updating files:  53% (27827/52503)
Updating files:  54% (28352/52503)
Updating files:  55% (28877/52503)
Updating files:  55% (28914/52503)
Updating files:  56% (29402/52503)
Updating files:  57% (29927/52503)
Updating files:  58% (30452/52503)
Updating files:  58% (30518/52503)
Updating files:  59% (30977/52503)
Updating files:  60% (31502/52503)
Updating files:  61% (32027/52503)
Updating files:  62% (32552/52503)
Updating files:  62% (32803/52503)
Updating files:  63% (33077/52503)
Updating files:  64% (33602/52503)
Updating files:  65% (34127/52503)
Updating files:  66% (34652/52503)
Updating files:  67% (35178/52503)
Updating files:  68% (35703/52503)
Updating files:  69% (36228/52503)
Updating files:  70% (36753/52503)
Updating files:  71% (37278/52503)
Updating files:  71% (37417/52503)
Updating files:  72% (37803/52503)
Updating files:  73% (38328/52503)
Updating files:  74% (38853/52503)
Updating files:  75% (39378/52503)
Updating files:  76% (39903/52503)
Updating files:  77% (40428/52503)
Updating files:  78% (40953/52503)
Updating files:  79% (41478/52503)
Updating files:  80% (42003/52503)
Updating files:  81% (42528/52503)
Updating files:  82% (43053/52503)
Updating files:  83% (43578/52503)
Updating files:  84% (44103/52503)
Updating files:  85% (44628/52503)
Updating files:  86% (45153/52503)
Updating files:  87% (45678/52503)
Updating files:  88% (46203/52503)
Updating files:  88% (46233/52503)
Updating files:  88% (46260/52503)
Updating files:  89% (46728/52503)
Updating files:  89% (46882/52503)
Updating files:  90% (47253/52503)
Updating files:  91% (47778/52503)
Updating files:  92% (48303/52503)
Updating files:  93% (48828/52503)
Updating files:  94% (49353/52503)
Updating files:  95% (49878/52503)
Updating files:  96% (50403/52503)
Updating files:  97% (50928/52503)
Updating files:  98% (51453/52503)
Updating files:  99% (51978/52503)
Updating files:  99% (52277/52503)
Updating files: 100% (52503/52503)
Updating files: 100% (52503/52503), done.

+ git reset --hard 016d943ab6638e9cd0c1538d629fd4978e772dd6
HEAD is now at 016d943a Format code with Black

+ git config user.name bitbucket-pipelines

+ git config user.email commits-noreply@bitbucket.org

+ git config push.default current

+ git config http.${BITBUCKET_GIT_HTTP_ORIGIN}.proxy http://localhost:29418/

+ git remote set-url origin http://bitbucket.org/$BITBUCKET_REPO_FULL_NAME

+ git reflog expire --expire=all --all

+ echo ".bitbucket/pipelines/generated" >> .git/info/exclude

+ chmod 777 $BUILD_DIR


Default variables:
    BITBUCKET_BRANCH
    BITBUCKET_BUILD_NUMBER
    BITBUCKET_CLONE_DIR
    BITBUCKET_COMMIT
    BITBUCKET_GIT_HTTP_ORIGIN
    BITBUCKET_GIT_SSH_ORIGIN
    BITBUCKET_PARALLEL_STEP
    BITBUCKET_PARALLEL_STEP_COUNT
    BITBUCKET_PIPELINES_VARIABLES_PATH
    BITBUCKET_PIPELINE_UUID
    BITBUCKET_PROJECT_KEY
    BITBUCKET_PROJECT_UUID
    BITBUCKET_REPO_FULL_NAME
    BITBUCKET_REPO_IS_PRIVATE
    BITBUCKET_REPO_OWNER
    BITBUCKET_REPO_OWNER_UUID
    BITBUCKET_REPO_SLUG
    BITBUCKET_REPO_UUID
    BITBUCKET_SSH_KEY_FILE
    BITBUCKET_STEP_RUN_NUMBER
    BITBUCKET_STEP_TRIGGERER_UUID
    BITBUCKET_STEP_UUID
    BITBUCKET_WORKSPACE
    CI
    DOCKER_HOST
    PIPELINES_JWT_TOKEN

Images used:
    build : docker.io/library/python@sha256:875c3591e586f66aa65621926230925144920c951902a6c2eef005d9783a7ca7

Runtime:
    cloud:
        version: 2
        arch: x86
+ pip install -r requirements.txt
Collecting fastapi==0.103.1
  Downloading fastapi-0.103.1-py3-none-any.whl (66 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 66.2/66.2 kB 3.2 MB/s eta 0:00:00
Collecting uvicorn==0.23.2
  Downloading uvicorn-0.23.2-py3-none-any.whl (59 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 59.5/59.5 kB 13.0 MB/s eta 0:00:00
Collecting python-dotenv==1.0.1
  Downloading python_dotenv-1.0.1-py3-none-any.whl (19 kB)
Collecting pydantic==2.3.0
  Downloading pydantic-2.3.0-py3-none-any.whl (374 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 374.5/374.5 kB 36.7 MB/s eta 0:00:00
Collecting pandas==2.1.4
  Downloading pandas-2.1.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.3/12.3 MB 91.9 MB/s eta 0:00:00
Collecting numpy==1.24.3
  Downloading numpy-1.24.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 17.3/17.3 MB 88.7 MB/s eta 0:00:00
Collecting sqlalchemy==1.4.49
  Downloading SQLAlchemy-1.4.49-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 78.8 MB/s eta 0:00:00
Collecting psycopg2-binary==2.9.9
  Downloading psycopg2_binary-2.9.9-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.0/3.0 MB 93.5 MB/s eta 0:00:00
Collecting python-multipart==0.0.6
  Downloading python_multipart-0.0.6-py3-none-any.whl (45 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 45.7/45.7 kB 9.9 MB/s eta 0:00:00
Collecting black==24.4.2
  Downloading black-24.4.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 88.2 MB/s eta 0:00:00
Collecting matplotlib==3.7.2
  Downloading matplotlib-3.7.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 11.6/11.6 MB 95.3 MB/s eta 0:00:00
Collecting seaborn==0.12.2
  Downloading seaborn-0.12.2-py3-none-any.whl (293 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 293.3/293.3 kB 39.4 MB/s eta 0:00:00
Collecting plotly==5.18.0
  Downloading plotly-5.18.0-py3-none-any.whl (15.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 15.6/15.6 MB 74.0 MB/s eta 0:00:00
Collecting prophet==1.1.4
  Downloading prophet-1.1.4-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.0/13.0 MB 62.9 MB/s eta 0:00:00
Collecting scikit-learn==1.3.0
  Downloading scikit_learn-1.3.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (10.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.8/10.8 MB 84.6 MB/s eta 0:00:00
Collecting joblib==1.3.2
  Downloading joblib-1.3.2-py3-none-any.whl (302 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 302.2/302.2 kB 55.3 MB/s eta 0:00:00
Collecting shap==0.42.1
  Downloading shap-0.42.1-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (547 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 547.9/547.9 kB 75.7 MB/s eta 0:00:00
Collecting supabase==1.0.3
  Downloading supabase-1.0.3-py3-none-any.whl (11 kB)
Collecting httpx==0.23.3
  Downloading httpx-0.23.3-py3-none-any.whl (71 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 71.5/71.5 kB 16.8 MB/s eta 0:00:00
Collecting asyncpg==0.29.0
  Downloading asyncpg-0.29.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.7/2.7 MB 100.9 MB/s eta 0:00:00
Collecting cachetools==5.3.3
  Downloading cachetools-5.3.3-py3-none-any.whl (9.3 kB)
Collecting pytest==7.4.0
  Downloading pytest-7.4.0-py3-none-any.whl (323 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 323.6/323.6 kB 39.6 MB/s eta 0:00:00
Collecting coverage==7.3.2
  Downloading coverage-7.3.2-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (227 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 227.5/227.5 kB 47.9 MB/s eta 0:00:00
Collecting tqdm==4.66.1
  Downloading tqdm-4.66.1-py3-none-any.whl (78 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 78.3/78.3 kB 18.4 MB/s eta 0:00:00
Collecting starlette<0.28.0,>=0.27.0
  Downloading starlette-0.27.0-py3-none-any.whl (66 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 67.0/67.0 kB 6.6 MB/s eta 0:00:00
Collecting anyio<4.0.0,>=3.7.1
  Downloading anyio-3.7.1-py3-none-any.whl (80 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 80.9/80.9 kB 15.9 MB/s eta 0:00:00
Collecting typing-extensions>=4.5.0
  Downloading typing_extensions-4.14.1-py3-none-any.whl (43 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 43.9/43.9 kB 9.6 MB/s eta 0:00:00
Collecting h11>=0.8
  Downloading h11-0.16.0-py3-none-any.whl (37 kB)
Collecting click>=7.0
  Downloading click-8.2.1-py3-none-any.whl (102 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 102.2/102.2 kB 9.0 MB/s eta 0:00:00
Collecting pydantic-core==2.6.3
  Downloading pydantic_core-2.6.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.9/1.9 MB 78.8 MB/s eta 0:00:00
Collecting annotated-types>=0.4.0
  Downloading annotated_types-0.7.0-py3-none-any.whl (13 kB)
Collecting tzdata>=2022.1
  Downloading tzdata-2025.2-py2.py3-none-any.whl (347 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 347.8/347.8 kB 51.4 MB/s eta 0:00:00
Collecting pytz>=2020.1
  Downloading pytz-2025.2-py2.py3-none-any.whl (509 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 509.2/509.2 kB 50.7 MB/s eta 0:00:00
Collecting python-dateutil>=2.8.2
  Downloading python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 229.9/229.9 kB 19.2 MB/s eta 0:00:00
Collecting greenlet!=0.4.17
  Downloading greenlet-3.2.3-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (582 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 582.2/582.2 kB 56.6 MB/s eta 0:00:00
Collecting platformdirs>=2
  Downloading platformdirs-4.3.8-py3-none-any.whl (18 kB)
Collecting pathspec>=0.9.0
  Downloading pathspec-0.12.1-py3-none-any.whl (31 kB)
Collecting tomli>=1.1.0
  Downloading tomli-2.2.1-py3-none-any.whl (14 kB)
Collecting packaging>=22.0
  Downloading packaging-25.0-py3-none-any.whl (66 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 66.5/66.5 kB 15.6 MB/s eta 0:00:00
Collecting mypy-extensions>=0.4.3
  Downloading mypy_extensions-1.1.0-py3-none-any.whl (5.0 kB)
Collecting fonttools>=4.22.0
  Downloading fonttools-4.58.5-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (4.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.8/4.8 MB 81.4 MB/s eta 0:00:00
Collecting contourpy>=1.0.1
  Downloading contourpy-1.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (325 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 325.0/325.0 kB 50.9 MB/s eta 0:00:00
Collecting pyparsing<3.1,>=2.3.1
  Downloading pyparsing-3.0.9-py3-none-any.whl (98 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 98.3/98.3 kB 22.7 MB/s eta 0:00:00
Collecting pillow>=6.2.0
  Downloading pillow-11.3.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (6.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.6/6.6 MB 64.4 MB/s eta 0:00:00
Collecting cycler>=0.10
  Downloading cycler-0.12.1-py3-none-any.whl (8.3 kB)
Collecting kiwisolver>=1.0.1
  Downloading kiwisolver-1.4.8-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 90.0 MB/s eta 0:00:00
Collecting tenacity>=6.2.0
  Downloading tenacity-9.1.2-py3-none-any.whl (28 kB)
Collecting convertdate>=2.1.2
  Downloading convertdate-2.4.0-py3-none-any.whl (47 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 47.9/47.9 kB 11.8 MB/s eta 0:00:00
Collecting LunarCalendar>=0.0.9
  Downloading LunarCalendar-0.0.9-py2.py3-none-any.whl (18 kB)
Collecting cmdstanpy>=1.0.4
  Downloading cmdstanpy-1.2.5-py3-none-any.whl (94 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 94.5/94.5 kB 20.9 MB/s eta 0:00:00
Collecting holidays>=0.25
  Downloading holidays-0.76-py3-none-any.whl (1.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.1/1.1 MB 73.2 MB/s eta 0:00:00
Collecting importlib-resources
  Downloading importlib_resources-6.5.2-py3-none-any.whl (37 kB)
Collecting threadpoolctl>=2.0.0
  Downloading threadpoolctl-3.6.0-py3-none-any.whl (18 kB)
Collecting scipy>=1.5.0
  Downloading scipy-1.15.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (37.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 37.7/37.7 MB 25.8 MB/s eta 0:00:00
Collecting numba
  Downloading numba-0.61.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (3.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.8/3.8 MB 136.3 MB/s eta 0:00:00
Collecting cloudpickle
  Downloading cloudpickle-3.1.1-py3-none-any.whl (20 kB)
Collecting slicer==0.0.7
  Downloading slicer-0.0.7-py3-none-any.whl (14 kB)
Collecting python-semantic-release==7.33.2
  Downloading python_semantic_release-7.33.2-py3-none-any.whl (55 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 55.1/55.1 kB 16.1 MB/s eta 0:00:00
Collecting gotrue<2.0.0,>=1.0.1
  Downloading gotrue-1.3.1-py3-none-any.whl (42 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 42.3/42.3 kB 11.9 MB/s eta 0:00:00
Collecting postgrest<0.11.0,>=0.10.6
  Downloading postgrest-0.10.8-py3-none-any.whl (18 kB)
Collecting supafunc<0.3.0,>=0.2.2
  Downloading supafunc-0.2.4-py3-none-any.whl (6.1 kB)
Collecting storage3<0.6.0,>=0.5.2
  Downloading storage3-0.5.4-py3-none-any.whl (14 kB)
Collecting realtime<2.0.0,>=1.0.0
  Downloading realtime-1.0.6-py3-none-any.whl (9.0 kB)
Collecting httpcore<0.17.0,>=0.15.0
  Downloading httpcore-0.16.3-py3-none-any.whl (69 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 69.6/69.6 kB 17.5 MB/s eta 0:00:00
Collecting sniffio
  Downloading sniffio-1.3.1-py3-none-any.whl (10 kB)
Collecting certifi
  Downloading certifi-2025.7.9-py3-none-any.whl (159 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 159.2/159.2 kB 27.5 MB/s eta 0:00:00
Collecting rfc3986[idna2008]<2,>=1.3
  Downloading rfc3986-1.5.0-py2.py3-none-any.whl (31 kB)
Collecting async-timeout>=4.0.3
  Downloading async_timeout-5.0.1-py3-none-any.whl (6.2 kB)
Collecting iniconfig
  Downloading iniconfig-2.1.0-py3-none-any.whl (6.0 kB)
Collecting exceptiongroup>=1.0.0rc8
  Downloading exceptiongroup-1.3.0-py3-none-any.whl (16 kB)
Collecting pluggy<2.0,>=0.12
  Downloading pluggy-1.6.0-py3-none-any.whl (20 kB)
Collecting tomlkit~=0.10
  Downloading tomlkit-0.13.3-py3-none-any.whl (38 kB)
Collecting gitpython<4,>=3.0.8
  Downloading GitPython-3.1.44-py3-none-any.whl (207 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 207.6/207.6 kB 42.0 MB/s eta 0:00:00
Requirement already satisfied: wheel in /usr/local/lib/python3.10/site-packages (from python-semantic-release==7.33.2->supabase==1.0.3->-r requirements.txt (line 25)) (0.45.1)
Collecting requests<3,>=2.25
  Downloading requests-2.32.4-py3-none-any.whl (64 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 64.8/64.8 kB 15.4 MB/s eta 0:00:00
Collecting dotty-dict<2,>=1.3.0
  Downloading dotty_dict-1.3.1-py3-none-any.whl (7.0 kB)
Collecting semver<3,>=2.10
  Downloading semver-2.13.0-py2.py3-none-any.whl (12 kB)
Collecting python-gitlab<4,>=2
  Downloading python_gitlab-3.15.0-py3-none-any.whl (135 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 135.9/135.9 kB 30.0 MB/s eta 0:00:00
Collecting click-log<1,>=0.3
  Downloading click_log-0.4.0-py2.py3-none-any.whl (4.3 kB)
Collecting twine<4,>=3
  Downloading twine-3.8.0-py3-none-any.whl (36 kB)
Collecting invoke<2,>=1.4.1
  Downloading invoke-1.7.3-py3-none-any.whl (216 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 216.4/216.4 kB 38.6 MB/s eta 0:00:00
Collecting idna>=2.8
  Downloading idna-3.10-py3-none-any.whl (70 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 70.4/70.4 kB 9.2 MB/s eta 0:00:00
Collecting stanio<2.0.0,>=0.4.0
  Downloading stanio-0.5.1-py3-none-any.whl (8.1 kB)
Collecting pymeeus<=1,>=0.3.13
  Downloading PyMeeus-0.5.12.tar.gz (5.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.8/5.8 MB 130.7 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting h11>=0.8
  Downloading h11-0.14.0-py3-none-any.whl (58 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 58.3/58.3 kB 8.1 MB/s eta 0:00:00
Collecting ephem>=3.7.5.3
  Downloading ephem-4.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 69.3 MB/s eta 0:00:00
Collecting deprecation<3.0.0,>=2.1.0
  Downloading deprecation-2.1.0-py2.py3-none-any.whl (11 kB)
Collecting postgrest<0.11.0,>=0.10.6
  Downloading postgrest-0.10.7-py3-none-any.whl (18 kB)
Collecting strenum<0.5.0,>=0.4.9
  Downloading StrEnum-0.4.15-py3-none-any.whl (8.9 kB)
Collecting six>=1.5
  Downloading six-1.17.0-py2.py3-none-any.whl (11 kB)
Collecting websockets<13,>=11
  Downloading websockets-12.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (130 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 130.2/130.2 kB 32.4 MB/s eta 0:00:00
Collecting storage3<0.6.0,>=0.5.2
  Downloading storage3-0.5.3-py3-none-any.whl (14 kB)
Collecting supafunc<0.3.0,>=0.2.2
  Downloading supafunc-0.2.3-py3-none-any.whl (2.8 kB)
  Downloading supafunc-0.2.2-py3-none-any.whl (2.8 kB)
Collecting llvmlite<0.45,>=0.44.0dev0
  Downloading llvmlite-0.44.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (42.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 42.4/42.4 MB 19.5 MB/s eta 0:00:00
Collecting gitdb<5,>=4.0.1
  Downloading gitdb-4.0.12-py3-none-any.whl (62 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.8/62.8 kB 9.7 MB/s eta 0:00:00
Collecting requests-toolbelt>=0.10.1
  Downloading requests_toolbelt-1.0.0-py2.py3-none-any.whl (54 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 54.5/54.5 kB 14.5 MB/s eta 0:00:00
Collecting charset_normalizer<4,>=2
  Downloading charset_normalizer-3.4.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 149.5/149.5 kB 30.0 MB/s eta 0:00:00
Collecting urllib3<3,>=1.21.1
  Downloading urllib3-2.5.0-py3-none-any.whl (129 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 129.8/129.8 kB 18.3 MB/s eta 0:00:00
Collecting pkginfo>=1.8.1
  Downloading pkginfo-1.12.1.2-py3-none-any.whl (32 kB)
Collecting readme-renderer>=21.0
  Downloading readme_renderer-44.0-py3-none-any.whl (13 kB)
Collecting importlib-metadata>=3.6
  Downloading importlib_metadata-8.7.0-py3-none-any.whl (27 kB)
Collecting keyring>=15.1
  Downloading keyring-25.6.0-py3-none-any.whl (39 kB)
Collecting colorama>=0.4.3
  Downloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)
Collecting smmap<6,>=3.0.1
  Downloading smmap-5.0.2-py3-none-any.whl (24 kB)
Collecting zipp>=3.20
  Downloading zipp-3.23.0-py3-none-any.whl (10 kB)
Collecting jaraco.context
  Downloading jaraco.context-6.0.1-py3-none-any.whl (6.8 kB)
Collecting jeepney>=0.4.2
  Downloading jeepney-0.9.0-py3-none-any.whl (49 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 49.0/49.0 kB 7.7 MB/s eta 0:00:00
Collecting jaraco.classes
  Downloading jaraco.classes-3.4.0-py3-none-any.whl (6.8 kB)
Collecting SecretStorage>=3.2
  Downloading SecretStorage-3.3.3-py3-none-any.whl (15 kB)
Collecting jaraco.functools
  Downloading jaraco_functools-4.2.1-py3-none-any.whl (10 kB)
Collecting nh3>=0.2.14
  Downloading nh3-0.2.21-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (739 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 739.0/739.0 kB 73.8 MB/s eta 0:00:00
Collecting docutils>=0.21.2
  Downloading docutils-0.21.2-py3-none-any.whl (587 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 587.4/587.4 kB 84.6 MB/s eta 0:00:00
Collecting Pygments>=2.5.1
  Downloading pygments-2.19.2-py3-none-any.whl (1.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 84.5 MB/s eta 0:00:00
Collecting cryptography>=2.0
  Downloading cryptography-45.0.5-cp37-abi3-manylinux_2_34_x86_64.whl (4.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.4/4.4 MB 85.9 MB/s eta 0:00:00
Collecting more-itertools
  Downloading more_itertools-10.7.0-py3-none-any.whl (65 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 65.3/65.3 kB 13.8 MB/s eta 0:00:00
Collecting backports.tarfile
  Downloading backports.tarfile-1.2.0-py3-none-any.whl (30 kB)
Collecting cffi>=1.14
  Downloading cffi-1.17.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (446 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 446.2/446.2 kB 52.5 MB/s eta 0:00:00
Collecting pycparser
  Downloading pycparser-2.22-py3-none-any.whl (117 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 117.6/117.6 kB 28.8 MB/s eta 0:00:00
Building wheels for collected packages: pymeeus
  Building wheel for pymeeus (setup.py): started
  Building wheel for pymeeus (setup.py): finished with status 'done'
  Created wheel for pymeeus: filename=PyMeeus-0.5.12-py3-none-any.whl size=732000 sha256=721c195448115eb3f2e54fc6775939ea06e50becd10ed111ccb45080e9e260b3
  Stored in directory: /root/.cache/pip/wheels/d6/67/78/aa2e8d108639dd23a5e9e72a4fc88bb44f5541894382712f48
Successfully built pymeeus
Installing collected packages: strenum, rfc3986, pytz, pymeeus, invoke, ephem, zipp, websockets, urllib3, tzdata, typing-extensions, tqdm, tomlkit, tomli, threadpoolctl, tenacity, sniffio, smmap, slicer, six, semver, python-multipart, python-dotenv, pyparsing, Pygments, pycparser, psycopg2-binary, pluggy, platformdirs, pkginfo, pillow, pathspec, packaging, numpy, nh3, mypy-extensions, more-itertools, llvmlite, kiwisolver, joblib, jeepney, iniconfig, importlib-resources, idna, h11, greenlet, fonttools, dotty-dict, docutils, cycler, coverage, convertdate, colorama, cloudpickle, click, charset_normalizer, certifi, cachetools, backports.tarfile, async-timeout, annotated-types, uvicorn, stanio, sqlalchemy, scipy, requests, readme-renderer, python-dateutil, pydantic-core, plotly, numba, jaraco.functools, jaraco.context, jaraco.classes, importlib-metadata, gitdb, exceptiongroup, deprecation, contourpy, click-log, cffi, black, asyncpg, scikit-learn, requests-toolbelt, realtime, pytest, pydantic, pandas, matplotlib, LunarCalendar, holidays, gitpython, cryptography, anyio, starlette, shap, SecretStorage, seaborn, python-gitlab, httpcore, cmdstanpy, prophet, keyring, httpx, fastapi, twine, supafunc, storage3, postgrest, gotrue, python-semantic-release, supabase
Successfully installed LunarCalendar-0.0.9 Pygments-2.19.2 SecretStorage-3.3.3 annotated-types-0.7.0 anyio-3.7.1 async-timeout-5.0.1 asyncpg-0.29.0 backports.tarfile-1.2.0 black-24.4.2 cachetools-5.3.3 certifi-2025.7.9 cffi-1.17.1 charset_normalizer-3.4.2 click-8.2.1 click-log-0.4.0 cloudpickle-3.1.1 cmdstanpy-1.2.5 colorama-0.4.6 contourpy-1.3.2 convertdate-2.4.0 coverage-7.3.2 cryptography-45.0.5 cycler-0.12.1 deprecation-2.1.0 docutils-0.21.2 dotty-dict-1.3.1 ephem-4.2 exceptiongroup-1.3.0 fastapi-0.103.1 fonttools-4.58.5 gitdb-4.0.12 gitpython-3.1.44 gotrue-1.3.1 greenlet-3.2.3 h11-0.14.0 holidays-0.76 httpcore-0.16.3 httpx-0.23.3 idna-3.10 importlib-metadata-8.7.0 importlib-resources-6.5.2 iniconfig-2.1.0 invoke-1.7.3 jaraco.classes-3.4.0 jaraco.context-6.0.1 jaraco.functools-4.2.1 jeepney-0.9.0 joblib-1.3.2 keyring-25.6.0 kiwisolver-1.4.8 llvmlite-0.44.0 matplotlib-3.7.2 more-itertools-10.7.0 mypy-extensions-1.1.0 nh3-0.2.21 numba-0.61.2 numpy-1.24.3 packaging-25.0 pandas-2.1.4 pathspec-0.12.1 pillow-11.3.0 pkginfo-1.12.1.2 platformdirs-4.3.8 plotly-5.18.0 pluggy-1.6.0 postgrest-0.10.7 prophet-1.1.4 psycopg2-binary-2.9.9 pycparser-2.22 pydantic-2.3.0 pydantic-core-2.6.3 pymeeus-0.5.12 pyparsing-3.0.9 pytest-7.4.0 python-dateutil-2.9.0.post0 python-dotenv-1.0.1 python-gitlab-3.15.0 python-multipart-0.0.6 python-semantic-release-7.33.2 pytz-2025.2 readme-renderer-44.0 realtime-1.0.6 requests-2.32.4 requests-toolbelt-1.0.0 rfc3986-1.5.0 scikit-learn-1.3.0 scipy-1.15.3 seaborn-0.12.2 semver-2.13.0 shap-0.42.1 six-1.17.0 slicer-0.0.7 smmap-5.0.2 sniffio-1.3.1 sqlalchemy-1.4.49 stanio-0.5.1 starlette-0.27.0 storage3-0.5.3 strenum-0.4.15 supabase-1.0.3 supafunc-0.2.2 tenacity-9.1.2 threadpoolctl-3.6.0 tomli-2.2.1 tomlkit-0.13.3 tqdm-4.66.1 twine-3.8.0 typing-extensions-4.14.1 tzdata-2025.2 urllib3-2.5.0 uvicorn-0.23.2 websockets-12.0 zipp-3.23.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv

[notice] A new release of pip is available: 23.0.1 -> 25.1.1
[notice] To update, run: pip install --upgrade pip

+ pip install flake8 flake8-async flake8-bugbear flake8-docstrings
Collecting flake8
  Downloading flake8-7.3.0-py2.py3-none-any.whl (57 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 57.9/57.9 kB 2.2 MB/s eta 0:00:00
Collecting flake8-async
  Downloading flake8_async-25.5.3-py3-none-any.whl (56 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.5/56.5 kB 6.8 MB/s eta 0:00:00
Collecting flake8-bugbear
  Downloading flake8_bugbear-24.12.12-py3-none-any.whl (36 kB)
Collecting flake8-docstrings
  Downloading flake8_docstrings-1.7.0-py2.py3-none-any.whl (5.0 kB)
Collecting pyflakes<3.5.0,>=3.4.0
  Downloading pyflakes-3.4.0-py2.py3-none-any.whl (63 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.6/63.6 kB 16.9 MB/s eta 0:00:00
Collecting pycodestyle<2.15.0,>=2.14.0
  Downloading pycodestyle-2.14.0-py2.py3-none-any.whl (31 kB)
Collecting mccabe<0.8.0,>=0.7.0
  Downloading mccabe-0.7.0-py2.py3-none-any.whl (7.3 kB)
Collecting libcst>=1.0.1
  Downloading libcst-1.8.2-cp310-cp310-manylinux_2_28_x86_64.whl (2.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.3/2.3 MB 70.8 MB/s eta 0:00:00
Collecting attrs>=22.2.0
  Downloading attrs-25.3.0-py3-none-any.whl (63 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.8/63.8 kB 18.9 MB/s eta 0:00:00
Collecting pydocstyle>=2.1
  Downloading pydocstyle-6.3.0-py3-none-any.whl (38 kB)
Collecting pyyaml>=5.2
  Downloading PyYAML-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (751 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 751.2/751.2 kB 67.6 MB/s eta 0:00:00
Collecting snowballstemmer>=2.2.0
  Downloading snowballstemmer-3.0.1-py3-none-any.whl (103 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 103.3/103.3 kB 34.9 MB/s eta 0:00:00
Installing collected packages: snowballstemmer, pyyaml, pyflakes, pycodestyle, mccabe, attrs, pydocstyle, libcst, flake8, flake8-docstrings, flake8-bugbear, flake8-async
Successfully installed attrs-25.3.0 flake8-7.3.0 flake8-async-25.5.3 flake8-bugbear-24.12.12 flake8-docstrings-1.7.0 libcst-1.8.2 mccabe-0.7.0 pycodestyle-2.14.0 pydocstyle-6.3.0 pyflakes-3.4.0 pyyaml-6.0.2 snowballstemmer-3.0.1
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv

[notice] A new release of pip is available: 23.0.1 -> 25.1.1
[notice] To update, run: pip install --upgrade pip

+ flake8 . --extend-exclude=dist,build,venv --show-source --statistics
./api/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting API initialization.
"""
^
./api/__init__.py:16:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
./api/__init__.py:23:80: E501 line too long (90 > 79 characters)
    description="API for sales forecasting, promotion impact, and inventory optimization",
                                                                               ^
./api/__init__.py:45:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def root():
^
./api/__init__.py:56:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def health():
^
./api/forecast.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FastAPI endpoints for sales forecasting and demand prediction.
"""
^
./api/forecast.py:5:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./api/forecast.py:6:1: F401 'typing.Union' imported but unused
from typing import Dict, List, Optional, Union, Any
^
./api/forecast.py:8:1: F401 'numpy as np' imported but unused
import numpy as np
^
./api/forecast.py:9:1: F401 'fastapi.Query' imported but unused
from fastapi import FastAPI, Query, HTTPException, Depends
^
./api/forecast.py:10:1: F401 'pydantic.Field' imported but unused
from pydantic import BaseModel, Field
^
./api/forecast.py:17:1: E402 module level import not at top of file
from models.prophet_forecaster import ProphetForecaster
^
./api/forecast.py:18:1: E402 module level import not at top of file
from models.promo_uplift_model import PromoUpliftModel
^
./api/forecast.py:19:1: E402 module level import not at top of file
from database.connection import get_db_engine
^
./api/forecast.py:23:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
./api/forecast.py:30:80: E501 line too long (90 > 79 characters)
    description="API for sales forecasting, promotion impact, and inventory optimization",
                                                                               ^
./api/forecast.py:152:11: W291 trailing whitespace
    query = """
    SELECT 
        sd.sale_date,
        sd.store_id,
        sd.product_id,
        ph.first_category_id,
        sh.city_id,
        sd.sale_amount,
        sd.sale_qty,
        sd.discount,
        sd.original_price,
        sd.stock_hour6_22_cnt,
        sd.holiday_flag,
        sd.promo_flag
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    WHERE 1=1
    """
          ^
./api/forecast.py:205:80: E501 line too long (80 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Database error: {str(e)}")
                                                                               ^
./api/forecast.py:208:80: E501 line too long (87 > 79 characters)
def fetch_weather_data(city_id=None, start_date=None, end_date=None, future_periods=0):
                                                                               ^
./api/forecast.py:210:80: E501 line too long (82 > 79 characters)
    """
    Fetch weather data from the database, including future forecasts if available.

    Args:
        city_id: City ID to filter by
        start_date: Start date
        end_date: End date
        future_periods: Number of future periods to include

    Returns:
        pd.DataFrame: Weather data
    """
       
                                                                       ^
./api/forecast.py:225:11: W291 trailing whitespace
    query = """
    SELECT 
        city_id,
        date,
        temp_avg,
        humidity,
        precipitation,
        wind_speed,
        weather_condition
    FROM weather_data
    WHERE 1=1
    """
          ^
./api/forecast.py:269:80: E501 line too long (88 > 79 characters)
                same_dow = df[pd.to_datetime(df["date"]).dt.dayofweek == date.dayofweek]
                                                                               ^
./api/forecast.py:289:80: E501 line too long (84 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Weather data error: {str(e)}")
                                                                               ^
./api/forecast.py:301:80: E501 line too long (80 > 79 characters)
    """
    Fetch promotion data from the database, including future planned promotions.

    Returns:
        pd.DataFrame: Promotion data
    """
       
                                                                       ^
./api/forecast.py:309:11: W291 trailing whitespace
    query = """
    SELECT 
        pe.store_id,
        pe.product_id,
        ph.first_category_id,
        pe.start_date,
        pe.end_date,
        pe.promotion_type,
        pe.discount_percentage
    FROM promotion_events pe
    JOIN product_hierarchy ph ON pe.product_id = ph.product_id
    WHERE 1=1
    """
          ^
./api/forecast.py:360:80: E501 line too long (86 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Promotion data error: {str(e)}")
                                                                               ^
./api/forecast.py:373:11: W291 trailing whitespace
    query = """
    SELECT 
        date,
        holiday_name,
        holiday_type,
        significance
    FROM holiday_calendar
    WHERE 1=1
    """
          ^
./api/forecast.py:400:80: E501 line too long (84 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Holiday data error: {str(e)}")
                                                                               ^
./api/forecast.py:411:58: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    request: ForecastRequest, model: ProphetForecaster = Depends(get_forecast_model)
                                                         ^
./api/forecast.py:411:80: E501 line too long (84 > 79 characters)
    request: ForecastRequest, model: ProphetForecaster = Depends(get_forecast_model)
                                                                               ^
./api/forecast.py:463:80: E501 line too long (84 > 79 characters)
                status_code=400, detail="Not enough historical data for forecasting"
                                                                               ^
./api/forecast.py:476:13: F841 local variable 'metrics' is assigned to but never used
            metrics = model.train(df)
            ^
./api/forecast.py:517:80: E501 line too long (86 > 79 characters)
                    promo_start = max(pd.to_datetime(promo["start_date"]), start_date)
                                                                               ^
./api/forecast.py:518:80: E501 line too long (80 > 79 characters)
                    promo_end = min(pd.to_datetime(promo["end_date"]), end_date)
                                                                               ^
./api/forecast.py:531:80: E501 line too long (84 > 79 characters)
                        promo_end = min(pd.to_datetime(promo["end_date"]), end_date)
                                                                               ^
./api/forecast.py:535:80: E501 line too long (88 > 79 characters)
                        promo_flags.loc[mask, "discount"] = promo["discount_percentage"]
                                                                               ^
./api/forecast.py:549:80: E501 line too long (80 > 79 characters)
                    start=start_date, periods=request.periods, freq=request.freq
                                                                               ^
./api/forecast.py:555:13: B007 Loop control variable 'feature' not used within the loop body. If this is intended, start the name with an underscore.
        for feature, feature_df in future_features.items():
            ^
./api/forecast.py:557:80: E501 line too long (80 > 79 characters)
                future_df = pd.merge(future_df, feature_df, on="ds", how="left")
                                                                               ^
./api/forecast.py:563:80: E501 line too long (84 > 79 characters)
        forecast_data = forecast[["ds", "yhat", "yhat_lower", "yhat_upper"]].rename(
                                                                               ^
./api/forecast.py:574:80: E501 line too long (86 > 79 characters)
            "metrics": model.metrics.to_dict() if model.metrics is not None else None,
                                                                               ^
./api/forecast.py:594:80: E501 line too long (80 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Forecast error: {str(e)}")
                                                                               ^
./api/forecast.py:600:31: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    model: PromoUpliftModel = Depends(get_promo_model),
                              ^
./api/forecast.py:636:80: E501 line too long (88 > 79 characters)
                status_code=400, detail="No data available for the specified parameters"
                                                                               ^
./api/forecast.py:650:80: E501 line too long (89 > 79 characters)
            # For each day in the sales data, check if it falls within a promotion period
                                                                               ^
./api/forecast.py:663:80: E501 line too long (83 > 79 characters)
                            if row["product_id"] == promo["product_id"] or pd.isna(
                                                                               ^
./api/forecast.py:679:80: E501 line too long (81 > 79 characters)
        if request.promotion_type is not None and "promotion_type" in df.columns:
                                                                               ^
./api/forecast.py:683:80: E501 line too long (84 > 79 characters)
        if request.discount_min is not None and "discount_percentage" in df.columns:
                                                                               ^
./api/forecast.py:686:80: E501 line too long (84 > 79 characters)
        if request.discount_max is not None and "discount_percentage" in df.columns:
                                                                               ^
./api/forecast.py:704:80: E501 line too long (82 > 79 characters)
                    df["promo_flag"].sum() if "promo_flag" in df.columns else None
                                                                               ^
./api/forecast.py:720:80: E501 line too long (80 > 79 characters)
    """
    Analyze the impact of stockouts and estimate demand during stockout periods.

    Parameters:
    - store_id: Store ID
    - product_id: Product ID
    - start_date: Start date for analysis
    - end_date: End date for analysis

    Returns:
    - Stockout analysis with estimated demand during stockout periods
    """
       
                                                                       ^
./api/forecast.py:741:80: E501 line too long (81 > 79 characters)
            - timedelta(days=30),  # Get some extra history for better estimation
                                                                               ^
./api/forecast.py:747:80: E501 line too long (88 > 79 characters)
                status_code=400, detail="No data available for the specified parameters"
                                                                               ^
./api/forecast.py:756:80: E501 line too long (87 > 79 characters)
            .groupby(pd.to_datetime(df[~df["is_stockout"]]["sale_date"]).dt.dayofweek)[
                                                                               ^
./api/forecast.py:773:80: E501 line too long (80 > 79 characters)
                stockout_days["estimated_demand"] - stockout_days["sale_amount"]
                                                                               ^
./api/forecast.py:775:80: E501 line too long (83 > 79 characters)
            stockout_days["lost_sales"] = stockout_days["lost_sales"].clip(lower=0)
                                                                               ^
./api/forecast.py:778:80: E501 line too long (86 > 79 characters)
                columns=["sale_date", "estimated_demand", "lost_sales", "sale_amount"]
                                                                               ^
./api/forecast.py:786:80: E501 line too long (84 > 79 characters)
                stockout_days["lost_sales"].mean() if stockout_days_count > 0 else 0
                                                                               ^
./api/forecast.py:846:80: E501 line too long (88 > 79 characters)
                status_code=400, detail="No data available for the specified parameters"
                                                                               ^
./api/forecast.py:850:80: E501 line too long (82 > 79 characters)
        holidays_df = fetch_holiday_data(start_date=start_date, end_date=end_date)
                                                                               ^
./api/forecast.py:864:80: E501 line too long (88 > 79 characters)
                "summary": {"message": "No holidays found in the specified date range"},
                                                                               ^
./api/forecast.py:905:80: E501 line too long (81 > 79 characters)
                comparison_sales.groupby("sale_date")["sale_amount"].sum().mean()
                                                                               ^
./api/forecast.py:920:80: E501 line too long (86 > 79 characters)
                        holiday["holiday_type"] if "holiday_type" in holiday else None
                                                                               ^
./api/forecast.py:934:80: E501 line too long (80 > 79 characters)
            total_lift = sum(impact["sales_lift"] for impact in holiday_impacts)
                                                                               ^
./api/promotions.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FastAPI endpoints for promotion management and recommendation.
"""
^
./api/promotions.py:6:1: F401 'typing.Union' imported but unused
from typing import Dict, List, Optional, Union, Any
^
./api/promotions.py:8:1: F401 'numpy as np' imported but unused
import numpy as np
^
./api/promotions.py:9:1: F401 'fastapi.FastAPI' imported but unused
from fastapi import FastAPI, APIRouter, HTTPException, Depends
^
./api/promotions.py:10:1: F401 'pydantic.Field' imported but unused
from pydantic import BaseModel, Field
^
./api/promotions.py:17:1: E402 module level import not at top of file
from models.promo_uplift_model import PromoUpliftModel
^
./api/promotions.py:18:1: E402 module level import not at top of file
from database.connection import get_db_engine, get_supabase_client
^
./api/promotions.py:19:1: E402 module level import not at top of file
from api.forecast import get_promo_model, fetch_historical_data
^
./api/promotions.py:23:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
./api/promotions.py:136:80: E501 line too long (82 > 79 characters)
        response = supabase.table("promotion_events").insert(promo_data).execute()
                                                                               ^
./api/promotions.py:144:80: E501 line too long (85 > 79 characters)
            raise HTTPException(status_code=500, detail="Failed to create promotion")
                                                                               ^
./api/promotions.py:179:80: E501 line too long (85 > 79 characters)
                status_code=404, detail=f"Promotion with ID {promotion_id} not found"
                                                                               ^
./api/promotions.py:189:80: E501 line too long (86 > 79 characters)
            update_data["start_date"] = pd.to_datetime(promotion.start_date).strftime(
                                                                               ^
./api/promotions.py:193:80: E501 line too long (82 > 79 characters)
            update_data["end_date"] = pd.to_datetime(promotion.end_date).strftime(
                                                                               ^
./api/promotions.py:216:80: E501 line too long (85 > 79 characters)
            raise HTTPException(status_code=500, detail="Failed to update promotion")
                                                                               ^
./api/promotions.py:250:80: E501 line too long (85 > 79 characters)
                status_code=404, detail=f"Promotion with ID {promotion_id} not found"
                                                                               ^
./api/promotions.py:255:80: E501 line too long (88 > 79 characters)
            supabase.table("promotion_events").delete().eq("id", promotion_id).execute()
                                                                               ^
./api/promotions.py:259:80: E501 line too long (88 > 79 characters)
            return {"message": f"Promotion with ID {promotion_id} deleted successfully"}
                                                                               ^
./api/promotions.py:261:80: E501 line too long (85 > 79 characters)
            raise HTTPException(status_code=500, detail="Failed to delete promotion")
                                                                               ^
./api/promotions.py:288:80: E501 line too long (94 > 79 characters)
    """
    List promotions with optional filters.

    Parameters:
    - store_id: Filter by store ID
    - product_id: Filter by product ID
    - category_id: Filter by category ID
    - start_date: Filter by start date
    - end_date: Filter by end date
    - active: If true, return only active promotions (current date between start and end date)

    Returns:
    - List of matching promotions
    """
       
                                          

               
           ^
./api/promotions.py:298:15: W291 trailing whitespace
        query = """
        SELECT 
            pe.id,
            pe.store_id,
            pe.product_id,
            pe.start_date,
            pe.end_date,
            pe.promotion_type,
            pe.discount_percentage,
            pe.display_location,
            pe.campaign_id,
            pe.created_at
        FROM promotion_events pe
        """
              ^
./api/promotions.py:386:31: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    model: PromoUpliftModel = Depends(get_promo_model),
                              ^
./api/promotions.py:413:80: E501 line too long (81 > 79 characters)
        start_date = target_date - timedelta(days=90)  # Use last 90 days of data
                                                                               ^
./api/promotions.py:429:80: E501 line too long (103 > 79 characters)
                detail=f"Not enough historical data ({len(df)} records) for promotion recommendations",
                                                                               ^
./api/promotions.py:453:80: E501 line too long (85 > 79 characters)
        # For each combination, simulate different discount levels and predict uplift
                                                                               ^
./api/promotions.py:456:80: E501 line too long (83 > 79 characters)
        discount_levels = [d for d in discount_levels if d <= request.max_discount]
                                                                               ^
./api/promotions.py:511:80: E501 line too long (86 > 79 characters)
                        rec[col] = int(combo[col]) if pd.notnull(combo[col]) else None
                                                                               ^
./api/promotions.py:515:80: E501 line too long (84 > 79 characters)
                    logger.warning(f"Error predicting uplift for {combo}: {str(e)}")
                                                                               ^
./api/promotions.py:563:80: E501 line too long (81 > 79 characters)
            status_code=500, detail=f"Error generating recommendations: {str(e)}"
                                                                               ^
./api/sales.py:1:1: D100 Missing docstring in public module
./api/stockout.py:1:1: D100 Missing docstring in public module
./app/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting API package.
"""
^
./app/api.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FastAPI application for forecasting API (refactored to use service layer and model loader).
"""
^
./app/api.py:2:80: E501 line too long (91 > 79 characters)
"""
FastAPI application for forecasting API (refactored to use service layer and model loader).
"""
   
                                                                           ^
./app/api.py:7:1: F401 'typing.List' imported but unused
from typing import List, Dict, Any, Optional
^
./app/api.py:7:1: F401 'typing.Dict' imported but unused
from typing import List, Dict, Any, Optional
^
./app/api.py:7:1: F401 'typing.Any' imported but unused
from typing import List, Dict, Any, Optional
^
./app/api.py:7:1: F401 'typing.Optional' imported but unused
from typing import List, Dict, Any, Optional
^
./app/api.py:49:1: D103 Missing docstring in public function
async def get_db_connection():
^
./app/api.py:59:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def root():
^
./app/api.py:60:1: D400 First line should end with a period
    """Root endpoint"""
^
./app/api.py:61:80: E501 line too long (80 > 79 characters)
    return {"status": "ok", "message": "FreshRetail Forecasting API is running"}
                                                                               ^
./app/api.py:65:1: D103 Missing docstring in public function
async def get_cities(conn=Depends(get_db_connection)):
^
./app/api.py:65:27: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def get_cities(conn=Depends(get_db_connection)):
                          ^
./app/api.py:74:1: D103 Missing docstring in public function
async def get_stores(conn=Depends(get_db_connection)):
^
./app/api.py:74:27: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def get_stores(conn=Depends(get_db_connection)):
                          ^
./app/api.py:76:80: E501 line too long (162 > 79 characters)
        "SELECT s.store_id, s.store_name, s.city_id, c.city_name FROM store_hierarchy s LEFT JOIN city_hierarchy c ON s.city_id = c.city_id ORDER BY s.store_name"
                                                                               ^
./app/api.py:83:1: D103 Missing docstring in public function
async def get_products(conn=Depends(get_db_connection)):
^
./app/api.py:83:29: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def get_products(conn=Depends(get_db_connection)):
                            ^
./app/api.py:85:80: E501 line too long (86 > 79 characters)
        "SELECT product_id, product_name FROM product_hierarchy ORDER BY product_name"
                                                                               ^
./app/api.py:92:51: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def forecast(request: ForecastRequest, conn=Depends(get_db_connection)):
                                                  ^
./app/api.py:93:1: D400 First line should end with a period
    """Generate sales forecast"""
^
./app/api.py:96:9: F841 local variable 'df' is assigned to but never used
        df = await fetch_historical_data(
        ^
./app/api.py:136:80: E501 line too long (80 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Forecast error: {str(e)}")
                                                                               ^
./app/api.py:138:9: ASYNC102 await inside try/finally on line 94 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:143:45: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    request: PromotionAnalysisRequest, conn=Depends(get_db_connection)
                                            ^
./app/api.py:145:1: D400 First line should end with a period
    """Analyze promotion effectiveness"""
^
./app/api.py:174:9: ASYNC102 await inside try/finally on line 146 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:179:44: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    request: StockoutAnalysisRequest, conn=Depends(get_db_connection)
                                           ^
./app/api.py:181:1: D400 First line should end with a period
    """Analyze stockout impact"""
^
./app/api.py:199:9: ASYNC102 await inside try/finally on line 182 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:204:41: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    request: HolidayImpactRequest, conn=Depends(get_db_connection)
                                        ^
./app/api.py:206:1: D400 First line should end with a period
    """Analyze holiday effects on sales"""
^
./app/api.py:222:80: E501 line too long (88 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Holiday analysis error: {str(e)}")
                                                                               ^
./app/api.py:224:9: ASYNC102 await inside try/finally on line 207 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:228:1: D103 Missing docstring in public function
async def forecast_get(
^
./app/api.py:229:20: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    city_id: int = Path(...),
                   ^
./app/api.py:230:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    store_id: int = Path(...),
                    ^
./app/api.py:231:23: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    product_id: int = Path(...),
                      ^
./app/api.py:232:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(30),
                ^
./app/api.py:233:10: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    conn=Depends(get_db_connection),
         ^
./app/api.py:258:80: E501 line too long (80 > 79 characters)
            city_id=city_id, store_id=store_id, product_id=product_id, conn=conn
                                                                               ^
./app/api.py:261:80: E501 line too long (86 > 79 characters)
        print(f"Forecasting debug: rows in df={len(df)}, min_required={min_required}")
                                                                               ^
./app/api.py:264:80: E501 line too long (130 > 79 characters)
                "detail": f"Not enough historical data for forecasting. Found {len(df)} rows, minimum required is {min_required}."
                                                                               ^
./app/api.py:271:80: E501 line too long (84 > 79 characters)
                city_id=city_id, store_id=store_id, product_id=product_id, conn=conn
                                                                               ^
./app/api.py:302:80: E501 line too long (118 > 79 characters)
            f"DEBUG: Returning transformed result with {len(transformed_result['forecasted_values'])} forecast values"
                                                                               ^
./app/api.py:304:80: E501 line too long (88 > 79 characters)
        print(f"DEBUG: First few values: {transformed_result['forecasted_values'][:5]}")
                                                                               ^
./app/api.py:312:80: E501 line too long (80 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Forecast error: {str(e)}")
                                                                               ^
./app/api.py:314:9: ASYNC102 await inside try/finally on line 235 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:318:1: D103 Missing docstring in public function
async def promotions_impact_get(
^
./app/api.py:321:24: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    category_id: int = Query(0),
                       ^
./app/api.py:322:20: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    city_id: int = Query(0),
                   ^
./app/api.py:323:23: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    start_date: str = Query(None),
                      ^
./app/api.py:324:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    end_date: str = Query(None),
                    ^
./app/api.py:325:10: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    conn=Depends(get_db_connection),
         ^
./app/api.py:329:80: E501 line too long (184 > 79 characters)
            f"Promotion impact request params: store_id={store_id}, product_id={product_id}, category_id={category_id}, city_id={city_id}, start_date={start_date}, end_date={end_date}"
                                                                               ^
./app/api.py:409:9: ASYNC102 await inside try/finally on line 327 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:413:1: D103 Missing docstring in public function
async def stockout_risk_get(
^
./app/api.py:414:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    store_id: int = Path(...),
                    ^
./app/api.py:415:23: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    product_id: int = Path(...),
                      ^
./app/api.py:416:10: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    conn=Depends(get_db_connection),
         ^
./app/api.py:475:9: ASYNC102 await inside try/finally on line 418 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:479:1: D103 Missing docstring in public function
async def get_valid_combinations(conn=Depends(get_db_connection)):
^
./app/api.py:479:39: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def get_valid_combinations(conn=Depends(get_db_connection)):
                                      ^
./app/api.py:481:20: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
   ^
./app/api.py:482:20: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
   ^
./app/api.py:483:22: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
     ^
./app/api.py:484:21: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
    ^
./app/api.py:485:23: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
      ^
./app/api.py:486:23: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
      ^
./app/api.py:499:27: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def debug_data(conn=Depends(get_db_connection)):
                          ^
./app/api.py:500:1: D400 First line should end with a period
    """Debug endpoint to find valid data combinations"""
^
./app/api.py:504:24: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
   ^
./app/api.py:505:25: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
    ^
./app/api.py:506:27: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
      ^
./app/api.py:531:9: ASYNC102 await inside try/finally on line 501 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/main.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Main application entry point.
"""
^
./app/main.py:22:1: D103 Missing docstring in public function
def root():
^
./app/main.py:33:1: D400 First line should end with a period
    """Debug endpoint to find valid data combinations"""
^
./app/main.py:43:24: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
   ^
./app/main.py:44:25: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
    ^
./app/main.py:45:27: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
      ^
./config.py:1:1: D100 Missing docstring in public module
./database/__init__.py:1:1: D104 Missing docstring in public package
# Database package initialization
^
./database/check_encodings.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to analyze encoded values in the FreshRetailNet-50K dataset.
"""
^
./database/check_encodings.py:7:1: F401 'sqlalchemy.text' imported but unused
from sqlalchemy import create_engine, text
^
./database/check_encodings.py:8:1: F401 'dotenv.load_dotenv' imported but unused
from dotenv import load_dotenv
^
./database/check_encodings.py:21:80: E501 line too long (147 > 79 characters)
    connection_string = f"postgresql://{db_params['user']}:{db_params['password']}@{db_params['host']}:{db_params['port']}/{db_params['database']}"
                                                                               ^
./database/check_encodings.py:32:11: W291 trailing whitespace
    city_query = """
    SELECT 
        city_id,
        COUNT(DISTINCT store_id) as num_stores,
        COUNT(*) as num_records,
        ROUND(AVG(sale_amount), 2) as avg_sale_amount,
        ROUND(AVG(avg_temperature), 2) as avg_temp,
        ROUND(AVG(avg_humidity), 2) as avg_humidity
    FROM sales_data
    GROUP BY city_id
    ORDER BY city_id;
    """
          ^
./database/check_encodings.py:48:11: W291 trailing whitespace
    store_query = """
    SELECT 
        city_id,
        COUNT(DISTINCT store_id) as num_stores,
        MIN(store_id) as min_store_id,
        MAX(store_id) as max_store_id
    FROM store_hierarchy
    GROUP BY city_id
    ORDER BY city_id;
    """
          ^
./database/check_encodings.py:62:11: W291 trailing whitespace
    category_query = """
    SELECT 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id,
        COUNT(*) as num_products,
        COUNT(DISTINCT product_id) as unique_products
    FROM product_hierarchy
    GROUP BY 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id
    ORDER BY 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id;
    """
          ^
./database/check_encodings.py:70:13: W291 trailing whitespace
    category_query = """
    SELECT 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id,
        COUNT(*) as num_products,
        COUNT(DISTINCT product_id) as unique_products
    FROM product_hierarchy
    GROUP BY 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id
    ORDER BY 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id;
    """
            ^
./database/check_encodings.py:75:13: W291 trailing whitespace
    category_query = """
    SELECT 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id,
        COUNT(*) as num_products,
        COUNT(DISTINCT product_id) as unique_products
    FROM product_hierarchy
    GROUP BY 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id
    ORDER BY 
        management_group_id,
        first_category_id,
        second_category_id,
        third_category_id;
    """
            ^
./database/check_encodings.py:86:11: W291 trailing whitespace
    product_query = """
    SELECT 
        p.management_group_id,
        p.first_category_id,
        COUNT(DISTINCT p.product_id) as num_products,
        ROUND(AVG(s.sale_amount), 2) as avg_sale_amount,
        ROUND(AVG(s.discount), 2) as avg_discount,
        COUNT(DISTINCT s.store_id) as num_stores_selling
    FROM product_hierarchy p
    JOIN sales_data s ON p.product_id = s.product_id
    GROUP BY 
        p.management_group_id,
        p.first_category_id
    ORDER BY 
        p.management_group_id,
        p.first_category_id;
    """
          ^
./database/check_encodings.py:95:13: W291 trailing whitespace
    product_query = """
    SELECT 
        p.management_group_id,
        p.first_category_id,
        COUNT(DISTINCT p.product_id) as num_products,
        ROUND(AVG(s.sale_amount), 2) as avg_sale_amount,
        ROUND(AVG(s.discount), 2) as avg_discount,
        COUNT(DISTINCT s.store_id) as num_stores_selling
    FROM product_hierarchy p
    JOIN sales_data s ON p.product_id = s.product_id
    GROUP BY 
        p.management_group_id,
        p.first_category_id
    ORDER BY 
        p.management_group_id,
        p.first_category_id;
    """
            ^
./database/check_encodings.py:98:13: W291 trailing whitespace
    product_query = """
    SELECT 
        p.management_group_id,
        p.first_category_id,
        COUNT(DISTINCT p.product_id) as num_products,
        ROUND(AVG(s.sale_amount), 2) as avg_sale_amount,
        ROUND(AVG(s.discount), 2) as avg_discount,
        COUNT(DISTINCT s.store_id) as num_stores_selling
    FROM product_hierarchy p
    JOIN sales_data s ON p.product_id = s.product_id
    GROUP BY 
        p.management_group_id,
        p.first_category_id
    ORDER BY 
        p.management_group_id,
        p.first_category_id;
    """
            ^
./database/config.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Centralized database configuration with connection pooling and caching.
"""
^
./database/config.py:50:80: E501 line too long (134 > 79 characters)
    return f"postgresql://{DB_CONFIG['user']}:{DB_CONFIG['password']}@{DB_CONFIG['host']}:{DB_CONFIG['port']}/{DB_CONFIG['database']}"
                                                                               ^
./database/connection.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Database connection manager with connection pooling.
"""
^
./database/connection.py:46:1: D401 First line should be in imperative mood
    """Decorator for caching database query results."""
^
./database/connection.py:52:80: E501 line too long (126 > 79 characters)
            cache_key = f"{key_prefix}:{':'.join(str(arg) for arg in args)}:{':'.join(f'{k}={v}' for k, v in kwargs.items())}"
                                                                               ^
./database/connection.py:69:1: D401 First line should be in imperative mood
    """Decorator for adding pagination to database queries."""
^
./database/export_to_csv.py:1:1: D205 1 blank line required between summary line and description
"""
Export data from the Hugging Face dataset to CSV files for direct import to Supabase.
Creates three files: sales_data_csv.csv, promotion_csv.csv, and holidays_csv.csv.
"""
^
./database/export_to_csv.py:2:80: E501 line too long (85 > 79 characters)
"""
Export data from the Hugging Face dataset to CSV files for direct import to Supabase.
Creates three files: sales_data_csv.csv, promotion_csv.csv, and holidays_csv.csv.
"""
   
                                                                           ^
./database/export_to_csv.py:3:80: E501 line too long (81 > 79 characters)
"""
Export data from the Hugging Face dataset to CSV files for direct import to Supabase.
Creates three files: sales_data_csv.csv, promotion_csv.csv, and holidays_csv.csv.
"""
   
                                                                           ^
./database/export_to_csv.py:10:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./database/export_to_csv.py:13:1: F401 'random' imported but unused
import random
^
./database/export_to_csv.py:14:1: F401 'csv' imported but unused
import csv
^
./database/export_to_csv.py:47:80: E501 line too long (82 > 79 characters)
        print(f"Dataset loaded successfully. Available splits: {list(ds.keys())}")
                                                                               ^
./database/export_to_csv.py:62:80: E501 line too long (96 > 79 characters)
                f"Split '{split}' not found in the dataset. Available splits: {list(ds.keys())}"
                                                                               ^
./database/export_to_csv.py:80:80: E501 line too long (112 > 79 characters)
            "If this is a private dataset, you may need to log in to Hugging Face using 'huggingface-cli login'"
                                                                               ^
./database/export_to_csv.py:126:80: E501 line too long (81 > 79 characters)
def create_promotions_csv(df, output_file="promotion_csv.csv", sample_frac=0.05):
                                                                               ^
./database/export_to_csv.py:133:80: E501 line too long (94 > 79 characters)
    """
    Create CSV file for promotions table based on Supabase schema.

    Args:
        df (pd.DataFrame): The Hugging Face dataset
        output_file (str): Output CSV file path
        sample_frac (float): Fraction of store-product combinations to generate promotions for
    """
       
                                                                  

   ^
./database/export_to_csv.py:197:80: E501 line too long (88 > 79 characters)
                            ["Discount", "BOGO", "2-for-1", "Bundle", "Special Display"]
                                                                               ^
./database/export_to_csv.py:201:80: E501 line too long (88 > 79 characters)
                            ["Entrance", "End Cap", "Checkout", "Aisle", "Special Area"]
                                                                               ^
./database/export_to_csv.py:203:80: E501 line too long (80 > 79 characters)
                        "campaign_id": f"CAMP_{np.random.randint(1000, 10000)}",
                                                                               ^
./database/export_to_csv.py:236:80: E501 line too long (83 > 79 characters)
                {"date": date.strftime("%Y-%m-%d"), "name": name, "country": "USA"}
                                                                               ^
./database/export_to_csv.py:247:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to load dataset and create CSV files."""
^
./database/export_to_csv.py:253:80: E501 line too long (82 > 79 characters)
        os.path.dirname(os.path.dirname(os.path.abspath(__file__))), "data_export"
                                                                               ^
./database/load_dataset.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to load FreshRetailNet-50K dataset from Hugging Face and ingest it into Supabase.
"""
^
./database/load_dataset.py:2:80: E501 line too long (88 > 79 characters)
"""
Script to load FreshRetailNet-50K dataset from Hugging Face and ingest it into Supabase.
"""
   
                                                                           ^
./database/load_dataset.py:18:1: F401 'database.connection.get_supabase_client' imported but unused
from database.connection import get_db_engine, get_supabase_client
^
./database/load_dataset.py:18:1: E402 module level import not at top of file
from database.connection import get_db_engine, get_supabase_client
^
./database/load_dataset.py:38:80: E501 line too long (85 > 79 characters)
        print("You may need to log in to Hugging Face using 'huggingface-cli login'")
                                                                               ^
./database/load_dataset.py:108:80: E501 line too long (80 > 79 characters)
                        ["Supermarket", "Hypermarket", "Express", "Convenience"]
                                                                               ^
./database/load_dataset.py:116:80: E501 line too long (83 > 79 characters)
                    f"Region_{city_id % 5 + 1}" for city_id in store_ids["city_id"]
                                                                               ^
./database/load_dataset.py:119:80: E501 line too long (82 > 79 characters)
                "longitude": np.random.uniform(110.0, 130.0, size=len(store_ids)),
                                                                               ^
./database/load_dataset.py:162:80: E501 line too long (87 > 79 characters)
                    f"Product_{product_id}" for product_id in product_ids["product_id"]
                                                                               ^
./database/load_dataset.py:165:80: E501 line too long (83 > 79 characters)
                    product_id % 2 == 0 for product_id in product_ids["product_id"]
                                                                               ^
./database/load_dataset.py:175:80: E501 line too long (81 > 79 characters)
                "unit_cost": np.random.uniform(1.0, 50.0, size=len(product_ids)),
                                                                               ^
./database/load_dataset.py:176:80: E501 line too long (83 > 79 characters)
                "unit_price": np.random.uniform(2.0, 100.0, size=len(product_ids)),
                                                                               ^
./database/load_dataset.py:181:80: E501 line too long (81 > 79 characters)
        print(f"Created product hierarchy with {len(product_hierarchy)} records")
                                                                               ^
./database/load_dataset.py:209:80: E501 line too long (86 > 79 characters)
        sales_data["sale_amount"] / np.random.uniform(0.5, 10.0, size=len(sales_data))
                                                                               ^
./database/load_dataset.py:221:80: E501 line too long (81 > 79 characters)
        sales_data["stock_hour6_22_cnt"] = np.random.randint(0, 50, size=len(df))
                                                                               ^
./database/load_dataset.py:231:80: E501 line too long (81 > 79 characters)
    sales_data["stock_hour14_22_cnt"] = sales_data["stock_hour14_22_cnt"].clip(0)
                                                                               ^
./database/load_dataset.py:295:80: E501 line too long (88 > 79 characters)
    weather_data["temp_avg"] = (weather_data["temp_min"] + weather_data["temp_max"]) / 2
                                                                               ^
./database/load_dataset.py:332:80: E501 line too long (80 > 79 characters)
                                for r in ["christmas", "easter", "thanksgiving"]
                                                                               ^
./database/load_dataset.py:354:80: E501 line too long (85 > 79 characters)
    if not all(col in df.columns for col in ["store_id", "product_id", "sale_date"]):
                                                                               ^
./database/load_dataset.py:359:80: E501 line too long (86 > 79 characters)
    store_products = df[["store_id", "product_id"]].drop_duplicates().sample(frac=0.3)
                                                                               ^
./database/load_dataset.py:386:80: E501 line too long (84 > 79 characters)
                        ["Discount", "BOGO", "2-for-1", "Bundle", "Special Display"]
                                                                               ^
./database/load_dataset.py:390:80: E501 line too long (84 > 79 characters)
                        ["Entrance", "End Cap", "Checkout", "Aisle", "Special Area"]
                                                                               ^
./database/load_dataset.py:410:80: E501 line too long (81 > 79 characters)
    if "store_hierarchy" in data_dict and not data_dict["store_hierarchy"].empty:
                                                                               ^
./database/load_dataset.py:422:80: E501 line too long (85 > 79 characters)
    if "product_hierarchy" in data_dict and not data_dict["product_hierarchy"].empty:
                                                                               ^
./database/load_dataset.py:475:32: E203 whitespace before ':'
            batch = data.iloc[i : i + batch_size]
                               ^
./database/load_dataset.py:493:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to load and process the dataset."""
^
./database/load_full_dataset.py:1:1: D205 1 blank line required between summary line and description
"""
Script to load the complete FreshRetailNet-50K dataset from Hugging Face and ingest it into Supabase.
This script ensures the entire dataset is loaded with all features and associations.
"""
^
./database/load_full_dataset.py:2:80: E501 line too long (101 > 79 characters)
"""
Script to load the complete FreshRetailNet-50K dataset from Hugging Face and ingest it into Supabase.
This script ensures the entire dataset is loaded with all features and associations.
"""
   
                                                                           ^
./database/load_full_dataset.py:3:80: E501 line too long (84 > 79 characters)
"""
Script to load the complete FreshRetailNet-50K dataset from Hugging Face and ingest it into Supabase.
This script ensures the entire dataset is loaded with all features and associations.
"""
   
                                                                           ^
./database/load_full_dataset.py:8:1: F401 'pathlib.Path' imported but unused
from pathlib import Path
^
./database/load_full_dataset.py:12:1: F401 'database.connection.get_supabase_client' imported but unused
from database.connection import get_db_engine, get_supabase_client
^
./database/load_full_dataset.py:12:1: E402 module level import not at top of file
from database.connection import get_db_engine, get_supabase_client
^
./database/load_full_dataset.py:13:1: E402 module level import not at top of file
from database.load_dataset import (
^
./database/load_full_dataset.py:23:1: D205 1 blank line required between summary line and description
    """
    Load the complete FreshRetailNet-50K dataset into Supabase.
    This function ensures all data is properly loaded, transformed, and associated.
    """
^
./database/load_full_dataset.py:25:80: E501 line too long (83 > 79 characters)
    """
    Load the complete FreshRetailNet-50K dataset into Supabase.
    This function ensures all data is properly loaded, transformed, and associated.
    """
       
                                                               
       ^
./database/load_huggingface_to_supabase.py:1:1: D205 1 blank line required between summary line and description
"""
Script to load the FreshRetailNet-50K dataset from Hugging Face to Supabase tables.
This version uses the Supabase REST API directly instead of SQLAlchemy to avoid connection issues.
It focuses on loading data to three target tables: sales_data, promotions, and holidays.
"""
^
./database/load_huggingface_to_supabase.py:2:80: E501 line too long (83 > 79 characters)
"""
Script to load the FreshRetailNet-50K dataset from Hugging Face to Supabase tables.
This version uses the Supabase REST API directly instead of SQLAlchemy to avoid connection issues.
It focuses on loading data to three target tables: sales_data, promotions, and holidays.
"""
   
                                                                           ^
./database/load_huggingface_to_supabase.py:3:80: E501 line too long (98 > 79 characters)
"""
Script to load the FreshRetailNet-50K dataset from Hugging Face to Supabase tables.
This version uses the Supabase REST API directly instead of SQLAlchemy to avoid connection issues.
It focuses on loading data to three target tables: sales_data, promotions, and holidays.
"""
   
                                                                           ^
./database/load_huggingface_to_supabase.py:4:80: E501 line too long (88 > 79 characters)
"""
Script to load the FreshRetailNet-50K dataset from Hugging Face to Supabase tables.
This version uses the Supabase REST API directly instead of SQLAlchemy to avoid connection issues.
It focuses on loading data to three target tables: sales_data, promotions, and holidays.
"""
   
                                                                           ^
./database/load_huggingface_to_supabase.py:11:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./database/load_huggingface_to_supabase.py:13:1: F401 'json' imported but unused
import json
^
./database/load_huggingface_to_supabase.py:16:1: F401 'random' imported but unused
import random
^
./database/load_huggingface_to_supabase.py:21:1: E402 module level import not at top of file
from database.connection import get_supabase_client
^
./database/load_huggingface_to_supabase.py:58:80: E501 line too long (90 > 79 characters)
                f"Split '{split}' not found in the dataset. Available splits: {ds.keys()}"
                                                                               ^
./database/load_huggingface_to_supabase.py:70:80: E501 line too long (112 > 79 characters)
            "If this is a private dataset, you may need to log in to Hugging Face using 'huggingface-cli login'"
                                                                               ^
./database/load_huggingface_to_supabase.py:124:80: E501 line too long (86 > 79 characters)
        sales_data["sale_date"] = pd.to_datetime(sales_data["sale_date"]).dt.strftime(
                                                                               ^
./database/load_huggingface_to_supabase.py:136:80: E501 line too long (86 > 79 characters)
        sales_data["sale_amount"] / np.random.uniform(0.5, 10.0, size=len(sales_data))
                                                                               ^
./database/load_huggingface_to_supabase.py:151:80: E501 line too long (81 > 79 characters)
        sales_data["stock_hour6_22_cnt"] = np.random.randint(0, 50, size=len(df))
                                                                               ^
./database/load_huggingface_to_supabase.py:166:80: E501 line too long (81 > 79 characters)
    if "holiday_flag" not in sales_data.columns and "holiday_flag" in df.columns:
                                                                               ^
./database/load_huggingface_to_supabase.py:171:80: E501 line too long (83 > 79 characters)
        sales_data["holiday_flag"] = pd.to_datetime(sales_data["sale_date"]).apply(
                                                                               ^
./database/load_huggingface_to_supabase.py:176:80: E501 line too long (80 > 79 characters)
    if "promo_flag" not in sales_data.columns and "activity_flag" in df.columns:
                                                                               ^
./database/load_huggingface_to_supabase.py:186:80: E501 line too long (86 > 79 characters)
            f"Sampling sales data from {len(sales_data)} to 10000 records for testing"
                                                                               ^
./database/load_huggingface_to_supabase.py:235:80: E501 line too long (80 > 79 characters)
                                for r in ["christmas", "easter", "thanksgiving"]
                                                                               ^
./database/load_huggingface_to_supabase.py:270:43: E712 comparison to True should be 'if cond is True:' or 'if cond:'
        promo_df = df[df["activity_flag"] == True].copy()
                                          ^
./database/load_huggingface_to_supabase.py:283:80: E501 line too long (87 > 79 characters)
        .sample(min(1000, len(promo_df[["store_id", "product_id"]].drop_duplicates())))
                                                                               ^
./database/load_huggingface_to_supabase.py:318:80: E501 line too long (88 > 79 characters)
                            ["Discount", "BOGO", "2-for-1", "Bundle", "Special Display"]
                                                                               ^
./database/load_huggingface_to_supabase.py:320:80: E501 line too long (83 > 79 characters)
                        "discount_percentage": float(np.random.uniform(0.05, 0.5)),
                                                                               ^
./database/load_huggingface_to_supabase.py:322:80: E501 line too long (88 > 79 characters)
                            ["Entrance", "End Cap", "Checkout", "Aisle", "Special Area"]
                                                                               ^
./database/load_huggingface_to_supabase.py:324:80: E501 line too long (80 > 79 characters)
                        "campaign_id": f"CAMP_{np.random.randint(1000, 10000)}",
                                                                               ^
./database/load_huggingface_to_supabase.py:356:80: E501 line too long (89 > 79 characters)
        f"Uploading {len(data_df)} records to {table_name} in batches of {batch_size}..."
                                                                               ^
./database/load_huggingface_to_supabase.py:364:80: E501 line too long (80 > 79 characters)
        response = supabase.table(table_name).select("count").limit(1).execute()
                                                                               ^
./database/load_huggingface_to_supabase.py:399:31: E203 whitespace before ':'
        batch = data_df.iloc[i : i + batch_size]
                              ^
./database/load_huggingface_to_supabase.py:410:80: E501 line too long (85 > 79 characters)
                print(f"Error uploading batch {i//batch_size + 1}: {response.error}")
                                                                               ^
./database/load_huggingface_to_supabase.py:413:80: E501 line too long (81 > 79 characters)
            print(f"Exception during batch {i//batch_size + 1} upload: {str(e)}")
                                                                               ^
./database/load_huggingface_to_supabase.py:425:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to load and process the dataset."""
^
./database/load_huggingface_to_supabase.py:444:80: E501 line too long (80 > 79 characters)
            upload_to_supabase("holiday_calendar", holiday_data, batch_size=100)
                                                                               ^
./database/load_huggingface_to_supabase.py:447:80: E501 line too long (82 > 79 characters)
            upload_to_supabase("promotion_events", promotion_data, batch_size=500)
                                                                               ^
./database/load_to_database.py:1:1: D205 1 blank line required between summary line and description
"""
Script to load the FreshRetailNet-50K dataset from Hugging Face to any PostgreSQL database.
This is a more flexible version that can work with any PostgreSQL connection.
"""
^
./database/load_to_database.py:2:80: E501 line too long (91 > 79 characters)
"""
Script to load the FreshRetailNet-50K dataset from Hugging Face to any PostgreSQL database.
This is a more flexible version that can work with any PostgreSQL connection.
"""
   
                                                                           ^
./database/load_to_database.py:9:1: F401 'pandas as pd' imported but unused
import pandas as pd
^
./database/load_to_database.py:17:1: E402 module level import not at top of file
from database.load_dataset import preprocess_data, upload_to_supabase
^
./database/load_to_database.py:54:80: E501 line too long (90 > 79 characters)
                f"Split '{split}' not found in the dataset. Available splits: {ds.keys()}"
                                                                               ^
./database/load_to_database.py:66:80: E501 line too long (112 > 79 characters)
            "If this is a private dataset, you may need to log in to Hugging Face using 'huggingface-cli login'"
                                                                               ^
./database/load_to_database.py:78:80: E501 line too long (96 > 79 characters)
    """
    Create a SQLAlchemy engine for the database connection.

    Args:
        connection_string (str, optional): Database connection string.
                                          If None, will try to build from environment variables.

    Returns:
        Engine: SQLAlchemy engine
    """
       
                                                           

         
^
./database/load_to_database.py:92:80: E501 line too long (86 > 79 characters)
            print("Error: DB_HOST and DB_PASSWORD environment variables must be set.")
                                                                               ^
./database/load_to_database.py:97:80: E501 line too long (81 > 79 characters)
            f"postgresql://{db_user}:{db_password}@{db_host}:{db_port}/{db_name}"
                                                                               ^
./database/load_to_database.py:114:80: E501 line too long (100 > 79 characters)
            f"Successfully connected to database at {connection_string.split('@')[1].split('/')[0]}"
                                                                               ^
./database/load_to_database.py:128:80: E501 line too long (82 > 79 characters)
    """
    Create database tables using schema.sql.

    Args:
        engine: SQLAlchemy engine
        schema_file (str): Path to schema file, relative to the database directory
    """
       
                                            

         
               ^
./database/load_to_database.py:182:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to load and process the dataset."""
^
./database/load_to_database.py:194:80: E501 line too long (83 > 79 characters)
        help="HuggingFace dataset name (default: Dingdong-Inc/FreshRetailNet-50K)",
                                                                               ^
./database/load_to_database.py:205:80: E501 line too long (92 > 79 characters)
        help="Database connection string (if not provided, will use environment variables)",
                                                                               ^
./database/load_to_database.py:251:80: E501 line too long (88 > 79 characters)
            f"Uploading complete dataset to database in batches of {args.batch_size}..."
                                                                               ^
./database/mappings.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Mappings for encoded values to real-world names and transformations in the FreshRetailNet-50K dataset.
"""
^
./database/mappings.py:2:80: E501 line too long (102 > 79 characters)
"""
Mappings for encoded values to real-world names and transformations in the FreshRetailNet-50K dataset.
"""
   
                                                                           ^
./database/mappings.py:6:1: F401 'numpy as np' imported but unused
import numpy as np
^
./database/mappings.py:54:80: E501 line too long (87 > 79 characters)
    return base_price * city_adjustment * (category_multiplier / BASE_SALES_MULTIPLIER)
                                                                               ^
./database/mappings.py:76:80: E501 line too long (84 > 79 characters)
            decode_sales_amount(x, city_id, management_group_id) for x in hours_sale
                                                                               ^
./database/mappings.py:85:80: E501 line too long (85 > 79 characters)
        encode_sales_amount(x, city_id, management_group_id) for x in real_hours_sale
                                                                               ^
./database/mappings.py:205:9: F841 local variable 'group' is assigned to but never used
        group = MANAGEMENT_GROUP_MAPPINGS[management_group_id]
        ^
./database/promotion_repository.py:1:1: D100 Missing docstring in public module
import asyncpg  # type: ignore
^
./database/promotion_repository.py:7:1: D200 One-line docstring should fit on one line with quotes
    """
    Async repository for promotion CRUD and query operations using asyncpg.
    """
^
./database/promotion_repository.py:11:1: D107 Missing docstring in __init__
    def __init__(self, dsn: str):
^
./database/promotion_repository.py:14:1: D102 Missing docstring in public method
    async def get_connection(self):
^
./database/promotion_repository.py:17:80: E501 line too long (87 > 79 characters)
    async def create_promotion(self, promotion_data: Dict[str, Any]) -> Dict[str, Any]:
                                                                               ^
./database/promotion_repository.py:18:1: D205 1 blank line required between summary line and description
        """
        Insert a new promotion into the database.
        Returns the created promotion record.
        """
^
./database/promotion_repository.py:24:80: E501 line too long (138 > 79 characters)
        query = """
            INSERT INTO promotion_events (
                store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
            ) VALUES (
                $1, $2, $3, $4, $5, $6, $7, $8, $9
            ) RETURNING id, store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
        """
                   
                                          
                ^
./database/promotion_repository.py:27:80: E501 line too long (150 > 79 characters)
        query = """
            INSERT INTO promotion_events (
                store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
            ) VALUES (
                $1, $2, $3, $4, $5, $6, $7, $8, $9
            ) RETURNING id, store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
        """
                   
                                          
                ^
./database/promotion_repository.py:47:1: D205 1 blank line required between summary line and description
        """
        Update an existing promotion by ID.
        Returns the updated promotion record, or None if not found.
        """
^
./database/promotion_repository.py:66:80: E501 line too long (148 > 79 characters)
        query = f"""
            UPDATE promotion_events
            SET {set_clause}
            WHERE id = ${idx}
            RETURNING id, store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
        """
                    
                                   
                      ^
./database/promotion_repository.py:73:1: D205 1 blank line required between summary line and description
        """
        Delete a promotion by ID.
        Returns True if deleted, False if not found.
        """
^
./database/promotion_repository.py:86:80: E501 line too long (81 > 79 characters)
    async def get_promotion(self, promotion_id: int) -> Optional[Dict[str, Any]]:
                                                                               ^
./database/promotion_repository.py:87:1: D205 1 blank line required between summary line and description
        """
        Get a single promotion by ID.
        Returns the promotion record, or None if not found.
        """
^
./database/promotion_repository.py:92:80: E501 line too long (145 > 79 characters)
        query = """
            SELECT id, store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
            FROM promotion_events
            WHERE id = $1
        """
                   
                                                           ^
./database/promotion_repository.py:109:1: D205 1 blank line required between summary line and description
        """
        List promotions with optional filters.
        Returns a list of promotion records.
        """
^
./database/promotion_repository.py:139:80: E501 line too long (82 > 79 characters)
            filters.append(f"pe.start_date <= ${idx} AND pe.end_date >= ${idx+1}")
                                                                               ^
./database/promotion_repository.py:145:80: E501 line too long (175 > 79 characters)
        base_query = """
            SELECT pe.id, pe.store_id, pe.product_id, pe.start_date, pe.end_date, pe.promotion_type, pe.discount_percentage, pe.display_location, pe.campaign_id, pe.created_at
            FROM promotion_events pe
        """
                        
                                                      ^
./database/promotion_repository.py:149:80: E501 line too long (88 > 79 characters)
            base_query += " JOIN product_hierarchy ph ON pe.product_id = ph.product_id "
                                                                               ^
./database/query_data.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to run SQL queries and explore the FreshRetailNet-50K dataset.
"""
^
./database/query_data.py:6:1: F401 'pathlib.Path' imported but unused
from pathlib import Path
^
./database/query_data.py:8:1: F401 'sqlalchemy.text' imported but unused
from sqlalchemy import create_engine, text
^
./database/query_data.py:25:80: E501 line too long (147 > 79 characters)
    connection_string = f"postgresql://{db_params['user']}:{db_params['password']}@{db_params['host']}:{db_params['port']}/{db_params['database']}"
                                                                               ^
./database/query_data.py:56:19: W291 trailing whitespace
        "Basic Sales Stats": """
            SELECT 
                COUNT(*) as total_records,
                COUNT(DISTINCT store_id) as unique_stores,
                COUNT(DISTINCT product_id) as unique_products,
                MIN(sale_date) as start_date,
                MAX(sale_date) as end_date,
                SUM(sale_amount) as total_sales,
                AVG(sale_amount) as avg_sale_amount
            FROM sales_data;
        """,
                  ^
./database/query_data.py:67:19: W291 trailing whitespace
        "Top 10 Products by Sales": """
            SELECT 
                p.product_id,
                p.first_category_id,
                SUM(s.sale_amount) as total_sales,
                COUNT(DISTINCT s.store_id) as stores_sold_in,
                AVG(s.discount) as avg_discount
            FROM sales_data s
            JOIN product_hierarchy p ON s.product_id = p.product_id
            GROUP BY p.product_id, p.first_category_id
            ORDER BY total_sales DESC
            LIMIT 10;
        """,
                  ^
./database/query_data.py:80:19: W291 trailing whitespace
        "Store Performance": """
            SELECT 
                s.store_id,
                s.city_id,
                COUNT(DISTINCT sd.product_id) as unique_products,
                AVG(sd.sale_amount) as avg_daily_sales,
                SUM(CASE WHEN sd.stock_hour6_22_cnt > 0 THEN 1 ELSE 0 END) as stockout_days
            FROM store_hierarchy s
            LEFT JOIN sales_data sd ON s.store_id = sd.store_id
            GROUP BY s.store_id, s.city_id
            ORDER BY avg_daily_sales DESC
            LIMIT 10;
        """,
                  ^
./database/query_data.py:85:80: E501 line too long (91 > 79 characters)
        "Store Performance": """
            SELECT 
                s.store_id,
                s.city_id,
                COUNT(DISTINCT sd.product_id) as unique_products,
                AVG(sd.sale_amount) as avg_daily_sales,
                SUM(CASE WHEN sd.stock_hour6_22_cnt > 0 THEN 1 ELSE 0 END) as stockout_days
            FROM store_hierarchy s
            LEFT JOIN sales_data sd ON s.store_id = sd.store_id
            GROUP BY s.store_id, s.city_id
            ORDER BY avg_daily_sales DESC
            LIMIT 10;
        """,
                                
                   
                          ^
./database/query_data.py:93:19: W291 trailing whitespace
        "Weather Impact": """
            SELECT 
                CASE 
                    WHEN avg_temperature < 10 THEN 'Cold (< 10°C)'
                    WHEN avg_temperature < 20 THEN 'Mild (10-20°C)'
                    WHEN avg_temperature < 30 THEN 'Warm (20-30°C)'
                    ELSE 'Hot (> 30°C)'
                END as temperature_range,
                ROUND(AVG(sale_amount), 2) as avg_sales,
                COUNT(*) as total_records
            FROM sales_data
            GROUP BY 
                CASE 
                    WHEN avg_temperature < 10 THEN 'Cold (< 10°C)'
                    WHEN avg_temperature < 20 THEN 'Mild (10-20°C)'
                    WHEN avg_temperature < 30 THEN 'Warm (20-30°C)'
                    ELSE 'Hot (> 30°C)'
                END
            ORDER BY avg_sales DESC;
        """,
                  ^
./database/query_data.py:94:21: W291 trailing whitespace
        "Weather Impact": """
            SELECT 
                CASE 
                    WHEN avg_temperature < 10 THEN 'Cold (< 10°C)'
                    WHEN avg_temperature < 20 THEN 'Mild (10-20°C)'
                    WHEN avg_temperature < 30 THEN 'Warm (20-30°C)'
                    ELSE 'Hot (> 30°C)'
                END as temperature_range,
                ROUND(AVG(sale_amount), 2) as avg_sales,
                COUNT(*) as total_records
            FROM sales_data
            GROUP BY 
                CASE 
                    WHEN avg_temperature < 10 THEN 'Cold (< 10°C)'
                    WHEN avg_temperature < 20 THEN 'Mild (10-20°C)'
                    WHEN avg_temperature < 30 THEN 'Warm (20-30°C)'
                    ELSE 'Hot (> 30°C)'
                END
            ORDER BY avg_sales DESC;
        """,
                    ^
./database/query_data.py:103:21: W291 trailing whitespace
        "Weather Impact": """
            SELECT 
                CASE 
                    WHEN avg_temperature < 10 THEN 'Cold (< 10°C)'
                    WHEN avg_temperature < 20 THEN 'Mild (10-20°C)'
                    WHEN avg_temperature < 30 THEN 'Warm (20-30°C)'
                    ELSE 'Hot (> 30°C)'
                END as temperature_range,
                ROUND(AVG(sale_amount), 2) as avg_sales,
                COUNT(*) as total_records
            FROM sales_data
            GROUP BY 
                CASE 
                    WHEN avg_temperature < 10 THEN 'Cold (< 10°C)'
                    WHEN avg_temperature < 20 THEN 'Mild (10-20°C)'
                    WHEN avg_temperature < 30 THEN 'Warm (20-30°C)'
                    ELSE 'Hot (> 30°C)'
                END
            ORDER BY avg_sales DESC;
        """,
                    ^
./database/query_data.py:104:21: W291 trailing whitespace
        "Weather Impact": """
            SELECT 
                CASE 
                    WHEN avg_temperature < 10 THEN 'Cold (< 10°C)'
                    WHEN avg_temperature < 20 THEN 'Mild (10-20°C)'
                    WHEN avg_temperature < 30 THEN 'Warm (20-30°C)'
                    ELSE 'Hot (> 30°C)'
                END as temperature_range,
                ROUND(AVG(sale_amount), 2) as avg_sales,
                COUNT(*) as total_records
            FROM sales_data
            GROUP BY 
                CASE 
                    WHEN avg_temperature < 10 THEN 'Cold (< 10°C)'
                    WHEN avg_temperature < 20 THEN 'Mild (10-20°C)'
                    WHEN avg_temperature < 30 THEN 'Warm (20-30°C)'
                    ELSE 'Hot (> 30°C)'
                END
            ORDER BY avg_sales DESC;
        """,
                    ^
./database/query_data.py:113:19: W291 trailing whitespace
        "Holiday vs Non-Holiday Sales": """
            SELECT 
                holiday_flag,
                COUNT(*) as total_records,
                ROUND(AVG(sale_amount), 2) as avg_sales,
                ROUND(AVG(discount), 2) as avg_discount,
                COUNT(DISTINCT store_id) as stores_with_sales
            FROM sales_data
            GROUP BY holiday_flag;
        """,
                  ^
./database/repository.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Template repository demonstrating connection pooling, caching, and pagination.
"""
^
./database/repository.py:28:80: E501 line too long (83 > 79 characters)
            query = f"SELECT * FROM {table} ORDER BY {order_by} LIMIT $1 OFFSET $2"
                                                                               ^
./database/repository.py:29:80: E501 line too long (88 > 79 characters)
            records = await conn.fetch(query, kwargs.get("limit"), kwargs.get("offset"))
                                                                               ^
./database/repository.py:57:80: E501 line too long (86 > 79 characters)
            set_clause = ", ".join(f"{k} = ${i+2}" for i, k in enumerate(data.keys()))
                                                                               ^
./database/repository.py:86:80: E501 line too long (88 > 79 characters)
    async def get_sales_by_store(self, store_id: int, **kwargs) -> List[Dict[str, Any]]:
                                                                               ^
./database/repository.py:98:80: E501 line too long (81 > 79 characters)
                query, store_id, kwargs.get("limit", 50), kwargs.get("offset", 0)
                                                                               ^
./database/repository.py:103:80: E501 line too long (84 > 79 characters)
    async def get_store_statistics(self, store_id: int) -> Optional[Dict[str, Any]]:
                                                                               ^
./database/split_csv.py:1:1: D205 1 blank line required between summary line and description
"""
Split large CSV files into smaller chunks for easier uploading to Supabase.
This script specifically targets the sales_data_csv.csv file which is too large
for the Supabase dashboard's 100MB upload limit.
"""
^
./database/split_csv.py:9:1: F401 'numpy as np' imported but unused
import numpy as np
^
./database/split_csv.py:40:80: E501 line too long (90 > 79 characters)
        f"Will create {num_chunks} files with approximately {max_rows_per_file} rows each"
                                                                               ^
./database/split_csv.py:43:80: E501 line too long (83 > 79 characters)
    # Read and split the CSV in chunks to avoid loading the entire file into memory
                                                                               ^
./database/split_csv.py:81:80: E501 line too long (85 > 79 characters)
        f.write("-- SQL script to load all CSV chunks into the sales_data table\n\n")
                                                                               ^
./database/split_csv.py:88:80: E501 line too long (86 > 79 characters)
            f.write("    first_category_id, second_category_id, third_category_id,\n")
                                                                               ^
./database/split_csv.py:101:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to split the sales data CSV file."""
^
./database/split_csv.py:123:80: E501 line too long (86 > 79 characters)
    # Calculate optimal chunk size (aim for ~80MB per file to stay safely under 100MB)
                                                                               ^
./database/split_csv.py:140:11: F541 f-string is missing placeholders
    print(f"Each file should be under 100MB to meet the dashboard upload limit")
          ^
./database/split_csv.py:140:80: E501 line too long (80 > 79 characters)
    print(f"Each file should be under 100MB to meet the dashboard upload limit")
                                                                               ^
./database/test_mappings.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to test the mappings with sample data from the database.
"""
^
./database/test_mappings.py:9:1: F401 'mappings.FIRST_CATEGORY_MAPPINGS' imported but unused
from mappings import (
^
./database/test_mappings.py:9:1: F401 'mappings.get_store_type' imported but unused
from mappings import (
^
./database/test_mappings.py:35:80: E501 line too long (147 > 79 characters)
    connection_string = f"postgresql://{db_params['user']}:{db_params['password']}@{db_params['host']}:{db_params['port']}/{db_params['database']}"
                                                                               ^
./database/test_mappings.py:101:11: W291 trailing whitespace
    store_query = """
    SELECT 
        s.city_id,
        s.store_id,
        ROUND(AVG(sd.sale_amount), 2) as avg_sale_amount,
        COUNT(DISTINCT sd.product_id) as unique_products,
        SUM(CASE WHEN sd.stock_hour6_22_cnt > 0 THEN 1 ELSE 0 END) as stockout_days,
        MAX(sd.hours_sale) as sample_hour_sale
    FROM store_hierarchy s
    JOIN sales_data sd ON s.store_id = sd.store_id
    GROUP BY s.city_id, s.store_id
    ORDER BY avg_sale_amount DESC
    LIMIT 10;
    """
          ^
./database/test_mappings.py:106:80: E501 line too long (84 > 79 characters)
    store_query = """
    SELECT 
        s.city_id,
        s.store_id,
        ROUND(AVG(sd.sale_amount), 2) as avg_sale_amount,
        COUNT(DISTINCT sd.product_id) as unique_products,
        SUM(CASE WHEN sd.stock_hour6_22_cnt > 0 THEN 1 ELSE 0 END) as stockout_days,
        MAX(sd.hours_sale) as sample_hour_sale
    FROM store_hierarchy s
    JOIN sales_data sd ON s.store_id = sd.store_id
    GROUP BY s.city_id, s.store_id
    ORDER BY avg_sale_amount DESC
    LIMIT 10;
    """
                     
           
                  
                   
      ^
./database/test_mappings.py:125:15: F541 f-string is missing placeholders
        print(f"Performance:")
              ^
./database/test_mappings.py:145:11: W291 trailing whitespace
    product_query = """
    SELECT 
        p.management_group_id,
        p.first_category_id,
        p.product_id,
        ROUND(AVG(s.sale_amount), 2) as avg_sale_amount,
        ROUND(AVG(s.discount), 2) as avg_discount,
        COUNT(DISTINCT s.store_id) as num_stores_selling,
        SUM(CASE WHEN s.stock_hour6_22_cnt > 0 THEN 1 ELSE 0 END) as total_stockout_days
    FROM product_hierarchy p
    JOIN sales_data s ON p.product_id = s.product_id
    GROUP BY p.management_group_id, p.first_category_id, p.product_id
    ORDER BY avg_sale_amount DESC
    LIMIT 10;
    """
          ^
./database/test_mappings.py:152:80: E501 line too long (88 > 79 characters)
    product_query = """
    SELECT 
        p.management_group_id,
        p.first_category_id,
        p.product_id,
        ROUND(AVG(s.sale_amount), 2) as avg_sale_amount,
        ROUND(AVG(s.discount), 2) as avg_discount,
        COUNT(DISTINCT s.store_id) as num_stores_selling,
        SUM(CASE WHEN s.stock_hour6_22_cnt > 0 THEN 1 ELSE 0 END) as total_stockout_days
    FROM product_hierarchy p
    JOIN sales_data s ON p.product_id = s.product_id
    GROUP BY p.management_group_id, p.first_category_id, p.product_id
    ORDER BY avg_sale_amount DESC
    LIMIT 10;
    """
                       
           
                              
            ^
./database/test_mappings.py:175:15: F541 f-string is missing placeholders
        print(f"Performance:")
              ^
./database/test_mappings.py:185:11: W291 trailing whitespace
    weather_query = """
    SELECT 
        city_id,
        ROUND(AVG(avg_temperature), 1) as avg_temp,
        ROUND(AVG(avg_humidity), 1) as avg_humidity,
        ROUND(AVG(precpt), 1) as avg_precipitation,
        COUNT(DISTINCT sale_date) as days_with_data
    FROM sales_data
    GROUP BY city_id
    ORDER BY avg_temp DESC;
    """
          ^
./database/test_mappings.py:200:15: F541 f-string is missing placeholders
        print(f"Weather Patterns:")
              ^
./database/test_mappings.py:206:80: E501 line too long (87 > 79 characters)
            f"- Price Adjustment Factor: {CITY_PRICE_ADJUSTMENTS[city['city_id']]:.2f}"
                                                                               ^
./database/upload_chunks.py:1:1: D205 1 blank line required between summary line and description
"""
Upload split CSV files to Supabase using the REST API.
This script allows uploading large datasets in chunks that were created with split_csv.py.
"""
^
./database/upload_chunks.py:3:80: E501 line too long (90 > 79 characters)
"""
Upload split CSV files to Supabase using the REST API.
This script allows uploading large datasets in chunks that were created with split_csv.py.
"""
   
                                                      
                    ^
./database/upload_chunks.py:15:1: E402 module level import not at top of file
from database.connection import get_supabase_client
^
./database/upload_chunks.py:52:80: E501 line too long (88 > 79 characters)
    with tqdm(total=total_rows, desc=f"Uploading {os.path.basename(csv_file)}") as pbar:
                                                                               ^
./database/upload_chunks.py:56:37: E203 whitespace before ':'
                batch = chunk.iloc[i : i + batch_size]
                                    ^
./database/upload_chunks.py:63:80: E501 line too long (83 > 79 characters)
                    response = supabase.table(table_name).insert(records).execute()
                                                                               ^
./database/upload_chunks.py:84:80: E501 line too long (80 > 79 characters)
        print(f"Successfully uploaded {uploaded_rows} out of {total_rows} rows")
                                                                               ^
./database/upload_chunks.py:109:80: E501 line too long (80 > 79 characters)
        print(f"No files matching pattern {file_pattern} found in {chunks_dir}")
                                                                               ^
./database/upload_chunks.py:117:80: E501 line too long (85 > 79 characters)
        print(f"\nUploading file {i+1}/{len(chunk_files)}: {os.path.basename(file)}")
                                                                               ^
./database/upload_chunks.py:133:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to upload all chunks."""
^
./database/upload_chunks.py:151:80: E501 line too long (88 > 79 characters)
        input("Enter target table name (default: sales_data): ").strip() or "sales_data"
                                                                               ^
./database/upload_chunks.py:157:80: E501 line too long (84 > 79 characters)
            input("Enter batch size for upload (default: 1000): ").strip() or "1000"
                                                                               ^
./database/upload_chunks.py:160:9: F841 local variable 'batch_size' is assigned to but never used
        batch_size = 1000
        ^
./database/upload_chunks.py:165:80: E501 line too long (87 > 79 characters)
        input("Enter file pattern to match (default: sales_data_part_*.csv): ").strip()
                                                                               ^
./database/upload_chunks.py:175:80: E501 line too long (86 > 79 characters)
        print("\nSome files failed to upload completely. Check the logs for details.")
                                                                               ^
./main.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Main application file for the Retail Sales Forecasting API.
"""
^
./main.py:6:1: F401 'fastapi.HTTPException' imported but unused
from fastapi import FastAPI, HTTPException, Query
^
./main.py:10:1: F401 'typing.Optional' imported but unused
from typing import List, Dict, Any, Optional
^
./main.py:12:1: F401 'pandas as pd' imported but unused
import pandas as pd
^
./main.py:14:1: F401 'json' imported but unused
import json
^
./main.py:23:80: E501 line too long (103 > 79 characters)
    description="API for forecasting retail sales, analyzing promotions, and predicting stockout risk",
                                                                               ^
./main.py:41:1: D101 Missing docstring in public class
class ForecastResponse(BaseModel):
^
./main.py:50:1: D101 Missing docstring in public class
class PromotionAnalysisResponse(BaseModel):
^
./main.py:57:1: D101 Missing docstring in public class
class StockoutRiskResponse(BaseModel):
^
./main.py:69:1: D400 First line should end with a period
    """Generate mock forecast data for demo purposes"""
^
./main.py:73:80: E501 line too long (83 > 79 characters)
    dates = [(today + timedelta(days=i)).strftime("%Y-%m-%d") for i in range(days)]
                                                                               ^
./main.py:78:80: E501 line too long (83 > 79 characters)
    seasonality = 2 * np.sin(np.arange(days) * 2 * np.pi / 7)  # Weekly seasonality
                                                                               ^
./main.py:80:80: E501 line too long (81 > 79 characters)
    forecasted_values = base + trend + seasonality + np.random.normal(0, 1, days)
                                                                               ^
./main.py:84:80: E501 line too long (84 > 79 characters)
    uncertainty = 1.0 + (np.arange(days) * 0.05)  # Increasing uncertainty over time
                                                                               ^
./main.py:108:1: D400 First line should end with a period
    """Generate mock promotion analysis for demo purposes"""
^
./main.py:120:80: E501 line too long (83 > 79 characters)
        discount = int(np.random.choice(discount_options))  # Convert to Python int
                                                                               ^
./main.py:144:1: D400 First line should end with a period
    """Generate mock stockout risk assessment for demo purposes"""
^
./main.py:164:80: E501 line too long (82 > 79 characters)
        "seasonality": float(np.random.random() * 0.1),  # Convert to Python float
                                                                               ^
./main.py:186:80: E501 line too long (87 > 79 characters)
        target_stock = int(round(base_level * weekday_factor))  # Convert to Python int
                                                                               ^
./main.py:211:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def root():
^
./main.py:211:1: D103 Missing docstring in public function
async def root():
^
./main.py:220:80: E501 line too long (86 > 79 characters)
    "/api/forecast/{city_id}/{store_id}/{product_id}", response_model=ForecastResponse
                                                                               ^
./main.py:222:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def get_forecast(
^
./main.py:226:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(30, description="Number of days to forecast"),
                ^
./main.py:228:1: D400 First line should end with a period
    """Get sales forecast for a specific product in a specific store"""
^
./main.py:229:80: E501 line too long (96 > 79 characters)
    # In a real application, you would fetch data from your database and use your forecast model
                                                                               ^
./main.py:238:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def get_promotion_impact(store_id: int, product_id: int):
^
./main.py:239:1: D400 First line should end with a period
    """Analyze the impact of promotions on a specific product in a specific store"""
^
./main.py:239:80: E501 line too long (84 > 79 characters)
    """Analyze the impact of promotions on a specific product in a specific store"""
                                                                               ^
./main.py:240:80: E501 line too long (97 > 79 characters)
    # In a real application, you would fetch data from your database and use your promotion model
                                                                               ^
./main.py:246:80: E501 line too long (85 > 79 characters)
    "/api/stockout/risk/{store_id}/{product_id}", response_model=StockoutRiskResponse
                                                                               ^
./main.py:248:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def get_stockout_risk(store_id: int, product_id: int):
^
./main.py:249:1: D400 First line should end with a period
    """Assess the risk of stockout for a specific product in a specific store"""
^
./main.py:249:80: E501 line too long (80 > 79 characters)
    """Assess the risk of stockout for a specific product in a specific store"""
                                                                               ^
./main.py:250:80: E501 line too long (96 > 79 characters)
    # In a real application, you would fetch data from your database and use your stockout model
                                                                               ^
./models/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting models package.
"""
^
./models/forecast_models.py:1:1: D100 Missing docstring in public module
from typing import List, Dict, Any, Optional
^
./models/forecast_models.py:10:80: E501 line too long (81 > 79 characters)
    category_id: Optional[int] = None  # Used for filtering via product_hierarchy
                                                                               ^
./models/holiday_impact.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Holiday impact analysis module for evaluating sales lift during holidays.
"""
^
./models/holiday_impact.py:6:1: F401 'numpy as np' imported but unused
import numpy as np
^
./models/holiday_impact.py:10:1: D400 First line should end with a period
    """
    Analyze sales lift during holidays

    Args:
        df: DataFrame with sales data including holiday_flag

    Returns:
        DataFrame with holiday impact metrics
    """
^
./models/holiday_impact.py:104:1: D400 First line should end with a period
    """
    Get dates for a specific holiday from sales data

    Args:
        df: DataFrame with sales data
        holiday_name: Name of the holiday to extract

    Returns:
        List of holiday dates
    """
^
./models/holiday_impact.py:123:80: E501 line too long (87 > 79 characters)
    holiday_data = df[(df["holiday_flag"] == 1) & (df["holiday_name"] == holiday_name)]
                                                                               ^
./models/holiday_impact.py:132:1: D400 First line should end with a period
    """
    Get list of all holiday names in the dataset

    Args:
        df: DataFrame with sales data

    Returns:
        List of unique holiday names
    """
^
./models/promo_uplift.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Promotion uplift model for estimating promotion effectiveness.
"""
^
./models/promo_uplift.py:5:1: F401 'numpy as np' imported but unused
import numpy as np
^
./models/promo_uplift.py:6:1: F401 'pandas as pd' imported but unused
import pandas as pd
^
./models/promo_uplift.py:14:1: D400 First line should end with a period
    """Model for predicting promotion effectiveness"""
^
./models/promo_uplift.py:17:1: D400 First line should end with a period
        """Initialize the promotion uplift model"""
^
./models/promo_uplift.py:32:1: D400 First line should end with a period
        """Prepare data for uplift modeling"""
^
./models/promo_uplift.py:34:80: E501 line too long (104 > 79 characters)
        # For this demo, we'll use a simple approach: compare sales to the average sales for the product
                                                                               ^
./models/promo_uplift.py:38:80: E501 line too long (88 > 79 characters)
        product_avg = promo_df.groupby("product_id")["sale_amount"].mean().reset_index()
                                                                               ^
./models/promo_uplift.py:64:1: D400 First line should end with a period
        """Fit the uplift model"""
^
./models/promo_uplift.py:90:1: D400 First line should end with a period
        """Predict uplift for new data"""
^
./models/promo_uplift.py:92:80: E501 line too long (87 > 79 characters)
        available_features = [col for col in self.feature_columns if col in df.columns]
                                                                               ^
./models/promo_uplift_model.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Promotion uplift model to estimate the impact of promotions on sales.
"""
^
./models/promo_uplift_model.py:20:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
./models/promo_uplift_model.py:26:1: D200 One-line docstring should fit on one line with quotes
    """
    Model to predict promotion uplift (how much sales increase due to promotions).
    """
^
./models/promo_uplift_model.py:27:80: E501 line too long (82 > 79 characters)
    """
    Model to predict promotion uplift (how much sales increase due to promotions).
    """
       
                                                                       ^
./models/promo_uplift_model.py:35:80: E501 line too long (104 > 79 characters)
        """
        Initialize promotion uplift model.

        Args:
            model_type (str): Type of model to use - 'random_forest', 'gradient_boost', or 'elastic_net'
            model_params (dict): Parameters for the model
        """
           
                                          

             
         ^
./models/promo_uplift_model.py:49:80: E501 line too long (81 > 79 characters)
        logger.info(f"Initialized PromoUpliftModel with model_type={model_type}")
                                                                               ^
./models/promo_uplift_model.py:81:80: E501 line too long (88 > 79 characters)
                f"Supported types are: 'random_forest', 'gradient_boost', 'elastic_net'"
                                                                               ^
./models/promo_uplift_model.py:85:80: E501 line too long (82 > 79 characters)
        self.pipeline = Pipeline([("scaler", self.scaler), ("model", self.model)])
                                                                               ^
./models/promo_uplift_model.py:93:80: E501 line too long (81 > 79 characters)
        """
        Prepare data for modeling by creating features and target.

        Args:
            df (pd.DataFrame): Input dataframe with sales and promotion data
            target_col (str): Column name containing the target variable (uplift)
            drop_cols (list): Columns to drop from features

        Returns:
            tuple: X (features), y (target)
        """
           
                                                                  
^
./models/promo_uplift_model.py:113:80: E501 line too long (89 > 79 characters)
                    f"Required columns for uplift calculation not found: {required_cols}"
                                                                               ^
./models/promo_uplift_model.py:116:80: E501 line too long (82 > 79 characters)
            # Calculate uplift as the difference between promo and non-promo sales
                                                                               ^
./models/promo_uplift_model.py:117:80: E501 line too long (89 > 79 characters)
            # Group by relevant dimensions and calculate average sales with/without promo
                                                                               ^
./models/promo_uplift_model.py:120:80: E501 line too long (85 > 79 characters)
                for col in ["store_id", "product_id", "city_id", "first_category_id"]
                                                                               ^
./models/promo_uplift_model.py:125:80: E501 line too long (84 > 79 characters)
                raise ValueError("No grouping columns found for uplift calculation")
                                                                               ^
./models/promo_uplift_model.py:148:80: E501 line too long (84 > 79 characters)
            print("promo_flag counts:", df["promo_flag"].value_counts(dropna=False))
                                                                               ^
./models/promo_uplift_model.py:157:80: E501 line too long (212 > 79 characters)
                    f'Not enough promo/non-promo sales for uplift calculation. Data shape: {shape_info}, promo_flag counts: {df["promo_flag"].value_counts(dropna=False).to_dict()}, columns: {df.columns.tolist()}'
                                                                               ^
./models/promo_uplift_model.py:160:80: E501 line too long (83 > 79 characters)
                avg_sales_pivot["promo_sales"] - avg_sales_pivot["non_promo_sales"]
                                                                               ^
./models/promo_uplift_model.py:187:80: E501 line too long (81 > 79 characters)
        drop_cols_existing = [col for col in cols_to_drop if col in data.columns]
                                                                               ^
./models/promo_uplift_model.py:213:80: E501 line too long (81 > 79 characters)
        """
        Train the promotion uplift model.

        Args:
            df (pd.DataFrame): Input dataframe with sales and promotion data
            target_col (str): Column name containing the target variable (uplift)
            drop_cols (list): Columns to drop from features
            test_size (float): Proportion of data to use for testing

        Returns:
            dict: Training metrics
        """
           
                                         

             
          ^
./models/promo_uplift_model.py:229:80: E501 line too long (88 > 79 characters)
        logger.info(f"Training {self.model_type} model with {X_train.shape[0]} samples")
                                                                               ^
./models/promo_uplift_model.py:245:80: E501 line too long (98 > 79 characters)
                f"Top 5 features: {', '.join(self.feature_importance['feature'].head().tolist())}"
                                                                               ^
./models/promo_uplift_model.py:301:80: E501 line too long (88 > 79 characters)
    def analyze_promotion_effectiveness(self, df, group_cols=None, target_col="uplift"):
                                                                               ^
./models/promo_uplift_model.py:308:80: E501 line too long (81 > 79 characters)
        """
        Analyze promotion effectiveness by different dimensions.

        Args:
            df (pd.DataFrame): Input dataframe with sales and promotion data
            group_cols (list): Columns to group by for analysis
            target_col (str): Column name containing the target variable (uplift)

        Returns:
            pd.DataFrame: Analysis results
        """
           
                                                                

 ^
./models/promo_uplift_model.py:314:80: E501 line too long (82 > 79 characters)
            logger.warning("Model not trained, will use actual data for analysis")
                                                                               ^
./models/promo_uplift_model.py:356:80: E501 line too long (88 > 79 characters)
        group_results = group_results.sort_values(f"{target_col}_mean", ascending=False)
                                                                               ^
./models/promo_uplift_model.py:381:80: E501 line too long (99 > 79 characters)
                f"promo_uplift_{self.model_type}_{datetime.now().strftime('%Y%m%d%H%M%S')}.joblib",
                                                                               ^
./models/promo_uplift_model.py:422:80: E501 line too long (87 > 79 characters)
                self.feature_importance = features_data.get("feature_importance", None)
                                                                               ^
./models/promo_uplift_model.py:442:80: E501 line too long (84 > 79 characters)
            datetime(2022, 1, 1) + timedelta(days=i % 365) for i in range(n_samples)
                                                                               ^
./models/promo_uplift_model.py:445:80: E501 line too long (84 > 79 characters)
        "promo_flag": np.random.choice([True, False], size=n_samples, p=[0.3, 0.7]),
                                                                               ^
./models/prophet_forecaster.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Prophet forecasting model wrapper.
"""
^
./models/prophet_forecaster.py:11:1: D400 First line should end with a period
    """Wrapper class for Facebook Prophet forecasting model"""
^
./models/prophet_forecaster.py:14:80: E501 line too long (82 > 79 characters)
        self, include_weather=True, include_holidays=True, include_promotions=True
                                                                               ^
./models/prophet_forecaster.py:16:1: D400 First line should end with a period
        """Initialize the Prophet model with appropriate components"""
^
./models/prophet_forecaster.py:22:80: E501 line too long (86 > 79 characters)
            growth="logistic",  # Added logistic growth to enforce non-negative values
                                                                               ^
./models/prophet_forecaster.py:32:1: D400 First line should end with a period
        """Add relevant regressors to the model based on configuration"""
^
./models/prophet_forecaster.py:54:1: D400 First line should end with a period
        """Prepare data for Prophet model"""
^
./models/prophet_forecaster.py:63:80: E501 line too long (86 > 79 characters)
            forecast_df = forecast_df.rename(columns={"dt": "ds", "sale_amount": "y"})
                                                                               ^
./models/prophet_forecaster.py:69:80: E501 line too long (84 > 79 characters)
            raise ValueError("Input DataFrame must have 'dt' or 'sale_date' column")
                                                                               ^
./models/prophet_forecaster.py:73:80: E501 line too long (81 > 79 characters)
                "Input DataFrame must have 'sale_amount' column to rename to 'y'"
                                                                               ^
./models/prophet_forecaster.py:100:1: D400 First line should end with a period
        """Fit the Prophet model"""
^
./models/prophet_forecaster.py:107:1: D400 First line should end with a period
        """Train the model (alias for fit)"""
^
./models/prophet_forecaster.py:128:1: D400 First line should end with a period
        """Generate forecast for future periods"""
^
./models/prophet_forecaster.py:132:80: E501 line too long (80 > 79 characters)
        forecast = self.predict(periods=periods, freq=freq, future_df=future_df)
                                                                               ^
./models/prophet_forecaster.py:136:1: D400 First line should end with a period
        """Generate forecast for the specified periods"""
^
./models/prophet_forecaster.py:139:80: E501 line too long (96 > 79 characters)
            f"DEBUG: periods={periods}, freq={freq}, future_df provided={future_df is not None}"
                                                                               ^
./models/prophet_forecaster.py:145:80: E501 line too long (83 > 79 characters)
            print(f"DEBUG: Future dataframe columns: {future_df.columns.tolist()}")
                                                                               ^
./models/prophet_forecaster.py:147:80: E501 line too long (93 > 79 characters)
            # For future data, we don't need to rename columns - just ensure ds column exists
                                                                               ^
./models/prophet_forecaster.py:167:80: E501 line too long (86 > 79 characters)
            print(f"DEBUG: Final future dataframe columns: {future.columns.tolist()}")
                                                                               ^
./models/prophet_forecaster.py:169:80: E501 line too long (87 > 79 characters)
            print("DEBUG: Creating future dataframe using model.make_future_dataframe")
                                                                               ^
./models/prophet_forecaster.py:170:80: E501 line too long (81 > 79 characters)
            future = self.model.make_future_dataframe(periods=periods, freq=freq)
                                                                               ^
./models/prophet_forecaster.py:201:1: D400 First line should end with a period
        """Plot forecast components"""
^
./models/stockout_analyzer.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Stockout analysis module for estimating demand during stockout periods.
"""
^
./models/stockout_analyzer.py:6:1: F401 'numpy as np' imported but unused
import numpy as np
^
./models/stockout_analyzer.py:10:1: D400 First line should end with a period
    """
    Estimate demand during stockout periods using historical patterns

    Args:
        df: DataFrame with sales data
        product_id: Optional filter by product
        store_id: Optional filter by store

    Returns:
        DataFrame with actual sales and estimated demand
    """
^
./models/stockout_analyzer.py:84:80: E501 line too long (82 > 79 characters)
            stock_df.at[idx, "estimated_demand"] = row["sale_amount"] * adjustment
                                                                               ^
./models/stockout_analyzer.py:87:80: E501 line too long (83 > 79 characters)
    stock_df["lost_sales"] = stock_df["estimated_demand"] - stock_df["sale_amount"]
                                                                               ^
./models/stockout_analyzer.py:96:1: D400 First line should end with a period
    """
    Summarize stockout impact

    Args:
        df: DataFrame with stockout analysis results

    Returns:
        Dictionary with stockout metrics
    """
^
./models/xgboost_forecaster.py:1:1: D100 Missing docstring in public module
./notebooks/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting notebooks package.
"""
^
./scripts/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting scripts package.
"""
^
./scripts/export_dataset.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to export FreshRetailNet-50K data from Hugging Face to various formats.
"""
^
./scripts/export_dataset.py:10:1: F401 'numpy as np' imported but unused
import numpy as np
^
./scripts/export_dataset.py:25:80: E501 line too long (92 > 79 characters)
        "Warning: Mapping data not found. City and store IDs won't be mapped to real names."
                                                                               ^
./scripts/export_dataset.py:30:1: D400 First line should end with a period
    """
    Load FreshRetailNet-50K data from Hugging Face

    Args:
        limit: Optional limit on number of records to load
        offset: Optional offset to start loading from

    Returns:
        DataFrame with sales data
    """
^
./scripts/export_dataset.py:66:80: E501 line too long (82 > 79 characters)
            df_train = df_train.iloc[records_to_skip_in_first_batch:].reset_index(
                                                                               ^
./scripts/export_dataset.py:85:80: E501 line too long (85 > 79 characters)
                        df_train = pd.concat([df_train, df_batch], ignore_index=True)
                                                                               ^
./scripts/export_dataset.py:89:80: E501 line too long (88 > 79 characters)
                            [df_train, df_batch.head(needed_records)], ignore_index=True
                                                                               ^
./scripts/export_dataset.py:97:80: E501 line too long (85 > 79 characters)
            print(f"Loaded {len(df_train)} records (offset {offset}, limit {limit})")
                                                                               ^
./scripts/export_dataset.py:100:80: E501 line too long (96 > 79 characters)
                "Loading full dataset - this may take a while and consume significant memory..."
                                                                               ^
./scripts/export_dataset.py:116:1: D400 First line should end with a period
    """
    Process and transform the data

    Args:
        df: Raw DataFrame from Hugging Face

    Returns:
        Processed DataFrame
    """
^
./scripts/export_dataset.py:172:80: E501 line too long (94 > 79 characters)
    # Assign holiday names (cycle through the list if there are more holiday dates than names)
                                                                               ^
./scripts/export_dataset.py:174:80: E501 line too long (88 > 79 characters)
        date: holidays[i % len(holidays)] for i, date in enumerate(unique_holiday_dates)
                                                                               ^
./scripts/export_dataset.py:198:1: D400 First line should end with a period
    """
    Export processed data to a file

    Args:
        df: Processed DataFrame
        output_path: Path to save the output file
        format: Export format (csv, json, parquet)
    """
^
./scripts/export_dataset.py:222:1: D400 First line should end with a period
    """
    Extract and export holiday data

    Args:
        df: Processed DataFrame
        output_path: Path to save the holidays file
    """
^
./scripts/export_dataset.py:236:80: E501 line too long (86 > 79 characters)
    holiday_data = holiday_data.rename(columns={"dt": "date", "holiday_name": "name"})
                                                                               ^
./scripts/export_dataset.py:247:1: D400 First line should end with a period
    """Main function to export data"""
^
./scripts/export_dataset.py:247:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to export data"""
^
./scripts/export_dataset.py:255:80: E501 line too long (85 > 79 characters)
    parser.add_argument("--offset", type=int, default=0, help="Offset to start from")
                                                                               ^
./scripts/export_dataset.py:264:80: E501 line too long (80 > 79 characters)
        "--output", type=str, default="data_export.csv", help="Output file path"
                                                                               ^
./scripts/export_dataset.py:267:80: E501 line too long (82 > 79 characters)
        "--holidays", action="store_true", help="Export holidays to separate file"
                                                                               ^
./scripts/export_dataset_clean.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to export FreshRetailNet-50K data with exactly matching table columns.
"""
^
./scripts/export_dataset_clean.py:5:1: F401 'os' imported but unused
import os
^
./scripts/export_dataset_clean.py:11:1: F401 'tqdm.tqdm' imported but unused
from tqdm import tqdm
^
./scripts/export_dataset_clean.py:19:1: D400 First line should end with a period
    """Load data from Hugging Face dataset"""
^
./scripts/export_dataset_clean.py:59:80: E501 line too long (82 > 79 characters)
                df = pd.concat([df, batch_df.head(batch_size)], ignore_index=True)
                                                                               ^
./scripts/export_dataset_clean.py:69:1: D400 First line should end with a period
    """Process data specifically for sales_data table"""
^
./scripts/export_dataset_clean.py:115:1: D400 First line should end with a period
    """Extract holiday data from sales data"""
^
./scripts/export_dataset_clean.py:154:80: E501 line too long (87 > 79 characters)
            {"date": date.strftime("%Y-%m-%d"), "name": holiday_name, "country": "USA"}
                                                                               ^
./scripts/export_dataset_clean.py:164:1: D400 First line should end with a period
    """Generate sample promotion data"""
^
./scripts/export_dataset_clean.py:187:80: E501 line too long (87 > 79 characters)
        ["Discount", "BOGO", "Bundle", "Clearance", "New Product"], size=num_promotions
                                                                               ^
./scripts/export_dataset_clean.py:195:80: E501 line too long (85 > 79 characters)
        ["End Cap", "Front", "Main Aisle", "Register", "Window"], size=num_promotions
                                                                               ^
./scripts/export_dataset_clean.py:219:1: D400 First line should end with a period
    """Export DataFrame to CSV"""
^
./scripts/export_dataset_clean.py:226:1: D400 First line should end with a period
    """Main function"""
^
./scripts/export_dataset_clean.py:226:1: D401 First line should be in imperative mood; try rephrasing
    """Main function"""
^
./scripts/export_dataset_clean.py:240:80: E501 line too long (85 > 79 characters)
    parser.add_argument("--offset", type=int, default=0, help="Offset to start from")
                                                                               ^
./scripts/export_dataset_clean.py:242:80: E501 line too long (81 > 79 characters)
        "--output", type=str, help="Output file path (default: [table_name].csv)"
                                                                               ^
./scripts/export_dataset_clean.py:258:80: E501 line too long (87 > 79 characters)
        raw_data = load_data(limit=10000)  # Need a large sample to get enough holidays
                                                                               ^
./scripts/generate_promotions.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to generate sample promotion data for the Supabase database.
"""
^
./scripts/generate_promotions.py:78:9: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
    for i in range(num_promotions):
        ^
./scripts/generate_promotions.py:85:80: E501 line too long (88 > 79 characters)
        days_from_start = np.random.randint(0, (end_dt - start_dt).days - duration_days)
                                                                               ^
./scripts/generate_promotions.py:116:1: D400 First line should end with a period
    """Export DataFrame to CSV"""
^
./scripts/generate_promotions.py:122:1: D400 First line should end with a period
    """Main function"""
^
./scripts/generate_promotions.py:122:1: D401 First line should be in imperative mood; try rephrasing
    """Main function"""
^
./scripts/generate_promotions.py:123:80: E501 line too long (82 > 79 characters)
    parser = argparse.ArgumentParser(description="Generate sample promotion data")
                                                                               ^
./scripts/generate_promotions.py:125:80: E501 line too long (81 > 79 characters)
        "--count", type=int, default=100, help="Number of promotions to generate"
                                                                               ^
./scripts/generate_promotions.py:146:80: E501 line too long (85 > 79 characters)
        num_promotions=args.count, start_date=args.start_date, end_date=args.end_date
                                                                               ^
./scripts/import_hierarchies.py:1:1: D100 Missing docstring in public module
import pandas as pd
^
./scripts/import_hierarchies.py:23:80: E501 line too long (108 > 79 characters)
        "INSERT INTO store_hierarchy (store_id, city_id) VALUES (%s, %s) ON CONFLICT (store_id) DO NOTHING",
                                                                               ^
./scripts/import_hierarchies.py:32:80: E501 line too long (99 > 79 characters)
        """
        INSERT INTO product_hierarchy
        (product_id, management_group_id, first_category_id, second_category_id, third_category_id)
        VALUES (%s, 0, 0, 0, 0) ON CONFLICT (product_id) DO NOTHING
        """,
           
                                     
                             ^
./scripts/import_sales_data.py:1:1: D100 Missing docstring in public module
import pandas as pd
^
./scripts/import_sales_data.py:66:80: E501 line too long (93 > 79 characters)
        """
        INSERT INTO sales_data (
            store_id, product_id, sale_date, sale_amount, sale_qty, discount, original_price,
            stock_hour6_22_cnt, stock_hour6_14_cnt, stock_hour14_22_cnt, holiday_flag, promo_flag, created_at
        ) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
        ON CONFLICT DO NOTHING
        """,
           
                                
                                  ^
./scripts/import_sales_data.py:67:80: E501 line too long (109 > 79 characters)
        """
        INSERT INTO sales_data (
            store_id, product_id, sale_date, sale_amount, sale_qty, discount, original_price,
            stock_hour6_22_cnt, stock_hour6_14_cnt, stock_hour14_22_cnt, holiday_flag, promo_flag, created_at
        ) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
        ON CONFLICT DO NOTHING
        """,
           
                                
                                  ^
./scripts/load_data.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to load FreshRetailNet-50K data from Hugging Face into Supabase database.
"""
^
./scripts/load_data.py:2:80: E501 line too long (80 > 79 characters)
"""
Script to load FreshRetailNet-50K data from Hugging Face into Supabase database.
"""
   
                                                                           ^
./scripts/load_data.py:8:1: F401 'json' imported but unused
import json
^
./scripts/load_data.py:11:1: F401 'numpy as np' imported but unused
import numpy as np
^
./scripts/load_data.py:21:1: F401 'utils.mapping_data.CITY_MAPPING' imported but unused
from utils.mapping_data import CITY_MAPPING, STORE_MAPPING
^
./scripts/load_data.py:21:1: F401 'utils.mapping_data.STORE_MAPPING' imported but unused
from utils.mapping_data import CITY_MAPPING, STORE_MAPPING
^
./scripts/load_data.py:21:1: E402 module level import not at top of file
from utils.mapping_data import CITY_MAPPING, STORE_MAPPING
^
./scripts/load_data.py:28:1: D400 First line should end with a period
    """Simple connector class to execute SQL directly via Supabase REST API"""
^
./scripts/load_data.py:30:1: D107 Missing docstring in __init__
    def __init__(self):
^
./scripts/load_data.py:37:80: E501 line too long (95 > 79 characters)
                "Missing Supabase credentials. Set SUPABASE_URL and SUPABASE_KEY in .env file."
                                                                               ^
./scripts/load_data.py:41:1: D400 First line should end with a period
        """Execute SQL query directly using REST API"""
^
./scripts/load_data.py:44:80: E501 line too long (92 > 79 characters)
            "Authorization": f"Bearer {self.service_key if self.service_key else self.key}",
                                                                               ^
./scripts/load_data.py:52:80: E501 line too long (101 > 79 characters)
            # This is a simplified approach - for complex queries, you'd need to build the proper URL
                                                                               ^
./scripts/load_data.py:53:80: E501 line too long (82 > 79 characters)
            # For demo, we're only supporting simple INSERT/CREATE/DROP operations
                                                                               ^
./scripts/load_data.py:55:80: E501 line too long (89 > 79 characters)
                "SELECT queries not supported directly. Use the Supabase client instead."
                                                                               ^
./scripts/load_data.py:77:1: D400 First line should end with a period
    """
    Generate the SQL schema creation statements

    Returns:
        str: Complete SQL schema as a string
    """
^
./scripts/load_data.py:118:80: E501 line too long (92 > 79 characters)
    create_indexes = """
    -- Create indexes
    CREATE INDEX IF NOT EXISTS idx_sales_store_product ON sales_data (store_id, product_id);
    CREATE INDEX IF NOT EXISTS idx_sales_date ON sales_data (dt);
    CREATE INDEX IF NOT EXISTS idx_sales_city ON sales_data (city_id);
    CREATE INDEX IF NOT EXISTS idx_sales_category ON sales_data (first_category_id, second_category_id, third_category_id);
    """
                        
                     
                                ^
./scripts/load_data.py:121:80: E501 line too long (123 > 79 characters)
    create_indexes = """
    -- Create indexes
    CREATE INDEX IF NOT EXISTS idx_sales_store_product ON sales_data (store_id, product_id);
    CREATE INDEX IF NOT EXISTS idx_sales_date ON sales_data (dt);
    CREATE INDEX IF NOT EXISTS idx_sales_city ON sales_data (city_id);
    CREATE INDEX IF NOT EXISTS idx_sales_category ON sales_data (first_category_id, second_category_id, third_category_id);
    """
                        
                     
                                ^
./scripts/load_data.py:171:1: D400 First line should end with a period
    """
    Create database schema in Supabase

    Args:
        db_conn: SupabaseDirectConnector instance
    """
^
./scripts/load_data.py:200:1: D400 First line should end with a period
    """
    Load FreshRetailNet-50K data from Hugging Face

    Args:
        limit: Optional limit on number of records to load (for testing)

    Returns:
        DataFrame with sales data
    """
^
./scripts/load_data.py:232:80: E501 line too long (82 > 79 characters)
            # Start from the second batch since we already processed the first one
                                                                               ^
./scripts/load_data.py:237:80: E501 line too long (88 > 79 characters)
                if i >= batches_needed - 1:  # -1 because we already processed one batch
                                                                               ^
./scripts/load_data.py:248:80: E501 line too long (96 > 79 characters)
                "Loading full dataset - this may take a while and consume significant memory..."
                                                                               ^
./scripts/load_data.py:259:80: E501 line too long (81 > 79 characters)
                    print(f"Processed {i*batch_size + len(df_train)} records...")
                                                                               ^
./scripts/load_data.py:273:1: D400 First line should end with a period
    """
    Process and transform the data for Supabase

    Args:
        df: Raw DataFrame from Hugging Face

    Returns:
        Processed DataFrame ready for database import
    """
^
./scripts/load_data.py:329:80: E501 line too long (94 > 79 characters)
    # Assign holiday names (cycle through the list if there are more holiday dates than names)
                                                                               ^
./scripts/load_data.py:331:80: E501 line too long (88 > 79 characters)
        date: holidays[i % len(holidays)] for i, date in enumerate(unique_holiday_dates)
                                                                               ^
./scripts/load_data.py:343:1: D400 First line should end with a period
    """
    Generate SQL INSERT statements for the data

    Args:
        df: Processed DataFrame
        batch_size: Number of records in each INSERT statement

    Returns:
        list: List of SQL INSERT statements
    """
^
./scripts/load_data.py:382:80: E501 line too long (87 > 79 characters)
                f"({row['city_id']}, {row['store_id']}, {row['management_group_id']}, "
                                                                               ^
./scripts/load_data.py:384:80: E501 line too long (110 > 79 characters)
            values += f"{row['first_category_id']}, {row['second_category_id']}, {row['third_category_id']}, "
                                                                               ^
./scripts/load_data.py:385:80: E501 line too long (83 > 79 characters)
            values += f"{row['product_id']}, '{row['dt']}', {row['sale_amount']}, "
                                                                               ^
./scripts/load_data.py:386:80: E501 line too long (96 > 79 characters)
            values += f"{row['stock_hour6_22_cnt']}, {row['discount']}, {row['holiday_flag']}, "
                                                                               ^
./scripts/load_data.py:388:80: E501 line too long (86 > 79 characters)
                f"{row['activity_flag']}, {row['precpt']}, {row['avg_temperature']}, "
                                                                               ^
./scripts/load_data.py:398:56: W291 trailing whitespace
            insert_query = f"""
            -- Insert batch {i+1}/{n_batches}
            INSERT INTO sales_data (
                city_id, store_id, management_group_id, 
                first_category_id, second_category_id, third_category_id,
                product_id, dt, sale_amount, stock_hour6_22_cnt, 
                discount, holiday_flag, activity_flag, precpt, 
                avg_temperature, avg_humidity, avg_wind_level
            ) 
            VALUES {', '.join(values_list)};
            """
                               
                       ^
./scripts/load_data.py:400:65: W291 trailing whitespace
            insert_query = f"""
            -- Insert batch {i+1}/{n_batches}
            INSERT INTO sales_data (
                city_id, store_id, management_group_id, 
                first_category_id, second_category_id, third_category_id,
                product_id, dt, sale_amount, stock_hour6_22_cnt, 
                discount, holiday_flag, activity_flag, precpt, 
                avg_temperature, avg_humidity, avg_wind_level
            ) 
            VALUES {', '.join(values_list)};
            """
                               
                                ^
./scripts/load_data.py:401:63: W291 trailing whitespace
            insert_query = f"""
            -- Insert batch {i+1}/{n_batches}
            INSERT INTO sales_data (
                city_id, store_id, management_group_id, 
                first_category_id, second_category_id, third_category_id,
                product_id, dt, sale_amount, stock_hour6_22_cnt, 
                discount, holiday_flag, activity_flag, precpt, 
                avg_temperature, avg_humidity, avg_wind_level
            ) 
            VALUES {', '.join(values_list)};
            """
                               
                              ^
./scripts/load_data.py:403:14: W291 trailing whitespace
            insert_query = f"""
            -- Insert batch {i+1}/{n_batches}
            INSERT INTO sales_data (
                city_id, store_id, management_group_id, 
                first_category_id, second_category_id, third_category_id,
                product_id, dt, sale_amount, stock_hour6_22_cnt, 
                discount, holiday_flag, activity_flag, precpt, 
                avg_temperature, avg_humidity, avg_wind_level
            ) 
            VALUES {', '.join(values_list)};
            """
             ^
./scripts/load_data.py:413:1: D400 First line should end with a period
    """
    Generate SQL INSERT statements for holiday data

    Args:
        df: Processed DataFrame with holiday_name column

    Returns:
        list: List of SQL INSERT statements for holidays
    """
^
./scripts/load_data.py:450:1: D400 First line should end with a period
    """
    Insert data into Supabase database using the REST API

    Args:
        db_conn: SupabaseDirectConnector instance
        df: Processed DataFrame
        batch_size: Number of records to insert in each batch
    """
^
./scripts/load_data.py:472:80: E501 line too long (88 > 79 characters)
                    success_count += len(df) - (len(insert_statements) - 1) * batch_size
                                                                               ^
./scripts/load_data.py:480:80: E501 line too long (86 > 79 characters)
                f"Inserted approximately {success_count} records before interruption."
                                                                               ^
./scripts/load_data.py:487:80: E501 line too long (87 > 79 characters)
    print(f"Data insertion completed! Inserted approximately {success_count} records.")
                                                                               ^
./scripts/load_data.py:491:1: D400 First line should end with a period
    """
    Insert holiday data into holidays table

    Args:
        db_conn: SupabaseDirectConnector instance
        df: Processed DataFrame with holiday_name column
    """
^
./scripts/load_data.py:511:80: E501 line too long (81 > 79 characters)
            print(f"Error inserting holiday {i+1}/{len(insert_statements)}: {e}")
                                                                               ^
./scripts/load_data.py:517:1: D400 First line should end with a period
    """Main function to load data from Hugging Face to Supabase"""
^
./scripts/load_data.py:517:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to load data from Hugging Face to Supabase"""
^
./scripts/load_data.py:525:80: E501 line too long (85 > 79 characters)
        "--limit", type=int, default=None, help="Limit number of records for testing"
                                                                               ^
./scripts/setup_dirs.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to set up the directory structure for the FreshRetail Forecasting project.
"""
^
./scripts/setup_dirs.py:2:80: E501 line too long (81 > 79 characters)
"""
Script to set up the directory structure for the FreshRetail Forecasting project.
"""
   
                                                                           ^
./scripts/setup_dirs.py:6:1: F401 'sys' imported but unused
import sys
^
./scripts/setup_dirs.py:47:80: E501 line too long (84 > 79 characters)
                f.write(f'"""\nFreshRetail Forecasting {directory} package.\n"""\n')
                                                                               ^
./scripts/setup_dirs.py:53:1: D400 First line should end with a period
    """Main function"""
^
./scripts/setup_dirs.py:53:1: D401 First line should be in imperative mood; try rephrasing
    """Main function"""
^
./scripts/update_product_names.py:1:1: D100 Missing docstring in public module
import csv
^
./scripts/update_product_names.py:21:80: E501 line too long (130 > 79 characters)
    f"Updated product names written to data_export/product_hierarchy_updated.csv using {len(GROCERY_ITEMS)} unique grocery items."
                                                                               ^
./services/data_preprocessor.py:1:1: D205 1 blank line required between summary line and description
"""
Data preprocessing module for the FreshRetailNet-50K dataset.
Handles feature engineering, missing values, outliers, and normalization.
"""
^
./services/data_preprocessor.py:14:1: D101 Missing docstring in public class
class DataPreprocessor:
^
./services/data_preprocessor.py:41:80: E501 line too long (80 > 79 characters)
        df["is_weekend"] = df["sale_date"].dt.dayofweek.isin([5, 6]).astype(int)
                                                                               ^
./services/data_preprocessor.py:60:80: E501 line too long (82 > 79 characters)
            df["avg_humidity"], q=4, labels=["Low", "Medium", "High", "Very High"]
                                                                               ^
./services/data_preprocessor.py:65:80: E501 line too long (87 > 79 characters)
        df["is_windy"] = (df["avg_wind_level"] > df["avg_wind_level"].median()).astype(
                                                                               ^
./services/data_preprocessor.py:82:80: E501 line too long (85 > 79 characters)
    def _get_weather_condition(self, is_rainy, is_windy, temp_level, humidity_level):
                                                                               ^
./services/data_preprocessor.py:109:80: E501 line too long (82 > 79 characters)
        df["hours_sale_list"] = df["hours_sale"].apply(self.process_sequence_data)
                                                                               ^
./services/data_preprocessor.py:122:80: E501 line too long (81 > 79 characters)
                    else ("Evening_Peak" if np.argmax(x) > 12 else "Midday_Peak")
                                                                               ^
./services/data_preprocessor.py:129:80: E501 line too long (82 > 79 characters)
                len([1 for status in x["hours_stock_status_list"] if status == 0])
                                                                               ^
./services/data_preprocessor.py:148:80: E501 line too long (86 > 79 characters)
        weather_cols = ["avg_temperature", "avg_humidity", "precpt", "avg_wind_level"]
                                                                               ^
./services/data_preprocessor.py:176:80: E501 line too long (81 > 79 characters)
            (df["sale_amount"] < lower_bound) | (df["sale_amount"] > upper_bound)
                                                                               ^
./services/data_preprocessor.py:180:80: E501 line too long (83 > 79 characters)
        df["sale_amount_capped"] = df["sale_amount"].clip(lower_bound, upper_bound)
                                                                               ^
./services/feature_builder.py:1:1: D100 Missing docstring in public module
./services/forecast_service.py:1:1: D100 Missing docstring in public module
import asyncpg
^
./services/forecast_service.py:1:1: F401 'asyncpg' imported but unused
import asyncpg
^
./services/forecast_service.py:2:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./services/forecast_service.py:3:1: F401 'typing.List' imported but unused
from typing import Dict, List, Optional, Any
^
./services/forecast_service.py:3:1: F401 'typing.Optional' imported but unused
from typing import Dict, List, Optional, Any
^
./services/forecast_service.py:6:1: F401 'asyncio' imported but unused
import asyncio
^
./services/forecast_service.py:21:1: D200 One-line docstring should fit on one line with quotes
    """
    Generate sales forecast for specified parameters.
    """
^
./services/forecast_service.py:28:80: E501 line too long (81 > 79 characters)
    print(f"DEBUG: Model trained status: {getattr(model, 'trained', 'Unknown')}")
                                                                               ^
./services/forecast_service.py:36:80: E501 line too long (81 > 79 characters)
    weather_df = await fetch_weather_data_fn() if fetch_weather_data_fn else None
                                                                               ^
./services/forecast_service.py:40:80: E501 line too long (83 > 79 characters)
    promo_df = await fetch_promotion_data_fn() if fetch_promotion_data_fn else None
                                                                               ^
./services/forecast_service.py:45:80: E501 line too long (86 > 79 characters)
        "DEBUG: DataFrame columns:", df.columns.tolist() if df is not None else "None"
                                                                               ^
./services/forecast_service.py:89:11: F541 f-string is missing placeholders
    print(f"DEBUG: Model configuration:")
          ^
./services/forecast_service.py:90:80: E501 line too long (81 > 79 characters)
    print(f"  - include_holiday: {getattr(model, 'include_holiday', 'Not set')}")
                                                                               ^
./services/forecast_service.py:91:80: E501 line too long (81 > 79 characters)
    print(f"  - include_weather: {getattr(model, 'include_weather', 'Not set')}")
                                                                               ^
./services/forecast_service.py:92:80: E501 line too long (87 > 79 characters)
    print(f"  - include_promotions: {getattr(model, 'include_promotions', 'Not set')}")
                                                                               ^
./services/forecast_service.py:93:80: E501 line too long (83 > 79 characters)
    print(f"  - forecast_periods: {getattr(model, 'forecast_periods', 'Not set')}")
                                                                               ^
./services/forecast_service.py:137:80: E501 line too long (88 > 79 characters)
            mask = (promo_flags["ds"] >= promo_start) & (promo_flags["ds"] <= promo_end)
                                                                               ^
./services/forecast_service.py:142:80: E501 line too long (82 > 79 characters)
                promo_start = max(pd.to_datetime(promo["start_date"]), start_date)
                                                                               ^
./services/forecast_service.py:147:80: E501 line too long (80 > 79 characters)
                promo_flags.loc[mask, "discount"] = promo["discount_percentage"]
                                                                               ^
./services/forecast_service.py:148:80: E501 line too long (81 > 79 characters)
        future_features.update({"promo_flag": promo_flags[["ds", "promo_flag"]]})
                                                                               ^
./services/forecast_service.py:150:80: E501 line too long (81 > 79 characters)
            future_features.update({"discount": promo_flags[["ds", "discount"]]})
                                                                               ^
./services/forecast_service.py:151:80: E501 line too long (81 > 79 characters)
        print(f"DEBUG: Promotion features added: {list(future_features.keys())}")
                                                                               ^
./services/forecast_service.py:162:80: E501 line too long (80 > 79 characters)
    print(f"DEBUG: Base future dataframe columns: {future_df.columns.tolist()}")
                                                                               ^
./services/forecast_service.py:166:80: E501 line too long (81 > 79 characters)
            print(f"DEBUG: Merging feature '{feature}' into future dataframe...")
                                                                               ^
./services/forecast_service.py:168:80: E501 line too long (85 > 79 characters)
            print(f"DEBUG: Feature dataframe columns: {feature_df.columns.tolist()}")
                                                                               ^
./services/forecast_service.py:170:80: E501 line too long (82 > 79 characters)
            print(f"DEBUG: Future dataframe shape after merge: {future_df.shape}")
                                                                               ^
./services/forecast_service.py:181:80: E501 line too long (111 > 79 characters)
            f"DEBUG: Forecast completed. Shape: {forecast.shape if hasattr(forecast, 'shape') else 'No shape'}"
                                                                               ^
./services/forecast_service.py:184:80: E501 line too long (117 > 79 characters)
            f"DEBUG: Forecast columns: {forecast.columns.tolist() if hasattr(forecast, 'columns') else 'No columns'}"
                                                                               ^
./services/forecast_service.py:187:80: E501 line too long (97 > 79 characters)
            f"DEBUG: Forecast head: {forecast.head() if hasattr(forecast, 'head') else forecast}"
                                                                               ^
./services/forecast_service.py:194:80: E501 line too long (80 > 79 characters)
    forecast_data = forecast[["ds", "yhat", "yhat_lower", "yhat_upper"]].rename(
                                                                               ^
./services/forecast_service.py:203:80: E501 line too long (86 > 79 characters)
    print(f"DEBUG: Processed forecast data columns: {forecast_data.columns.tolist()}")
                                                                               ^
./services/forecast_service.py:210:80: E501 line too long (87 > 79 characters)
    print(f"DEBUG: Response created with {len(response['forecast'])} forecast records")
                                                                               ^
./services/forecast_service.py:229:80: E501 line too long (92 > 79 characters)
# Promotion analysis, stockout analysis, holiday impact analysis, and fetch_*_data functions
                                                                               ^
./services/forecast_service.py:242:1: D205 1 blank line required between summary line and description
    """
    Async fetch historical sales data from the database using asyncpg.
    Ensures all required columns are present in the DataFrame.
    """
^
./services/forecast_service.py:248:9: F811 redefinition of unused 'datetime' from line 2
        from datetime import datetime
        ^
./services/forecast_service.py:257:11: W291 trailing whitespace
    query = """
    SELECT 
        sd.dt as sale_date,
        sd.store_id,
        sd.product_id,
        sd.first_category_id AS category_id,
        sd.city_id,
        sd.sale_amount,
        sd.discount,
        sd.stock_hour6_22_cnt,
        sd.holiday_flag,
        sd.activity_flag as promo_flag,
        sd.precpt,
        sd.avg_temperature,
        sd.avg_humidity,
        sd.avg_wind_level,
        sd.created_at
    FROM sales_data sd
    WHERE 1=1
    """
          ^
./services/forecast_service.py:357:1: D200 One-line docstring should fit on one line with quotes
    """
    Async fetch weather data from the database using asyncpg.
    """
^
./services/forecast_service.py:362:9: F811 redefinition of unused 'datetime' from line 2
        from datetime import datetime
        ^
./services/forecast_service.py:371:11: W291 trailing whitespace
    query = """
    SELECT 
        city_id,
        date,
        temp_avg,
        humidity,
        precipitation,
        wind_speed,
        weather_condition
    FROM weather_data
    WHERE 1=1
    """
          ^
./services/forecast_service.py:415:1: D205 1 blank line required between summary line and description
    """
    Async fetch promotion data from the database using asyncpg.
    Ensures all required columns are present in the DataFrame, including store_id, product_id, start_date, end_date.
    """
^
./services/forecast_service.py:417:80: E501 line too long (116 > 79 characters)
    """
    Async fetch promotion data from the database using asyncpg.
    Ensures all required columns are present in the DataFrame, including store_id, product_id, start_date, end_date.
    """
       
                                                               
       ^
./services/forecast_service.py:421:9: F811 redefinition of unused 'datetime' from line 2
        from datetime import datetime
        ^
./services/forecast_service.py:430:11: W291 trailing whitespace
    query = """
    SELECT 
        pe.store_id,
        pe.product_id,
        ph.first_category_id,
        pe.start_date,
        pe.end_date,
        pe.promotion_type,
        pe.discount_percentage
    FROM promotion_events pe
    JOIN product_hierarchy ph ON pe.product_id = ph.product_id
    WHERE 1=1
    """
          ^
./services/forecast_service.py:504:1: D200 One-line docstring should fit on one line with quotes
    """
    Async fetch holiday data from the database using asyncpg.
    """
^
./services/forecast_service.py:509:9: F811 redefinition of unused 'datetime' from line 2
        from datetime import datetime
        ^
./services/forecast_service.py:518:11: W291 trailing whitespace
    query = """
    SELECT 
        date,
        holiday_name,
        holiday_type,
        significance
    FROM holiday_calendar
    WHERE 1=1
    """
          ^
./services/forecast_service.py:546:80: E501 line too long (143 > 79 characters)
# The analyze_* functions can be made async if they need to await DB or other async calls, otherwise they can remain sync if only using pandas.
                                                                               ^
./services/forecast_service.py:549:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def analyze_promotion_effectiveness(
^
./services/forecast_service.py:552:1: D205 1 blank line required between summary line and description
    """
    Analyze promotion effectiveness for specified parameters.
    Ensures required columns are present.
    """
^
./services/forecast_service.py:592:80: E501 line too long (88 > 79 characters)
                        df.at[idx, "discount_percentage"] = promo["discount_percentage"]
                                                                               ^
./services/forecast_service.py:630:80: E501 line too long (85 > 79 characters)
                analysis["uplift_mean"].mean() if "uplift_mean" in analysis else None
                                                                               ^
./services/forecast_service.py:633:80: E501 line too long (87 > 79 characters)
                analysis["uplift_mean"].median() if "uplift_mean" in analysis else None
                                                                               ^
./services/forecast_service.py:643:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def analyze_stockout(df: pd.DataFrame, request) -> Dict[str, Any]:
^
./services/forecast_service.py:644:1: D205 1 blank line required between summary line and description
    """
    Analyze the impact of stockouts and estimate demand during stockout periods.
    Ensures required columns are present.
    """
^
./services/forecast_service.py:645:80: E501 line too long (80 > 79 characters)
    """
    Analyze the impact of stockouts and estimate demand during stockout periods.
    Ensures required columns are present.
    """
       
                                                                       ^
./services/forecast_service.py:674:80: E501 line too long (84 > 79 characters)
            stockout_days["estimated_demand"] = pd.Series(stockout_days["dow"]).map(
                                                                               ^
./services/forecast_service.py:678:80: E501 line too long (80 > 79 characters)
                stockout_days["estimated_demand"] - stockout_days["sale_amount"]
                                                                               ^
./services/forecast_service.py:680:80: E501 line too long (83 > 79 characters)
            stockout_days["lost_sales"] = stockout_days["lost_sales"].clip(lower=0)
                                                                               ^
./services/forecast_service.py:683:80: E501 line too long (86 > 79 characters)
                columns=["sale_date", "estimated_demand", "lost_sales", "sale_amount"]
                                                                               ^
./services/forecast_service.py:689:80: E501 line too long (84 > 79 characters)
                stockout_days["lost_sales"].mean() if stockout_days_count > 0 else 0
                                                                               ^
./services/forecast_service.py:724:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def analyze_holiday_impact(
^
./services/forecast_service.py:727:1: D200 One-line docstring should fit on one line with quotes
    """
    Analyze the impact of holidays on sales.
    """
^
./services/forecast_service.py:771:80: E501 line too long (88 > 79 characters)
            (sales_lift / comparison_avg_sales) * 100 if comparison_avg_sales > 0 else 0
                                                                               ^
./services/forecast_service.py:783:80: E501 line too long (82 > 79 characters)
                    holiday["holiday_type"] if "holiday_type" in holiday else None
                                                                               ^
./services/model_loader.py:1:1: D100 Missing docstring in public module
import os
^
./services/model_loader.py:13:1: D200 One-line docstring should fit on one line with quotes
    """
    Get or initialize the forecast model. Loads from disk if not already loaded.
    """
^
./services/model_loader.py:14:80: E501 line too long (80 > 79 characters)
    """
    Get or initialize the forecast model. Loads from disk if not already loaded.
    """
       
                                                                       ^
./services/model_loader.py:30:1: D200 One-line docstring should fit on one line with quotes
    """
    Get or initialize the promotion uplift model. Loads from disk if not already loaded.
    """
^
./services/model_loader.py:31:80: E501 line too long (88 > 79 characters)
    """
    Get or initialize the promotion uplift model. Loads from disk if not already loaded.
    """
       
                                                                       ^
./services/promotion_logic.py:1:1: D100 Missing docstring in public module
from typing import List, Dict, Any, Optional
^
./services/promotion_logic.py:2:1: F401 'datetime.timedelta' imported but unused
from datetime import datetime, timedelta
^
./services/promotion_logic.py:18:1: D205 1 blank line required between summary line and description
    """
    Simulate different discount levels and recommend promotions based on uplift model.
    Returns recommendations and summary statistics.
    """
^
./services/promotion_logic.py:19:80: E501 line too long (86 > 79 characters)
    """
    Simulate different discount levels and recommend promotions based on uplift model.
    Returns recommendations and summary statistics.
    """
       
                                                                       ^
./services/promotion_logic.py:66:80: E501 line too long (82 > 79 characters)
                    rec[col] = int(combo[col]) if pd.notnull(combo[col]) else None
                                                                               ^
./services/promotion_logic.py:70:80: E501 line too long (83 > 79 characters)
                    f"Error predicting uplift for {combo}: {str(e)}", exc_info=True
                                                                               ^
./services/promotion_logic.py:106:80: E501 line too long (85 > 79 characters)
            "target_date": target_date.strftime("%Y-%m-%d") if target_date else None,
                                                                               ^
./services/shap_explainer.py:1:1: D100 Missing docstring in public module
./setup.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Setup script for FreshRetail Forecasting.
"""
^
./setup.py:5:1: F401 'os' imported but unused
import os
^
./setup.py:19:80: E501 line too long (98 > 79 characters)
    description="Forecasting solution using FreshRetailNet-50K dataset with Supabase integration",
                                                                               ^
./tests/test_forecast.py:1:1: D100 Missing docstring in public module
./utils/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting utilities package.
"""
^
./utils/db_connector.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Database connector utility for Supabase.
"""
^
./utils/db_connector.py:14:1: D205 1 blank line required between summary line and description
    """
    Connector class for Supabase operations.
    Uses environment variables for configuration.
    """
^
./utils/db_connector.py:20:1: D200 One-line docstring should fit on one line with quotes
        """
        Initialize the Supabase connector with credentials from environment variables.
        """
^
./utils/db_connector.py:21:80: E501 line too long (86 > 79 characters)
        """
        Initialize the Supabase connector with credentials from environment variables.
        """
           
                                                                   ^
./utils/db_connector.py:32:80: E501 line too long (102 > 79 characters)
                "Missing Supabase credentials. Please set SUPABASE_URL and SUPABASE_KEY in .env file."
                                                                               ^
./utils/db_connector.py:39:1: D205 1 blank line required between summary line and description
        """
        Execute a SQL statement directly using the Supabase REST API with service role.
        This is specifically for DDL statements that can't be executed through RPC.

        Args:
            query: SQL query to execute (CREATE TABLE, etc.)

        Returns:
            Boolean indicating success
        """
^
./utils/db_connector.py:40:80: E501 line too long (87 > 79 characters)
        """
        Execute a SQL statement directly using the Supabase REST API with service role.
        This is specifically for DDL statements that can't be executed through RPC.

        Args:
            query: SQL query to execute (CREATE TABLE, etc.)

        Returns:
            Boolean indicating success
        """
           
                                                                   ^
./utils/db_connector.py:41:80: E501 line too long (83 > 79 characters)
        """
        Execute a SQL statement directly using the Supabase REST API with service role.
        This is specifically for DDL statements that can't be executed through RPC.

        Args:
            query: SQL query to execute (CREATE TABLE, etc.)

        Returns:
            Boolean indicating success
        """
           
                                                                   ^
./utils/db_connector.py:51:80: E501 line too long (109 > 79 characters)
                "Warning: SUPABASE_SERVICE_KEY not set, using regular key which may have limited permissions"
                                                                               ^
./utils/db_connector.py:80:80: E501 line too long (86 > 79 characters)
                print(f"SQL execution error: {response.status_code}, {response.text}")
                                                                               ^
./utils/db_connector.py:109:80: E501 line too long (83 > 79 characters)
            response = self.client.rpc("exec_sql", {"query_text": query}).execute()
                                                                               ^
./utils/db_connector.py:165:80: E501 line too long (87 > 79 characters)
                response.data[0] if hasattr(response, "data") and response.data else {}
                                                                               ^
./utils/db_connector.py:199:80: E501 line too long (82 > 79 characters)
    def delete(self, table: str, filters: Dict[str, Any]) -> List[Dict[str, Any]]:
                                                                               ^
./utils/logger.py:1:1: D100 Missing docstring in public module
./utils/mapping_data.py:2:80: E501 line too long (88 > 79 characters)
"""
This module provides mapping dictionaries to translate encoded IDs to real-world values.

These are used to make the data more interpretable in the UI and reports.
"""
   
                                                                           ^
./utils/mapping_data.py:35:80: E501 line too long (80 > 79 characters)
    4: {"name": "Central Mart", "format": "Hypermarket", "size": "Extra Large"},
                                                                               ^
./utils/mapping_data.py:42:80: E501 line too long (82 > 79 characters)
    11: {"name": "Harbor View Market", "format": "Supermarket", "size": "Medium"},
                                                                               ^
./utils/mapping_data.py:44:80: E501 line too long (80 > 79 characters)
    13: {"name": "Parkside Grocery", "format": "Supermarket", "size": "Medium"},
                                                                               ^
./utils/mapping_data.py:45:80: E501 line too long (87 > 79 characters)
    14: {"name": "Industrial District Market", "format": "Warehouse", "size": "Large"},
                                                                               ^
./utils/mapping_data.py:48:80: E501 line too long (86 > 79 characters)
    17: {"name": "Business District Mart", "format": "Supermarket", "size": "Medium"},
                                                                               ^
./utils/mapping_data.py:50:80: E501 line too long (80 > 79 characters)
    19: {"name": "Beach Road Foods", "format": "Supermarket", "size": "Medium"},
                                                                               ^
./utils/mapping_data.py:83:1: D400 First line should end with a period
    """Convert discount rate (where 1.0 is no discount) to percentage off"""
^
./utils/validators.py:1:1: D100 Missing docstring in public module
8     ASYNC102 await inside try/finally on line 94 must have shielded cancel scope with a timeout.
10    ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
2     B007 Loop control variable 'feature' not used within the loop body. If this is intended, start the name with an underscore.
26    B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
17    D100 Missing docstring in public module
4     D101 Missing docstring in public class
1     D102 Missing docstring in public method
10    D103 Missing docstring in public function
1     D104 Missing docstring in public package
2     D107 Missing docstring in __init__
40    D200 One-line docstring should fit on one line with quotes
20    D205 1 blank line required between summary line and description
58    D400 First line should end with a period
13    D401 First line should be in imperative mood
3     E203 whitespace before ':'
13    E402 module level import not at top of file
378   E501 line too long (85 > 79 characters)
1     E712 comparison to True should be 'if cond is True:' or 'if cond:'
54    F401 'datetime.datetime' imported but unused
5     F541 f-string is missing placeholders
4     F811 redefinition of unused 'datetime' from line 2
4     F841 local variable 'metrics' is assigned to but never used
44    W291 trailing whitespace
Searching for test report files in directories named [test-results, failsafe-reports, test-reports, TestResults, surefire-reports] down to a depth of 4
Finished scanning for test reports. Found 0 test report files.
Merged test suites, total number tests is 0, with 0 failures and 0 errors.
