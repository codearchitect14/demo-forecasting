+ umask 000

+ export GIT_LFS_SKIP_SMUDGE=1

+ retry 6 git clone --branch="feature/initial-forecasting" --depth 50 https://x-token-auth:$REPOSITORY_OAUTH_ACCESS_TOKEN@bitbucket.org/$BITBUCKET_REPO_FULL_NAME.git $BUILD_DIR
Cloning into '/opt/atlassian/pipelines/agent/build'...
Updating files:   0% (28/52478)
Updating files:   0% (29/52478)
Updating files:   0% (31/52478)
Updating files:   1% (525/52478)
Updating files:   1% (603/52478)
Updating files:   2% (1050/52478)
Updating files:   3% (1575/52478)
Updating files:   4% (2100/52478)
Updating files:   5% (2624/52478)
Updating files:   6% (3149/52478)
Updating files:   7% (3674/52478)
Updating files:   8% (4199/52478)
Updating files:   9% (4724/52478)
Updating files:   9% (4736/52478)
Updating files:  10% (5248/52478)
Updating files:  11% (5773/52478)
Updating files:  12% (6298/52478)
Updating files:  13% (6823/52478)
Updating files:  14% (7347/52478)
Updating files:  15% (7872/52478)
Updating files:  16% (8397/52478)
Updating files:  16% (8751/52478)
Updating files:  17% (8922/52478)
Updating files:  18% (9447/52478)
Updating files:  19% (9971/52478)
Updating files:  20% (10496/52478)
Updating files:  20% (10994/52478)
Updating files:  21% (11021/52478)
Updating files:  22% (11546/52478)
Updating files:  22% (11895/52478)
Updating files:  23% (12070/52478)
Updating files:  24% (12595/52478)
Updating files:  25% (13120/52478)
Updating files:  26% (13645/52478)
Updating files:  27% (14170/52478)
Updating files:  28% (14694/52478)
Updating files:  29% (15219/52478)
Updating files:  30% (15744/52478)
Updating files:  30% (15988/52478)
Updating files:  31% (16269/52478)
Updating files:  32% (16793/52478)
Updating files:  33% (17318/52478)
Updating files:  34% (17843/52478)
Updating files:  35% (18368/52478)
Updating files:  36% (18893/52478)
Updating files:  37% (19417/52478)
Updating files:  38% (19942/52478)
Updating files:  39% (20467/52478)
Updating files:  40% (20992/52478)
Updating files:  41% (21516/52478)
Updating files:  42% (22041/52478)
Updating files:  43% (22566/52478)
Updating files:  44% (23091/52478)
Updating files:  45% (23616/52478)
Updating files:  46% (24140/52478)
Updating files:  47% (24665/52478)
Updating files:  48% (25190/52478)
Updating files:  49% (25715/52478)
Updating files:  50% (26239/52478)
Updating files:  51% (26764/52478)
Updating files:  52% (27289/52478)
Updating files:  53% (27814/52478)
Updating files:  54% (28339/52478)
Updating files:  54% (28353/52478)
Updating files:  55% (28863/52478)
Updating files:  55% (29095/52478)
Updating files:  56% (29388/52478)
Updating files:  57% (29913/52478)
Updating files:  58% (30438/52478)
Updating files:  59% (30963/52478)
Updating files:  59% (31223/52478)
Updating files:  60% (31487/52478)
Updating files:  61% (32012/52478)
Updating files:  62% (32537/52478)
Updating files:  63% (33062/52478)
Updating files:  64% (33586/52478)
Updating files:  65% (34111/52478)
Updating files:  65% (34271/52478)
Updating files:  66% (34636/52478)
Updating files:  67% (35161/52478)
Updating files:  68% (35686/52478)
Updating files:  69% (36210/52478)
Updating files:  70% (36735/52478)
Updating files:  71% (37260/52478)
Updating files:  72% (37785/52478)
Updating files:  73% (38309/52478)
Updating files:  73% (38558/52478)
Updating files:  74% (38834/52478)
Updating files:  75% (39359/52478)
Updating files:  76% (39884/52478)
Updating files:  77% (40409/52478)
Updating files:  78% (40933/52478)
Updating files:  79% (41458/52478)
Updating files:  80% (41983/52478)
Updating files:  81% (42508/52478)
Updating files:  82% (43032/52478)
Updating files:  83% (43557/52478)
Updating files:  84% (44082/52478)
Updating files:  85% (44607/52478)
Updating files:  86% (45132/52478)
Updating files:  87% (45656/52478)
Updating files:  88% (46181/52478)
Updating files:  88% (46235/52478)
Updating files:  89% (46706/52478)
Updating files:  90% (47231/52478)
Updating files:  91% (47755/52478)
Updating files:  92% (48280/52478)
Updating files:  93% (48805/52478)
Updating files:  94% (49330/52478)
Updating files:  95% (49855/52478)
Updating files:  95% (49986/52478)
Updating files:  96% (50379/52478)
Updating files:  97% (50904/52478)
Updating files:  98% (51429/52478)
Updating files:  99% (51954/52478)
Updating files: 100% (52478/52478)
Updating files: 100% (52478/52478), done.

+ git reset --hard 28888dc35341dab6b99dc3bd8ce7f4a3a9a05cc8
HEAD is now at 28888dc3 Fix mypy errors

+ git config user.name bitbucket-pipelines

+ git config user.email commits-noreply@bitbucket.org

+ git config push.default current

+ git config http.${BITBUCKET_GIT_HTTP_ORIGIN}.proxy http://localhost:29418/

+ git remote set-url origin http://bitbucket.org/$BITBUCKET_REPO_FULL_NAME

+ git reflog expire --expire=all --all

+ echo ".bitbucket/pipelines/generated" >> .git/info/exclude

+ chmod 777 $BUILD_DIR


Default variables:
    BITBUCKET_BRANCH
    BITBUCKET_BUILD_NUMBER
    BITBUCKET_CLONE_DIR
    BITBUCKET_COMMIT
    BITBUCKET_GIT_HTTP_ORIGIN
    BITBUCKET_GIT_SSH_ORIGIN
    BITBUCKET_PARALLEL_STEP
    BITBUCKET_PARALLEL_STEP_COUNT
    BITBUCKET_PIPELINES_VARIABLES_PATH
    BITBUCKET_PIPELINE_UUID
    BITBUCKET_PROJECT_KEY
    BITBUCKET_PROJECT_UUID
    BITBUCKET_REPO_FULL_NAME
    BITBUCKET_REPO_IS_PRIVATE
    BITBUCKET_REPO_OWNER
    BITBUCKET_REPO_OWNER_UUID
    BITBUCKET_REPO_SLUG
    BITBUCKET_REPO_UUID
    BITBUCKET_SSH_KEY_FILE
    BITBUCKET_STEP_RUN_NUMBER
    BITBUCKET_STEP_TRIGGERER_UUID
    BITBUCKET_STEP_UUID
    BITBUCKET_WORKSPACE
    CI
    DOCKER_HOST
    PIPELINES_JWT_TOKEN

Images used:
    build : docker.io/library/python@sha256:875c3591e586f66aa65621926230925144920c951902a6c2eef005d9783a7ca7

Runtime:
    cloud:
        version: 2
        arch: x86
+ pip install -r requirements.txt
Collecting fastapi==0.103.1
  Downloading fastapi-0.103.1-py3-none-any.whl (66 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 66.2/66.2 kB 2.0 MB/s eta 0:00:00
Collecting uvicorn==0.23.2
  Downloading uvicorn-0.23.2-py3-none-any.whl (59 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 59.5/59.5 kB 7.0 MB/s eta 0:00:00
Collecting python-dotenv==1.0.1
  Downloading python_dotenv-1.0.1-py3-none-any.whl (19 kB)
Collecting pydantic==2.3.0
  Downloading pydantic-2.3.0-py3-none-any.whl (374 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 374.5/374.5 kB 30.6 MB/s eta 0:00:00
Collecting pandas==2.1.4
  Downloading pandas-2.1.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.3/12.3 MB 98.9 MB/s eta 0:00:00
Collecting numpy==1.24.3
  Downloading numpy-1.24.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 17.3/17.3 MB 73.4 MB/s eta 0:00:00
Collecting sqlalchemy==1.4.49
  Downloading SQLAlchemy-1.4.49-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 116.1 MB/s eta 0:00:00
Collecting psycopg2-binary==2.9.9
  Downloading psycopg2_binary-2.9.9-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.0/3.0 MB 108.0 MB/s eta 0:00:00
Collecting python-multipart==0.0.6
  Downloading python_multipart-0.0.6-py3-none-any.whl (45 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 45.7/45.7 kB 12.0 MB/s eta 0:00:00
Collecting black==24.4.2
  Downloading black-24.4.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 129.1 MB/s eta 0:00:00
Collecting types-setuptools
  Downloading types_setuptools-80.9.0.20250529-py3-none-any.whl (63 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.3/63.3 kB 15.4 MB/s eta 0:00:00
Collecting matplotlib==3.7.2
  Downloading matplotlib-3.7.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 11.6/11.6 MB 100.7 MB/s eta 0:00:00
Collecting seaborn==0.12.2
  Downloading seaborn-0.12.2-py3-none-any.whl (293 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 293.3/293.3 kB 62.2 MB/s eta 0:00:00
Collecting plotly==5.18.0
  Downloading plotly-5.18.0-py3-none-any.whl (15.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 15.6/15.6 MB 112.0 MB/s eta 0:00:00
Collecting prophet==1.1.4
  Downloading prophet-1.1.4-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.0/13.0 MB 73.6 MB/s eta 0:00:00
Collecting scikit-learn==1.3.0
  Downloading scikit_learn-1.3.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (10.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.8/10.8 MB 102.4 MB/s eta 0:00:00
Collecting joblib==1.3.2
  Downloading joblib-1.3.2-py3-none-any.whl (302 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 302.2/302.2 kB 44.5 MB/s eta 0:00:00
Collecting shap==0.42.1
  Downloading shap-0.42.1-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (547 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 547.9/547.9 kB 66.0 MB/s eta 0:00:00
Collecting supabase==1.0.3
  Downloading supabase-1.0.3-py3-none-any.whl (11 kB)
Collecting httpx==0.23.3
  Downloading httpx-0.23.3-py3-none-any.whl (71 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 71.5/71.5 kB 8.5 MB/s eta 0:00:00
Collecting asyncpg==0.29.0
  Downloading asyncpg-0.29.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.7/2.7 MB 126.9 MB/s eta 0:00:00
Collecting cachetools==5.3.3
  Downloading cachetools-5.3.3-py3-none-any.whl (9.3 kB)
Collecting pytest==7.4.0
  Downloading pytest-7.4.0-py3-none-any.whl (323 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 323.6/323.6 kB 60.1 MB/s eta 0:00:00
Collecting coverage==7.3.2
  Downloading coverage-7.3.2-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (227 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 227.5/227.5 kB 36.3 MB/s eta 0:00:00
Collecting tqdm==4.66.1
  Downloading tqdm-4.66.1-py3-none-any.whl (78 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 78.3/78.3 kB 13.4 MB/s eta 0:00:00
Collecting starlette<0.28.0,>=0.27.0
  Downloading starlette-0.27.0-py3-none-any.whl (66 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 67.0/67.0 kB 14.5 MB/s eta 0:00:00
Collecting anyio<4.0.0,>=3.7.1
  Downloading anyio-3.7.1-py3-none-any.whl (80 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 80.9/80.9 kB 22.9 MB/s eta 0:00:00
Collecting typing-extensions>=4.5.0
  Downloading typing_extensions-4.14.1-py3-none-any.whl (43 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 43.9/43.9 kB 6.4 MB/s eta 0:00:00
Collecting h11>=0.8
  Downloading h11-0.16.0-py3-none-any.whl (37 kB)
Collecting click>=7.0
  Downloading click-8.2.1-py3-none-any.whl (102 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 102.2/102.2 kB 21.0 MB/s eta 0:00:00
Collecting annotated-types>=0.4.0
  Downloading annotated_types-0.7.0-py3-none-any.whl (13 kB)
Collecting pydantic-core==2.6.3
  Downloading pydantic_core-2.6.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.9/1.9 MB 66.9 MB/s eta 0:00:00
Collecting tzdata>=2022.1
  Downloading tzdata-2025.2-py2.py3-none-any.whl (347 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 347.8/347.8 kB 27.3 MB/s eta 0:00:00
Collecting pytz>=2020.1
  Downloading pytz-2025.2-py2.py3-none-any.whl (509 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 509.2/509.2 kB 77.7 MB/s eta 0:00:00
Collecting python-dateutil>=2.8.2
  Downloading python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 229.9/229.9 kB 21.8 MB/s eta 0:00:00
Collecting greenlet!=0.4.17
  Downloading greenlet-3.2.3-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (582 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 582.2/582.2 kB 36.3 MB/s eta 0:00:00
Collecting packaging>=22.0
  Downloading packaging-25.0-py3-none-any.whl (66 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 66.5/66.5 kB 21.4 MB/s eta 0:00:00
Collecting platformdirs>=2
  Downloading platformdirs-4.3.8-py3-none-any.whl (18 kB)
Collecting tomli>=1.1.0
  Downloading tomli-2.2.1-py3-none-any.whl (14 kB)
Collecting pathspec>=0.9.0
  Downloading pathspec-0.12.1-py3-none-any.whl (31 kB)
Collecting mypy-extensions>=0.4.3
  Downloading mypy_extensions-1.1.0-py3-none-any.whl (5.0 kB)
Collecting pyparsing<3.1,>=2.3.1
  Downloading pyparsing-3.0.9-py3-none-any.whl (98 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 98.3/98.3 kB 22.3 MB/s eta 0:00:00
Collecting pillow>=6.2.0
  Downloading pillow-11.3.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (6.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.6/6.6 MB 93.5 MB/s eta 0:00:00
Collecting cycler>=0.10
  Downloading cycler-0.12.1-py3-none-any.whl (8.3 kB)
Collecting fonttools>=4.22.0
  Downloading fonttools-4.58.5-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (4.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.8/4.8 MB 96.1 MB/s eta 0:00:00
Collecting contourpy>=1.0.1
  Downloading contourpy-1.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (325 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 325.0/325.0 kB 48.2 MB/s eta 0:00:00
Collecting kiwisolver>=1.0.1
  Downloading kiwisolver-1.4.8-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 92.6 MB/s eta 0:00:00
Collecting tenacity>=6.2.0
  Downloading tenacity-9.1.2-py3-none-any.whl (28 kB)
Collecting holidays>=0.25
  Downloading holidays-0.76-py3-none-any.whl (1.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.1/1.1 MB 68.8 MB/s eta 0:00:00
Collecting convertdate>=2.1.2
  Downloading convertdate-2.4.0-py3-none-any.whl (47 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 47.9/47.9 kB 12.0 MB/s eta 0:00:00
Collecting importlib-resources
  Downloading importlib_resources-6.5.2-py3-none-any.whl (37 kB)
Collecting LunarCalendar>=0.0.9
  Downloading LunarCalendar-0.0.9-py2.py3-none-any.whl (18 kB)
Collecting cmdstanpy>=1.0.4
  Downloading cmdstanpy-1.2.5-py3-none-any.whl (94 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 94.5/94.5 kB 18.1 MB/s eta 0:00:00
Collecting scipy>=1.5.0
  Downloading scipy-1.15.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (37.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 37.7/37.7 MB 23.3 MB/s eta 0:00:00
Collecting threadpoolctl>=2.0.0
  Downloading threadpoolctl-3.6.0-py3-none-any.whl (18 kB)
Collecting slicer==0.0.7
  Downloading slicer-0.0.7-py3-none-any.whl (14 kB)
Collecting numba
  Downloading numba-0.61.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (3.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.8/3.8 MB 92.3 MB/s eta 0:00:00
Collecting cloudpickle
  Downloading cloudpickle-3.1.1-py3-none-any.whl (20 kB)
Collecting storage3<0.6.0,>=0.5.2
  Downloading storage3-0.5.4-py3-none-any.whl (14 kB)
Collecting postgrest<0.11.0,>=0.10.6
  Downloading postgrest-0.10.8-py3-none-any.whl (18 kB)
Collecting gotrue<2.0.0,>=1.0.1
  Downloading gotrue-1.3.1-py3-none-any.whl (42 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 42.3/42.3 kB 9.7 MB/s eta 0:00:00
Collecting python-semantic-release==7.33.2
  Downloading python_semantic_release-7.33.2-py3-none-any.whl (55 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 55.1/55.1 kB 11.4 MB/s eta 0:00:00
Collecting supafunc<0.3.0,>=0.2.2
  Downloading supafunc-0.2.4-py3-none-any.whl (6.1 kB)
Collecting realtime<2.0.0,>=1.0.0
  Downloading realtime-1.0.6-py3-none-any.whl (9.0 kB)
Collecting sniffio
  Downloading sniffio-1.3.1-py3-none-any.whl (10 kB)
Collecting httpcore<0.17.0,>=0.15.0
  Downloading httpcore-0.16.3-py3-none-any.whl (69 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 69.6/69.6 kB 11.8 MB/s eta 0:00:00
Collecting certifi
  Downloading certifi-2025.7.9-py3-none-any.whl (159 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 159.2/159.2 kB 30.6 MB/s eta 0:00:00
Collecting rfc3986[idna2008]<2,>=1.3
  Downloading rfc3986-1.5.0-py2.py3-none-any.whl (31 kB)
Collecting async-timeout>=4.0.3
  Downloading async_timeout-5.0.1-py3-none-any.whl (6.2 kB)
Collecting iniconfig
  Downloading iniconfig-2.1.0-py3-none-any.whl (6.0 kB)
Collecting exceptiongroup>=1.0.0rc8
  Downloading exceptiongroup-1.3.0-py3-none-any.whl (16 kB)
Collecting pluggy<2.0,>=0.12
  Downloading pluggy-1.6.0-py3-none-any.whl (20 kB)
Requirement already satisfied: wheel in /usr/local/lib/python3.10/site-packages (from python-semantic-release==7.33.2->supabase==1.0.3->-r requirements.txt (line 26)) (0.45.1)
Collecting python-gitlab<4,>=2
  Downloading python_gitlab-3.15.0-py3-none-any.whl (135 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 135.9/135.9 kB 21.7 MB/s eta 0:00:00
Collecting click-log<1,>=0.3
  Downloading click_log-0.4.0-py2.py3-none-any.whl (4.3 kB)
Collecting dotty-dict<2,>=1.3.0
  Downloading dotty_dict-1.3.1-py3-none-any.whl (7.0 kB)
Collecting tomlkit~=0.10
  Downloading tomlkit-0.13.3-py3-none-any.whl (38 kB)
Collecting invoke<2,>=1.4.1
  Downloading invoke-1.7.3-py3-none-any.whl (216 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 216.4/216.4 kB 45.8 MB/s eta 0:00:00
Collecting twine<4,>=3
  Downloading twine-3.8.0-py3-none-any.whl (36 kB)
Collecting requests<3,>=2.25
  Downloading requests-2.32.4-py3-none-any.whl (64 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 64.8/64.8 kB 19.8 MB/s eta 0:00:00
Collecting gitpython<4,>=3.0.8
  Downloading GitPython-3.1.44-py3-none-any.whl (207 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 207.6/207.6 kB 31.5 MB/s eta 0:00:00
Collecting semver<3,>=2.10
  Downloading semver-2.13.0-py2.py3-none-any.whl (12 kB)
Collecting idna>=2.8
  Downloading idna-3.10-py3-none-any.whl (70 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 70.4/70.4 kB 18.6 MB/s eta 0:00:00
Collecting stanio<2.0.0,>=0.4.0
  Downloading stanio-0.5.1-py3-none-any.whl (8.1 kB)
Collecting pymeeus<=1,>=0.3.13
  Downloading PyMeeus-0.5.12.tar.gz (5.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.8/5.8 MB 91.0 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting h11>=0.8
  Downloading h11-0.14.0-py3-none-any.whl (58 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 58.3/58.3 kB 7.7 MB/s eta 0:00:00
Collecting ephem>=3.7.5.3
  Downloading ephem-4.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 135.0 MB/s eta 0:00:00
Collecting strenum<0.5.0,>=0.4.9
  Downloading StrEnum-0.4.15-py3-none-any.whl (8.9 kB)
Collecting postgrest<0.11.0,>=0.10.6
  Downloading postgrest-0.10.7-py3-none-any.whl (18 kB)
Collecting deprecation<3.0.0,>=2.1.0
  Downloading deprecation-2.1.0-py2.py3-none-any.whl (11 kB)
Collecting six>=1.5
  Downloading six-1.17.0-py2.py3-none-any.whl (11 kB)
Collecting websockets<13,>=11
  Downloading websockets-12.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (130 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 130.2/130.2 kB 27.6 MB/s eta 0:00:00
Collecting storage3<0.6.0,>=0.5.2
  Downloading storage3-0.5.3-py3-none-any.whl (14 kB)
Collecting supafunc<0.3.0,>=0.2.2
  Downloading supafunc-0.2.3-py3-none-any.whl (2.8 kB)
  Downloading supafunc-0.2.2-py3-none-any.whl (2.8 kB)
Collecting llvmlite<0.45,>=0.44.0dev0
  Downloading llvmlite-0.44.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (42.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 42.4/42.4 MB 20.7 MB/s eta 0:00:00
Collecting gitdb<5,>=4.0.1
  Downloading gitdb-4.0.12-py3-none-any.whl (62 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.8/62.8 kB 21.5 MB/s eta 0:00:00
Collecting requests-toolbelt>=0.10.1
  Downloading requests_toolbelt-1.0.0-py2.py3-none-any.whl (54 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 54.5/54.5 kB 17.5 MB/s eta 0:00:00
Collecting urllib3<3,>=1.21.1
  Downloading urllib3-2.5.0-py3-none-any.whl (129 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 129.8/129.8 kB 38.9 MB/s eta 0:00:00
Collecting charset_normalizer<4,>=2
  Downloading charset_normalizer-3.4.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 149.5/149.5 kB 45.3 MB/s eta 0:00:00
Collecting readme-renderer>=21.0
  Downloading readme_renderer-44.0-py3-none-any.whl (13 kB)
Collecting importlib-metadata>=3.6
  Downloading importlib_metadata-8.7.0-py3-none-any.whl (27 kB)
Collecting colorama>=0.4.3
  Downloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)
Collecting pkginfo>=1.8.1
  Downloading pkginfo-1.12.1.2-py3-none-any.whl (32 kB)
Collecting keyring>=15.1
  Downloading keyring-25.6.0-py3-none-any.whl (39 kB)
Collecting smmap<6,>=3.0.1
  Downloading smmap-5.0.2-py3-none-any.whl (24 kB)
Collecting zipp>=3.20
  Downloading zipp-3.23.0-py3-none-any.whl (10 kB)
Collecting jeepney>=0.4.2
  Downloading jeepney-0.9.0-py3-none-any.whl (49 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 49.0/49.0 kB 12.5 MB/s eta 0:00:00
Collecting jaraco.classes
  Downloading jaraco.classes-3.4.0-py3-none-any.whl (6.8 kB)
Collecting jaraco.context
  Downloading jaraco.context-6.0.1-py3-none-any.whl (6.8 kB)
Collecting jaraco.functools
  Downloading jaraco_functools-4.2.1-py3-none-any.whl (10 kB)
Collecting SecretStorage>=3.2
  Downloading SecretStorage-3.3.3-py3-none-any.whl (15 kB)
Collecting docutils>=0.21.2
  Downloading docutils-0.21.2-py3-none-any.whl (587 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 587.4/587.4 kB 62.7 MB/s eta 0:00:00
Collecting Pygments>=2.5.1
  Downloading pygments-2.19.2-py3-none-any.whl (1.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 100.0 MB/s eta 0:00:00
Collecting nh3>=0.2.14
  Downloading nh3-0.2.21-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (739 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 739.0/739.0 kB 52.1 MB/s eta 0:00:00
Collecting cryptography>=2.0
  Downloading cryptography-45.0.5-cp37-abi3-manylinux_2_34_x86_64.whl (4.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.4/4.4 MB 130.3 MB/s eta 0:00:00
Collecting more-itertools
  Downloading more_itertools-10.7.0-py3-none-any.whl (65 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 65.3/65.3 kB 11.3 MB/s eta 0:00:00
Collecting backports.tarfile
  Downloading backports.tarfile-1.2.0-py3-none-any.whl (30 kB)
Collecting cffi>=1.14
  Downloading cffi-1.17.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (446 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 446.2/446.2 kB 80.5 MB/s eta 0:00:00
Collecting pycparser
  Downloading pycparser-2.22-py3-none-any.whl (117 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 117.6/117.6 kB 36.8 MB/s eta 0:00:00
Building wheels for collected packages: pymeeus
  Building wheel for pymeeus (setup.py): started
  Building wheel for pymeeus (setup.py): finished with status 'done'
  Created wheel for pymeeus: filename=PyMeeus-0.5.12-py3-none-any.whl size=732000 sha256=cfec67fd703111e54013898cafaefdfb8f9bc8ae4016d7925ee3f15bb051d463
  Stored in directory: /root/.cache/pip/wheels/d6/67/78/aa2e8d108639dd23a5e9e72a4fc88bb44f5541894382712f48
Successfully built pymeeus
Installing collected packages: strenum, rfc3986, pytz, pymeeus, invoke, ephem, zipp, websockets, urllib3, tzdata, typing-extensions, types-setuptools, tqdm, tomlkit, tomli, threadpoolctl, tenacity, sniffio, smmap, slicer, six, semver, python-multipart, python-dotenv, pyparsing, Pygments, pycparser, psycopg2-binary, pluggy, platformdirs, pkginfo, pillow, pathspec, packaging, numpy, nh3, mypy-extensions, more-itertools, llvmlite, kiwisolver, joblib, jeepney, iniconfig, importlib-resources, idna, h11, greenlet, fonttools, dotty-dict, docutils, cycler, coverage, convertdate, colorama, cloudpickle, click, charset_normalizer, certifi, cachetools, backports.tarfile, async-timeout, annotated-types, uvicorn, stanio, sqlalchemy, scipy, requests, readme-renderer, python-dateutil, pydantic-core, plotly, numba, jaraco.functools, jaraco.context, jaraco.classes, importlib-metadata, gitdb, exceptiongroup, deprecation, contourpy, click-log, cffi, black, asyncpg, scikit-learn, requests-toolbelt, realtime, pytest, pydantic, pandas, matplotlib, LunarCalendar, holidays, gitpython, cryptography, anyio, starlette, shap, SecretStorage, seaborn, python-gitlab, httpcore, cmdstanpy, prophet, keyring, httpx, fastapi, twine, supafunc, storage3, postgrest, gotrue, python-semantic-release, supabase
Successfully installed LunarCalendar-0.0.9 Pygments-2.19.2 SecretStorage-3.3.3 annotated-types-0.7.0 anyio-3.7.1 async-timeout-5.0.1 asyncpg-0.29.0 backports.tarfile-1.2.0 black-24.4.2 cachetools-5.3.3 certifi-2025.7.9 cffi-1.17.1 charset_normalizer-3.4.2 click-8.2.1 click-log-0.4.0 cloudpickle-3.1.1 cmdstanpy-1.2.5 colorama-0.4.6 contourpy-1.3.2 convertdate-2.4.0 coverage-7.3.2 cryptography-45.0.5 cycler-0.12.1 deprecation-2.1.0 docutils-0.21.2 dotty-dict-1.3.1 ephem-4.2 exceptiongroup-1.3.0 fastapi-0.103.1 fonttools-4.58.5 gitdb-4.0.12 gitpython-3.1.44 gotrue-1.3.1 greenlet-3.2.3 h11-0.14.0 holidays-0.76 httpcore-0.16.3 httpx-0.23.3 idna-3.10 importlib-metadata-8.7.0 importlib-resources-6.5.2 iniconfig-2.1.0 invoke-1.7.3 jaraco.classes-3.4.0 jaraco.context-6.0.1 jaraco.functools-4.2.1 jeepney-0.9.0 joblib-1.3.2 keyring-25.6.0 kiwisolver-1.4.8 llvmlite-0.44.0 matplotlib-3.7.2 more-itertools-10.7.0 mypy-extensions-1.1.0 nh3-0.2.21 numba-0.61.2 numpy-1.24.3 packaging-25.0 pandas-2.1.4 pathspec-0.12.1 pillow-11.3.0 pkginfo-1.12.1.2 platformdirs-4.3.8 plotly-5.18.0 pluggy-1.6.0 postgrest-0.10.7 prophet-1.1.4 psycopg2-binary-2.9.9 pycparser-2.22 pydantic-2.3.0 pydantic-core-2.6.3 pymeeus-0.5.12 pyparsing-3.0.9 pytest-7.4.0 python-dateutil-2.9.0.post0 python-dotenv-1.0.1 python-gitlab-3.15.0 python-multipart-0.0.6 python-semantic-release-7.33.2 pytz-2025.2 readme-renderer-44.0 realtime-1.0.6 requests-2.32.4 requests-toolbelt-1.0.0 rfc3986-1.5.0 scikit-learn-1.3.0 scipy-1.15.3 seaborn-0.12.2 semver-2.13.0 shap-0.42.1 six-1.17.0 slicer-0.0.7 smmap-5.0.2 sniffio-1.3.1 sqlalchemy-1.4.49 stanio-0.5.1 starlette-0.27.0 storage3-0.5.3 strenum-0.4.15 supabase-1.0.3 supafunc-0.2.2 tenacity-9.1.2 threadpoolctl-3.6.0 tomli-2.2.1 tomlkit-0.13.3 tqdm-4.66.1 twine-3.8.0 types-setuptools-80.9.0.20250529 typing-extensions-4.14.1 tzdata-2025.2 urllib3-2.5.0 uvicorn-0.23.2 websockets-12.0 zipp-3.23.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv

[notice] A new release of pip is available: 23.0.1 -> 25.1.1
[notice] To update, run: pip install --upgrade pip

+ pip install flake8 flake8-async flake8-bugbear flake8-docstrings
Collecting flake8
  Downloading flake8-7.3.0-py2.py3-none-any.whl (57 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 57.9/57.9 kB 3.9 MB/s eta 0:00:00
Collecting flake8-async
  Downloading flake8_async-25.5.3-py3-none-any.whl (56 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.5/56.5 kB 12.4 MB/s eta 0:00:00
Collecting flake8-bugbear
  Downloading flake8_bugbear-24.12.12-py3-none-any.whl (36 kB)
Collecting flake8-docstrings
  Downloading flake8_docstrings-1.7.0-py2.py3-none-any.whl (5.0 kB)
Collecting mccabe<0.8.0,>=0.7.0
  Downloading mccabe-0.7.0-py2.py3-none-any.whl (7.3 kB)
Collecting pyflakes<3.5.0,>=3.4.0
  Downloading pyflakes-3.4.0-py2.py3-none-any.whl (63 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.6/63.6 kB 20.1 MB/s eta 0:00:00
Collecting pycodestyle<2.15.0,>=2.14.0
  Downloading pycodestyle-2.14.0-py2.py3-none-any.whl (31 kB)
Collecting libcst>=1.0.1
  Downloading libcst-1.8.2-cp310-cp310-manylinux_2_28_x86_64.whl (2.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.3/2.3 MB 61.5 MB/s eta 0:00:00
Collecting attrs>=22.2.0
  Downloading attrs-25.3.0-py3-none-any.whl (63 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.8/63.8 kB 17.2 MB/s eta 0:00:00
Collecting pydocstyle>=2.1
  Downloading pydocstyle-6.3.0-py3-none-any.whl (38 kB)
Collecting pyyaml>=5.2
  Downloading PyYAML-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (751 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 751.2/751.2 kB 85.8 MB/s eta 0:00:00
Collecting snowballstemmer>=2.2.0
  Downloading snowballstemmer-3.0.1-py3-none-any.whl (103 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 103.3/103.3 kB 24.4 MB/s eta 0:00:00
Installing collected packages: snowballstemmer, pyyaml, pyflakes, pycodestyle, mccabe, attrs, pydocstyle, libcst, flake8, flake8-docstrings, flake8-bugbear, flake8-async
Successfully installed attrs-25.3.0 flake8-7.3.0 flake8-async-25.5.3 flake8-bugbear-24.12.12 flake8-docstrings-1.7.0 libcst-1.8.2 mccabe-0.7.0 pycodestyle-2.14.0 pydocstyle-6.3.0 pyflakes-3.4.0 pyyaml-6.0.2 snowballstemmer-3.0.1
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv

[notice] A new release of pip is available: 23.0.1 -> 25.1.1
[notice] To update, run: pip install --upgrade pip

+ flake8 . --extend-exclude=dist,build,venv --show-source --statistics
./api/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting API initialization.
"""
^
./api/__init__.py:16:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
./api/__init__.py:23:80: E501 line too long (90 > 79 characters)
    description="API for sales forecasting, promotion impact, and inventory optimization",
                                                                               ^
./api/__init__.py:45:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def root():
^
./api/__init__.py:56:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def health():
^
./api/forecast.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FastAPI endpoints for sales forecasting and demand prediction.
"""
^
./api/forecast.py:5:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./api/forecast.py:6:1: F401 'typing.Union' imported but unused
from typing import Dict, List, Optional, Union, Any
^
./api/forecast.py:8:1: F401 'numpy as np' imported but unused
import numpy as np  # type: ignore
^
./api/forecast.py:9:1: F401 'fastapi.Query' imported but unused
from fastapi import FastAPI, Query, HTTPException, Depends
^
./api/forecast.py:10:1: F401 'pydantic.Field' imported but unused
from pydantic import BaseModel, Field
^
./api/forecast.py:17:1: E402 module level import not at top of file
from models.prophet_forecaster import ProphetForecaster
^
./api/forecast.py:18:1: E402 module level import not at top of file
from models.promo_uplift_model import PromoUpliftModel
^
./api/forecast.py:19:1: F401 'database.connection.get_supabase_client' imported but unused
from database.connection import get_db_engine, get_supabase_client  # type: ignore
^
./api/forecast.py:19:1: E402 module level import not at top of file
from database.connection import get_db_engine, get_supabase_client  # type: ignore
^
./api/forecast.py:19:80: E501 line too long (82 > 79 characters)
from database.connection import get_db_engine, get_supabase_client  # type: ignore
                                                                               ^
./api/forecast.py:23:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
./api/forecast.py:30:80: E501 line too long (90 > 79 characters)
    description="API for sales forecasting, promotion impact, and inventory optimization",
                                                                               ^
./api/forecast.py:152:11: W291 trailing whitespace
    query = """
    SELECT 
        sd.sale_date,
        sd.store_id,
        sd.product_id,
        ph.first_category_id,
        sh.city_id,
        sd.sale_amount,
        sd.sale_qty,
        sd.discount,
        sd.original_price,
        sd.stock_hour6_22_cnt,
        sd.holiday_flag,
        sd.promo_flag
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    WHERE 1=1
    """
          ^
./api/forecast.py:205:80: E501 line too long (80 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Database error: {str(e)}")
                                                                               ^
./api/forecast.py:215:80: E501 line too long (82 > 79 characters)
    """
    Fetch weather data from the database, including future forecasts if available.

    Args:
        city_id: City ID to filter by
        start_date: Start date
        end_date: End date
        future_periods: Number of future periods to include

    Returns:
        pd.DataFrame: Weather data
    """
       
                                                                       ^
./api/forecast.py:230:11: W291 trailing whitespace
    query = """
    SELECT 
        city_id,
        date,
        temp_avg,
        humidity,
        precipitation,
        wind_speed,
        weather_condition
    FROM weather_data
    WHERE 1=1
    """
          ^
./api/forecast.py:274:80: E501 line too long (88 > 79 characters)
                same_dow = df[pd.to_datetime(df["date"]).dt.dayofweek == date.dayofweek]
                                                                               ^
./api/forecast.py:294:80: E501 line too long (84 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Weather data error: {str(e)}")
                                                                               ^
./api/forecast.py:306:80: E501 line too long (80 > 79 characters)
    """
    Fetch promotion data from the database, including future planned promotions.

    Returns:
        pd.DataFrame: Promotion data
    """
       
                                                                       ^
./api/forecast.py:314:11: W291 trailing whitespace
    query = """
    SELECT 
        pe.store_id,
        pe.product_id,
        ph.first_category_id,
        pe.start_date,
        pe.end_date,
        pe.promotion_type,
        pe.discount_percentage
    FROM promotion_events pe
    JOIN product_hierarchy ph ON pe.product_id = ph.product_id
    WHERE 1=1
    """
          ^
./api/forecast.py:365:80: E501 line too long (86 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Promotion data error: {str(e)}")
                                                                               ^
./api/forecast.py:382:11: W291 trailing whitespace
    query = """
    SELECT 
        date,
        holiday_name,
        holiday_type,
        significance
    FROM holiday_calendar
    WHERE 1=1
    """
          ^
./api/forecast.py:409:80: E501 line too long (84 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Holiday data error: {str(e)}")
                                                                               ^
./api/forecast.py:420:58: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    request: ForecastRequest, model: ProphetForecaster = Depends(get_forecast_model)
                                                         ^
./api/forecast.py:420:80: E501 line too long (84 > 79 characters)
    request: ForecastRequest, model: ProphetForecaster = Depends(get_forecast_model)
                                                                               ^
./api/forecast.py:470:80: E501 line too long (84 > 79 characters)
                status_code=400, detail="Not enough historical data for forecasting"
                                                                               ^
./api/forecast.py:483:13: F841 local variable 'metrics' is assigned to but never used
            metrics = model.train(df)
            ^
./api/forecast.py:524:80: E501 line too long (86 > 79 characters)
                    promo_start = max(pd.to_datetime(promo["start_date"]), start_date)
                                                                               ^
./api/forecast.py:525:80: E501 line too long (80 > 79 characters)
                    promo_end = min(pd.to_datetime(promo["end_date"]), end_date)
                                                                               ^
./api/forecast.py:538:80: E501 line too long (84 > 79 characters)
                        promo_end = min(pd.to_datetime(promo["end_date"]), end_date)
                                                                               ^
./api/forecast.py:542:80: E501 line too long (88 > 79 characters)
                        promo_flags.loc[mask, "discount"] = promo["discount_percentage"]
                                                                               ^
./api/forecast.py:556:80: E501 line too long (80 > 79 characters)
                    start=start_date, periods=request.periods, freq=request.freq
                                                                               ^
./api/forecast.py:562:13: B007 Loop control variable 'feature' not used within the loop body. If this is intended, start the name with an underscore.
        for feature, feature_df in future_features.items():
            ^
./api/forecast.py:564:80: E501 line too long (80 > 79 characters)
                future_df = pd.merge(future_df, feature_df, on="ds", how="left")
                                                                               ^
./api/forecast.py:570:80: E501 line too long (84 > 79 characters)
        forecast_data = forecast[["ds", "yhat", "yhat_lower", "yhat_upper"]].rename(
                                                                               ^
./api/forecast.py:586:80: E501 line too long (86 > 79 characters)
                    if hasattr(model.metrics, "to_dict") and model.metrics is not None
                                                                               ^
./api/forecast.py:609:80: E501 line too long (80 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Forecast error: {str(e)}")
                                                                               ^
./api/forecast.py:615:31: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    model: PromoUpliftModel = Depends(get_promo_model),
                              ^
./api/forecast.py:652:80: E501 line too long (88 > 79 characters)
                status_code=400, detail="No data available for the specified parameters"
                                                                               ^
./api/forecast.py:666:80: E501 line too long (89 > 79 characters)
            # For each day in the sales data, check if it falls within a promotion period
                                                                               ^
./api/forecast.py:679:80: E501 line too long (83 > 79 characters)
                            if row["product_id"] == promo["product_id"] or pd.isna(
                                                                               ^
./api/forecast.py:695:80: E501 line too long (81 > 79 characters)
        if request.promotion_type is not None and "promotion_type" in df.columns:
                                                                               ^
./api/forecast.py:699:80: E501 line too long (84 > 79 characters)
        if request.discount_min is not None and "discount_percentage" in df.columns:
                                                                               ^
./api/forecast.py:702:80: E501 line too long (84 > 79 characters)
        if request.discount_max is not None and "discount_percentage" in df.columns:
                                                                               ^
./api/forecast.py:720:80: E501 line too long (82 > 79 characters)
                    df["promo_flag"].sum() if "promo_flag" in df.columns else None
                                                                               ^
./api/forecast.py:736:80: E501 line too long (80 > 79 characters)
    """
    Analyze the impact of stockouts and estimate demand during stockout periods.

    Parameters:
    - store_id: Store ID
    - product_id: Product ID
    - start_date: Start date for analysis
    - end_date: End date for analysis

    Returns:
    - Stockout analysis with estimated demand during stockout periods
    """
       
                                                                       ^
./api/forecast.py:757:80: E501 line too long (81 > 79 characters)
            - timedelta(days=30),  # Get some extra history for better estimation
                                                                               ^
./api/forecast.py:763:80: E501 line too long (88 > 79 characters)
                status_code=400, detail="No data available for the specified parameters"
                                                                               ^
./api/forecast.py:772:80: E501 line too long (87 > 79 characters)
            .groupby(pd.to_datetime(df[~df["is_stockout"]]["sale_date"]).dt.dayofweek)[
                                                                               ^
./api/forecast.py:789:80: E501 line too long (80 > 79 characters)
                stockout_days["estimated_demand"] - stockout_days["sale_amount"]
                                                                               ^
./api/forecast.py:791:80: E501 line too long (83 > 79 characters)
            stockout_days["lost_sales"] = stockout_days["lost_sales"].clip(lower=0)
                                                                               ^
./api/forecast.py:794:80: E501 line too long (86 > 79 characters)
                columns=["sale_date", "estimated_demand", "lost_sales", "sale_amount"]
                                                                               ^
./api/forecast.py:802:80: E501 line too long (84 > 79 characters)
                stockout_days["lost_sales"].mean() if stockout_days_count > 0 else 0
                                                                               ^
./api/forecast.py:862:80: E501 line too long (88 > 79 characters)
                status_code=400, detail="No data available for the specified parameters"
                                                                               ^
./api/forecast.py:883:80: E501 line too long (88 > 79 characters)
                "summary": {"message": "No holidays found in the specified date range"},
                                                                               ^
./api/forecast.py:924:80: E501 line too long (81 > 79 characters)
                comparison_sales.groupby("sale_date")["sale_amount"].sum().mean()
                                                                               ^
./api/forecast.py:939:80: E501 line too long (86 > 79 characters)
                        holiday["holiday_type"] if "holiday_type" in holiday else None
                                                                               ^
./api/forecast.py:953:80: E501 line too long (80 > 79 characters)
            total_lift = sum(impact["sales_lift"] for impact in holiday_impacts)
                                                                               ^
./api/promotions.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FastAPI endpoints for promotion management and recommendation.
"""
^
./api/promotions.py:6:1: F401 'typing.Union' imported but unused
from typing import Dict, List, Optional, Union, Any
^
./api/promotions.py:8:1: F401 'numpy as np' imported but unused
import numpy as np
^
./api/promotions.py:9:1: F401 'fastapi.FastAPI' imported but unused
from fastapi import FastAPI, APIRouter, HTTPException, Depends
^
./api/promotions.py:10:1: F401 'pydantic.Field' imported but unused
from pydantic import BaseModel, Field
^
./api/promotions.py:17:1: E402 module level import not at top of file
from models.promo_uplift_model import PromoUpliftModel
^
./api/promotions.py:18:1: E402 module level import not at top of file
from database.connection import get_db_engine, get_supabase_client
^
./api/promotions.py:19:1: E402 module level import not at top of file
from api.forecast import get_promo_model, fetch_historical_data
^
./api/promotions.py:23:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
./api/promotions.py:136:80: E501 line too long (82 > 79 characters)
        response = supabase.table("promotion_events").insert(promo_data).execute()
                                                                               ^
./api/promotions.py:144:80: E501 line too long (85 > 79 characters)
            raise HTTPException(status_code=500, detail="Failed to create promotion")
                                                                               ^
./api/promotions.py:179:80: E501 line too long (85 > 79 characters)
                status_code=404, detail=f"Promotion with ID {promotion_id} not found"
                                                                               ^
./api/promotions.py:189:80: E501 line too long (86 > 79 characters)
            update_data["start_date"] = pd.to_datetime(promotion.start_date).strftime(
                                                                               ^
./api/promotions.py:193:80: E501 line too long (82 > 79 characters)
            update_data["end_date"] = pd.to_datetime(promotion.end_date).strftime(
                                                                               ^
./api/promotions.py:216:80: E501 line too long (85 > 79 characters)
            raise HTTPException(status_code=500, detail="Failed to update promotion")
                                                                               ^
./api/promotions.py:250:80: E501 line too long (85 > 79 characters)
                status_code=404, detail=f"Promotion with ID {promotion_id} not found"
                                                                               ^
./api/promotions.py:255:80: E501 line too long (88 > 79 characters)
            supabase.table("promotion_events").delete().eq("id", promotion_id).execute()
                                                                               ^
./api/promotions.py:259:80: E501 line too long (88 > 79 characters)
            return {"message": f"Promotion with ID {promotion_id} deleted successfully"}
                                                                               ^
./api/promotions.py:261:80: E501 line too long (85 > 79 characters)
            raise HTTPException(status_code=500, detail="Failed to delete promotion")
                                                                               ^
./api/promotions.py:288:80: E501 line too long (94 > 79 characters)
    """
    List promotions with optional filters.

    Parameters:
    - store_id: Filter by store ID
    - product_id: Filter by product ID
    - category_id: Filter by category ID
    - start_date: Filter by start date
    - end_date: Filter by end date
    - active: If true, return only active promotions (current date between start and end date)

    Returns:
    - List of matching promotions
    """
       
                                          

               
           ^
./api/promotions.py:298:15: W291 trailing whitespace
        query = """
        SELECT 
            pe.id,
            pe.store_id,
            pe.product_id,
            pe.start_date,
            pe.end_date,
            pe.promotion_type,
            pe.discount_percentage,
            pe.display_location,
            pe.campaign_id,
            pe.created_at
        FROM promotion_events pe
        """
              ^
./api/promotions.py:386:31: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    model: PromoUpliftModel = Depends(get_promo_model),
                              ^
./api/promotions.py:413:80: E501 line too long (81 > 79 characters)
        start_date = target_date - timedelta(days=90)  # Use last 90 days of data
                                                                               ^
./api/promotions.py:429:80: E501 line too long (103 > 79 characters)
                detail=f"Not enough historical data ({len(df)} records) for promotion recommendations",
                                                                               ^
./api/promotions.py:453:80: E501 line too long (85 > 79 characters)
        # For each combination, simulate different discount levels and predict uplift
                                                                               ^
./api/promotions.py:456:80: E501 line too long (83 > 79 characters)
        discount_levels = [d for d in discount_levels if d <= request.max_discount]
                                                                               ^
./api/promotions.py:511:80: E501 line too long (86 > 79 characters)
                        rec[col] = int(combo[col]) if pd.notnull(combo[col]) else None
                                                                               ^
./api/promotions.py:515:80: E501 line too long (84 > 79 characters)
                    logger.warning(f"Error predicting uplift for {combo}: {str(e)}")
                                                                               ^
./api/promotions.py:563:80: E501 line too long (81 > 79 characters)
            status_code=500, detail=f"Error generating recommendations: {str(e)}"
                                                                               ^
./api/sales.py:1:1: D100 Missing docstring in public module
./api/stockout.py:1:1: D100 Missing docstring in public module
./app/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting API package.
"""
^
./app/api.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FastAPI application for forecasting API (refactored to use service layer and model loader).
"""
^
./app/api.py:2:80: E501 line too long (91 > 79 characters)
"""
FastAPI application for forecasting API (refactored to use service layer and model loader).
"""
   
                                                                           ^
./app/api.py:7:1: F401 'typing.List' imported but unused
from typing import List, Dict, Any, Optional
^
./app/api.py:7:1: F401 'typing.Dict' imported but unused
from typing import List, Dict, Any, Optional
^
./app/api.py:7:1: F401 'typing.Any' imported but unused
from typing import List, Dict, Any, Optional
^
./app/api.py:7:1: F401 'typing.Optional' imported but unused
from typing import List, Dict, Any, Optional
^
./app/api.py:49:1: D103 Missing docstring in public function
async def get_db_connection():
^
./app/api.py:59:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def root():
^
./app/api.py:60:1: D400 First line should end with a period
    """Root endpoint"""
^
./app/api.py:61:80: E501 line too long (80 > 79 characters)
    return {"status": "ok", "message": "FreshRetail Forecasting API is running"}
                                                                               ^
./app/api.py:65:1: D103 Missing docstring in public function
async def get_cities(conn=Depends(get_db_connection)):
^
./app/api.py:65:27: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def get_cities(conn=Depends(get_db_connection)):
                          ^
./app/api.py:74:1: D103 Missing docstring in public function
async def get_stores(conn=Depends(get_db_connection)):
^
./app/api.py:74:27: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def get_stores(conn=Depends(get_db_connection)):
                          ^
./app/api.py:76:80: E501 line too long (162 > 79 characters)
        "SELECT s.store_id, s.store_name, s.city_id, c.city_name FROM store_hierarchy s LEFT JOIN city_hierarchy c ON s.city_id = c.city_id ORDER BY s.store_name"
                                                                               ^
./app/api.py:83:1: D103 Missing docstring in public function
async def get_products(conn=Depends(get_db_connection)):
^
./app/api.py:83:29: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def get_products(conn=Depends(get_db_connection)):
                            ^
./app/api.py:85:80: E501 line too long (86 > 79 characters)
        "SELECT product_id, product_name FROM product_hierarchy ORDER BY product_name"
                                                                               ^
./app/api.py:92:51: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def forecast(request: ForecastRequest, conn=Depends(get_db_connection)):
                                                  ^
./app/api.py:93:1: D400 First line should end with a period
    """Generate sales forecast"""
^
./app/api.py:96:9: F841 local variable 'df' is assigned to but never used
        df = await fetch_historical_data(
        ^
./app/api.py:136:80: E501 line too long (80 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Forecast error: {str(e)}")
                                                                               ^
./app/api.py:138:9: ASYNC102 await inside try/finally on line 94 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:143:45: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    request: PromotionAnalysisRequest, conn=Depends(get_db_connection)
                                            ^
./app/api.py:145:1: D400 First line should end with a period
    """Analyze promotion effectiveness"""
^
./app/api.py:174:9: ASYNC102 await inside try/finally on line 146 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:179:44: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    request: StockoutAnalysisRequest, conn=Depends(get_db_connection)
                                           ^
./app/api.py:181:1: D400 First line should end with a period
    """Analyze stockout impact"""
^
./app/api.py:199:9: ASYNC102 await inside try/finally on line 182 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:204:41: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    request: HolidayImpactRequest, conn=Depends(get_db_connection)
                                        ^
./app/api.py:206:1: D400 First line should end with a period
    """Analyze holiday effects on sales"""
^
./app/api.py:222:80: E501 line too long (88 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Holiday analysis error: {str(e)}")
                                                                               ^
./app/api.py:224:9: ASYNC102 await inside try/finally on line 207 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:228:1: D103 Missing docstring in public function
async def forecast_get(
^
./app/api.py:229:20: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    city_id: int = Path(...),
                   ^
./app/api.py:230:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    store_id: int = Path(...),
                    ^
./app/api.py:231:23: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    product_id: int = Path(...),
                      ^
./app/api.py:232:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(30),
                ^
./app/api.py:233:10: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    conn=Depends(get_db_connection),
         ^
./app/api.py:258:80: E501 line too long (80 > 79 characters)
            city_id=city_id, store_id=store_id, product_id=product_id, conn=conn
                                                                               ^
./app/api.py:261:80: E501 line too long (86 > 79 characters)
        print(f"Forecasting debug: rows in df={len(df)}, min_required={min_required}")
                                                                               ^
./app/api.py:264:80: E501 line too long (130 > 79 characters)
                "detail": f"Not enough historical data for forecasting. Found {len(df)} rows, minimum required is {min_required}."
                                                                               ^
./app/api.py:271:80: E501 line too long (84 > 79 characters)
                city_id=city_id, store_id=store_id, product_id=product_id, conn=conn
                                                                               ^
./app/api.py:302:80: E501 line too long (118 > 79 characters)
            f"DEBUG: Returning transformed result with {len(transformed_result['forecasted_values'])} forecast values"
                                                                               ^
./app/api.py:304:80: E501 line too long (88 > 79 characters)
        print(f"DEBUG: First few values: {transformed_result['forecasted_values'][:5]}")
                                                                               ^
./app/api.py:312:80: E501 line too long (80 > 79 characters)
        raise HTTPException(status_code=500, detail=f"Forecast error: {str(e)}")
                                                                               ^
./app/api.py:314:9: ASYNC102 await inside try/finally on line 235 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:318:1: D103 Missing docstring in public function
async def promotions_impact_get(
^
./app/api.py:321:24: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    category_id: int = Query(0),
                       ^
./app/api.py:322:20: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    city_id: int = Query(0),
                   ^
./app/api.py:323:23: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    start_date: str = Query(None),
                      ^
./app/api.py:324:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    end_date: str = Query(None),
                    ^
./app/api.py:325:10: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    conn=Depends(get_db_connection),
         ^
./app/api.py:329:80: E501 line too long (184 > 79 characters)
            f"Promotion impact request params: store_id={store_id}, product_id={product_id}, category_id={category_id}, city_id={city_id}, start_date={start_date}, end_date={end_date}"
                                                                               ^
./app/api.py:409:9: ASYNC102 await inside try/finally on line 327 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:413:1: D103 Missing docstring in public function
async def stockout_risk_get(
^
./app/api.py:414:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    store_id: int = Path(...),
                    ^
./app/api.py:415:23: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    product_id: int = Path(...),
                      ^
./app/api.py:416:10: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    conn=Depends(get_db_connection),
         ^
./app/api.py:475:9: ASYNC102 await inside try/finally on line 418 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/api.py:479:1: D103 Missing docstring in public function
async def get_valid_combinations(conn=Depends(get_db_connection)):
^
./app/api.py:479:39: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def get_valid_combinations(conn=Depends(get_db_connection)):
                                      ^
./app/api.py:481:20: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
   ^
./app/api.py:482:20: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
   ^
./app/api.py:483:22: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
     ^
./app/api.py:484:21: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
    ^
./app/api.py:485:23: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
      ^
./app/api.py:486:23: W291 trailing whitespace
    query = """
    SELECT DISTINCT 
        sh.city_id, 
        ch.city_name, 
        sh.store_id, 
        sh.store_name, 
        ph.product_id, 
        ph.product_name
    FROM sales_data sd
    JOIN store_hierarchy sh ON sd.store_id = sh.store_id
    JOIN product_hierarchy ph ON sd.product_id = ph.product_id
    LEFT JOIN city_hierarchy ch ON sh.city_id = ch.city_id
    """
               
      ^
./app/api.py:499:27: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
async def debug_data(conn=Depends(get_db_connection)):
                          ^
./app/api.py:500:1: D400 First line should end with a period
    """Debug endpoint to find valid data combinations"""
^
./app/api.py:504:24: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
   ^
./app/api.py:505:25: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
    ^
./app/api.py:506:27: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
      ^
./app/api.py:531:9: ASYNC102 await inside try/finally on line 501 must have shielded cancel scope with a timeout.
        await conn.close()
        ^
./app/main.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Main application entry point.
"""
^
./app/main.py:22:1: D103 Missing docstring in public function
def root():
^
./app/main.py:33:1: D400 First line should end with a period
    """Debug endpoint to find valid data combinations"""
^
./app/main.py:43:24: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
   ^
./app/main.py:44:25: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
    ^
./app/main.py:45:27: W291 trailing whitespace
        query = """
        SELECT DISTINCT 
            sd.store_id, 
            sd.product_id, 
            sh.city_id,
            COUNT(*) as record_count
        FROM sales_data sd
        JOIN store_hierarchy sh ON sd.store_id = sh.store_id
        GROUP BY sd.store_id, sd.product_id, sh.city_id
        HAVING COUNT(*) >= 5
        ORDER BY record_count DESC
        LIMIT 10
        """
                   
      ^
./database/__init__.py:1:1: D104 Missing docstring in public package
# Database package initialization
^
./database/config.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Centralized database configuration with connection pooling and caching.
"""
^
./database/config.py:50:80: E501 line too long (134 > 79 characters)
    return f"postgresql://{DB_CONFIG['user']}:{DB_CONFIG['password']}@{DB_CONFIG['host']}:{DB_CONFIG['port']}/{DB_CONFIG['database']}"
                                                                               ^
./database/connection.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Database connection manager with connection pooling.
"""
^
./database/connection.py:6:1: F401 'typing.Dict' imported but unused
from typing import Optional, Dict, Any
^
./database/connection.py:6:1: F401 'typing.Any' imported but unused
from typing import Optional, Dict, Any
^
./database/connection.py:17:80: E501 line too long (86 > 79 characters)
_cache: TTLCache = TTLCache(maxsize=cache_config["max_size"], ttl=cache_config["ttl"])
                                                                               ^
./database/connection.py:46:1: D401 First line should be in imperative mood
    """Decorator for caching database query results."""
^
./database/connection.py:52:80: E501 line too long (126 > 79 characters)
            cache_key = f"{key_prefix}:{':'.join(str(arg) for arg in args)}:{':'.join(f'{k}={v}' for k, v in kwargs.items())}"
                                                                               ^
./database/connection.py:69:1: D401 First line should be in imperative mood
    """Decorator for adding pagination to database queries."""
^
./database/connection.py:109:80: E501 line too long (87 > 79 characters)
    raise NotImplementedError("get_db_engine not implemented - use get_pool() instead")
                                                                               ^
./database/mappings.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Mappings for encoded values to real-world names and transformations in the FreshRetailNet-50K dataset.
"""
^
./database/mappings.py:2:80: E501 line too long (102 > 79 characters)
"""
Mappings for encoded values to real-world names and transformations in the FreshRetailNet-50K dataset.
"""
   
                                                                           ^
./database/mappings.py:6:1: F401 'numpy as np' imported but unused
import numpy as np
^
./database/mappings.py:54:80: E501 line too long (87 > 79 characters)
    return base_price * city_adjustment * (category_multiplier / BASE_SALES_MULTIPLIER)
                                                                               ^
./database/mappings.py:76:80: E501 line too long (84 > 79 characters)
            decode_sales_amount(x, city_id, management_group_id) for x in hours_sale
                                                                               ^
./database/mappings.py:85:80: E501 line too long (85 > 79 characters)
        encode_sales_amount(x, city_id, management_group_id) for x in real_hours_sale
                                                                               ^
./database/mappings.py:205:9: F841 local variable 'group' is assigned to but never used
        group = MANAGEMENT_GROUP_MAPPINGS[management_group_id]
        ^
./database/promotion_repository.py:1:1: D100 Missing docstring in public module
import asyncpg  # type: ignore
^
./database/promotion_repository.py:7:1: D200 One-line docstring should fit on one line with quotes
    """
    Async repository for promotion CRUD and query operations using asyncpg.
    """
^
./database/promotion_repository.py:11:1: D107 Missing docstring in __init__
    def __init__(self, dsn: str):
^
./database/promotion_repository.py:14:1: D102 Missing docstring in public method
    async def get_connection(self):
^
./database/promotion_repository.py:17:80: E501 line too long (87 > 79 characters)
    async def create_promotion(self, promotion_data: Dict[str, Any]) -> Dict[str, Any]:
                                                                               ^
./database/promotion_repository.py:18:1: D205 1 blank line required between summary line and description
        """
        Insert a new promotion into the database.
        Returns the created promotion record.
        """
^
./database/promotion_repository.py:24:80: E501 line too long (138 > 79 characters)
        query = """
            INSERT INTO promotion_events (
                store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
            ) VALUES (
                $1, $2, $3, $4, $5, $6, $7, $8, $9
            ) RETURNING id, store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
        """
                   
                                          
                ^
./database/promotion_repository.py:27:80: E501 line too long (150 > 79 characters)
        query = """
            INSERT INTO promotion_events (
                store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
            ) VALUES (
                $1, $2, $3, $4, $5, $6, $7, $8, $9
            ) RETURNING id, store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
        """
                   
                                          
                ^
./database/promotion_repository.py:47:1: D205 1 blank line required between summary line and description
        """
        Update an existing promotion by ID.
        Returns the updated promotion record, or None if not found.
        """
^
./database/promotion_repository.py:66:80: E501 line too long (148 > 79 characters)
        query = f"""
            UPDATE promotion_events
            SET {set_clause}
            WHERE id = ${idx}
            RETURNING id, store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
        """
                    
                                   
                      ^
./database/promotion_repository.py:73:1: D205 1 blank line required between summary line and description
        """
        Delete a promotion by ID.
        Returns True if deleted, False if not found.
        """
^
./database/promotion_repository.py:86:80: E501 line too long (81 > 79 characters)
    async def get_promotion(self, promotion_id: int) -> Optional[Dict[str, Any]]:
                                                                               ^
./database/promotion_repository.py:87:1: D205 1 blank line required between summary line and description
        """
        Get a single promotion by ID.
        Returns the promotion record, or None if not found.
        """
^
./database/promotion_repository.py:92:80: E501 line too long (145 > 79 characters)
        query = """
            SELECT id, store_id, product_id, start_date, end_date, promotion_type, discount_percentage, display_location, campaign_id, created_at
            FROM promotion_events
            WHERE id = $1
        """
                   
                                                           ^
./database/promotion_repository.py:109:1: D205 1 blank line required between summary line and description
        """
        List promotions with optional filters.
        Returns a list of promotion records.
        """
^
./database/promotion_repository.py:139:80: E501 line too long (82 > 79 characters)
            filters.append(f"pe.start_date <= ${idx} AND pe.end_date >= ${idx+1}")
                                                                               ^
./database/promotion_repository.py:145:80: E501 line too long (175 > 79 characters)
        base_query = """
            SELECT pe.id, pe.store_id, pe.product_id, pe.start_date, pe.end_date, pe.promotion_type, pe.discount_percentage, pe.display_location, pe.campaign_id, pe.created_at
            FROM promotion_events pe
        """
                        
                                                      ^
./database/promotion_repository.py:149:80: E501 line too long (88 > 79 characters)
            base_query += " JOIN product_hierarchy ph ON pe.product_id = ph.product_id "
                                                                               ^
./database/repository.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Template repository demonstrating connection pooling, caching, and pagination.
"""
^
./database/repository.py:28:80: E501 line too long (83 > 79 characters)
            query = f"SELECT * FROM {table} ORDER BY {order_by} LIMIT $1 OFFSET $2"
                                                                               ^
./database/repository.py:29:80: E501 line too long (88 > 79 characters)
            records = await conn.fetch(query, kwargs.get("limit"), kwargs.get("offset"))
                                                                               ^
./database/repository.py:57:80: E501 line too long (86 > 79 characters)
            set_clause = ", ".join(f"{k} = ${i+2}" for i, k in enumerate(data.keys()))
                                                                               ^
./database/repository.py:86:80: E501 line too long (88 > 79 characters)
    async def get_sales_by_store(self, store_id: int, **kwargs) -> List[Dict[str, Any]]:
                                                                               ^
./database/repository.py:98:80: E501 line too long (81 > 79 characters)
                query, store_id, kwargs.get("limit", 50), kwargs.get("offset", 0)
                                                                               ^
./database/repository.py:103:80: E501 line too long (84 > 79 characters)
    async def get_store_statistics(self, store_id: int) -> Optional[Dict[str, Any]]:
                                                                               ^
./models/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting models package.
"""
^
./models/forecast_models.py:1:1: D100 Missing docstring in public module
from typing import List, Dict, Any, Optional
^
./models/forecast_models.py:10:80: E501 line too long (81 > 79 characters)
    category_id: Optional[int] = None  # Used for filtering via product_hierarchy
                                                                               ^
./models/holiday_impact.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Holiday impact analysis module for evaluating sales lift during holidays.
"""
^
./models/holiday_impact.py:6:1: F401 'numpy as np' imported but unused
import numpy as np
^
./models/holiday_impact.py:10:1: D400 First line should end with a period
    """
    Analyze sales lift during holidays

    Args:
        df: DataFrame with sales data including holiday_flag

    Returns:
        DataFrame with holiday impact metrics
    """
^
./models/holiday_impact.py:104:1: D400 First line should end with a period
    """
    Get dates for a specific holiday from sales data

    Args:
        df: DataFrame with sales data
        holiday_name: Name of the holiday to extract

    Returns:
        List of holiday dates
    """
^
./models/holiday_impact.py:123:80: E501 line too long (87 > 79 characters)
    holiday_data = df[(df["holiday_flag"] == 1) & (df["holiday_name"] == holiday_name)]
                                                                               ^
./models/holiday_impact.py:132:1: D400 First line should end with a period
    """
    Get list of all holiday names in the dataset

    Args:
        df: DataFrame with sales data

    Returns:
        List of unique holiday names
    """
^
./models/promo_uplift.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Promotion uplift model for estimating promotion effectiveness.
"""
^
./models/promo_uplift.py:5:1: F401 'pandas as pd' imported but unused
import pandas as pd  # type: ignore
^
./models/promo_uplift.py:6:1: F401 'numpy as np' imported but unused
import numpy as np  # type: ignore
^
./models/promo_uplift.py:7:1: F401 'typing.Dict' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift.py:7:1: F401 'typing.List' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift.py:7:1: F401 'typing.Optional' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift.py:7:1: F401 'typing.Any' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift.py:7:1: F401 'typing.Tuple' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift.py:8:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./models/promo_uplift.py:8:1: F401 'datetime.timedelta' imported but unused
from datetime import datetime, timedelta
^
./models/promo_uplift.py:9:1: F401 'logging' imported but unused
import logging
^
./models/promo_uplift.py:17:1: D400 First line should end with a period
    """Model for predicting promotion effectiveness"""
^
./models/promo_uplift.py:20:1: D400 First line should end with a period
        """Initialize the promotion uplift model"""
^
./models/promo_uplift.py:35:1: D400 First line should end with a period
        """Prepare data for uplift modeling"""
^
./models/promo_uplift.py:37:80: E501 line too long (104 > 79 characters)
        # For this demo, we'll use a simple approach: compare sales to the average sales for the product
                                                                               ^
./models/promo_uplift.py:41:80: E501 line too long (88 > 79 characters)
        product_avg = promo_df.groupby("product_id")["sale_amount"].mean().reset_index()
                                                                               ^
./models/promo_uplift.py:67:1: D400 First line should end with a period
        """Fit the uplift model"""
^
./models/promo_uplift.py:93:1: D400 First line should end with a period
        """Predict uplift for new data"""
^
./models/promo_uplift.py:95:80: E501 line too long (87 > 79 characters)
        available_features = [col for col in self.feature_columns if col in df.columns]
                                                                               ^
./models/promo_uplift_model.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Promotion uplift model to estimate the impact of promotions on sales.
"""
^
./models/promo_uplift_model.py:8:1: F401 'typing.Dict' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift_model.py:8:1: F401 'typing.List' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift_model.py:8:1: F401 'typing.Optional' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift_model.py:8:1: F401 'typing.Any' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift_model.py:8:1: F401 'typing.Tuple' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./models/promo_uplift_model.py:21:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
./models/promo_uplift_model.py:27:1: D200 One-line docstring should fit on one line with quotes
    """
    Model to predict promotion uplift (how much sales increase due to promotions).
    """
^
./models/promo_uplift_model.py:28:80: E501 line too long (82 > 79 characters)
    """
    Model to predict promotion uplift (how much sales increase due to promotions).
    """
       
                                                                       ^
./models/promo_uplift_model.py:36:80: E501 line too long (104 > 79 characters)
        """
        Initialize promotion uplift model.

        Args:
            model_type (str): Type of model to use - 'random_forest', 'gradient_boost', or 'elastic_net'
            model_params (dict): Parameters for the model
        """
           
                                          

             
         ^
./models/promo_uplift_model.py:50:80: E501 line too long (81 > 79 characters)
        logger.info(f"Initialized PromoUpliftModel with model_type={model_type}")
                                                                               ^
./models/promo_uplift_model.py:84:80: E501 line too long (88 > 79 characters)
                f"Supported types are: 'random_forest', 'gradient_boost', 'elastic_net'"
                                                                               ^
./models/promo_uplift_model.py:88:80: E501 line too long (82 > 79 characters)
        self.pipeline = Pipeline([("scaler", self.scaler), ("model", self.model)])
                                                                               ^
./models/promo_uplift_model.py:96:80: E501 line too long (81 > 79 characters)
        """
        Prepare data for modeling by creating features and target.

        Args:
            df (pd.DataFrame): Input dataframe with sales and promotion data
            target_col (str): Column name containing the target variable (uplift)
            drop_cols (list): Columns to drop from features

        Returns:
            tuple: X (features), y (target)
        """
           
                                                                  
^
./models/promo_uplift_model.py:116:80: E501 line too long (89 > 79 characters)
                    f"Required columns for uplift calculation not found: {required_cols}"
                                                                               ^
./models/promo_uplift_model.py:119:80: E501 line too long (82 > 79 characters)
            # Calculate uplift as the difference between promo and non-promo sales
                                                                               ^
./models/promo_uplift_model.py:120:80: E501 line too long (89 > 79 characters)
            # Group by relevant dimensions and calculate average sales with/without promo
                                                                               ^
./models/promo_uplift_model.py:123:80: E501 line too long (85 > 79 characters)
                for col in ["store_id", "product_id", "city_id", "first_category_id"]
                                                                               ^
./models/promo_uplift_model.py:128:80: E501 line too long (84 > 79 characters)
                raise ValueError("No grouping columns found for uplift calculation")
                                                                               ^
./models/promo_uplift_model.py:151:80: E501 line too long (84 > 79 characters)
            print("promo_flag counts:", df["promo_flag"].value_counts(dropna=False))
                                                                               ^
./models/promo_uplift_model.py:160:80: E501 line too long (212 > 79 characters)
                    f'Not enough promo/non-promo sales for uplift calculation. Data shape: {shape_info}, promo_flag counts: {df["promo_flag"].value_counts(dropna=False).to_dict()}, columns: {df.columns.tolist()}'
                                                                               ^
./models/promo_uplift_model.py:163:80: E501 line too long (83 > 79 characters)
                avg_sales_pivot["promo_sales"] - avg_sales_pivot["non_promo_sales"]
                                                                               ^
./models/promo_uplift_model.py:190:80: E501 line too long (81 > 79 characters)
        drop_cols_existing = [col for col in cols_to_drop if col in data.columns]
                                                                               ^
./models/promo_uplift_model.py:216:80: E501 line too long (81 > 79 characters)
        """
        Train the promotion uplift model.

        Args:
            df (pd.DataFrame): Input dataframe with sales and promotion data
            target_col (str): Column name containing the target variable (uplift)
            drop_cols (list): Columns to drop from features
            test_size (float): Proportion of data to use for testing

        Returns:
            dict: Training metrics
        """
           
                                         

             
          ^
./models/promo_uplift_model.py:232:80: E501 line too long (88 > 79 characters)
        logger.info(f"Training {self.model_type} model with {X_train.shape[0]} samples")
                                                                               ^
./models/promo_uplift_model.py:248:80: E501 line too long (98 > 79 characters)
                f"Top 5 features: {', '.join(self.feature_importance['feature'].head().tolist())}"
                                                                               ^
./models/promo_uplift_model.py:254:20: F821 undefined name 'mean_absolute_error'
            "mae": mean_absolute_error(y_test, y_pred),
                   ^
./models/promo_uplift_model.py:265:21: F821 undefined name 'cross_val_score'
        cv_scores = cross_val_score(
                    ^
./models/promo_uplift_model.py:304:80: E501 line too long (88 > 79 characters)
    def analyze_promotion_effectiveness(self, df, group_cols=None, target_col="uplift"):
                                                                               ^
./models/promo_uplift_model.py:311:80: E501 line too long (81 > 79 characters)
        """
        Analyze promotion effectiveness by different dimensions.

        Args:
            df (pd.DataFrame): Input dataframe with sales and promotion data
            group_cols (list): Columns to group by for analysis
            target_col (str): Column name containing the target variable (uplift)

        Returns:
            pd.DataFrame: Analysis results
        """
           
                                                                

 ^
./models/promo_uplift_model.py:317:80: E501 line too long (82 > 79 characters)
            logger.warning("Model not trained, will use actual data for analysis")
                                                                               ^
./models/promo_uplift_model.py:359:80: E501 line too long (88 > 79 characters)
        group_results = group_results.sort_values(f"{target_col}_mean", ascending=False)
                                                                               ^
./models/promo_uplift_model.py:384:80: E501 line too long (99 > 79 characters)
                f"promo_uplift_{self.model_type}_{datetime.now().strftime('%Y%m%d%H%M%S')}.joblib",
                                                                               ^
./models/promo_uplift_model.py:425:80: E501 line too long (87 > 79 characters)
                self.feature_importance = features_data.get("feature_importance", None)
                                                                               ^
./models/promo_uplift_model.py:445:80: E501 line too long (84 > 79 characters)
            datetime(2022, 1, 1) + timedelta(days=i % 365) for i in range(n_samples)
                                                                               ^
./models/promo_uplift_model.py:448:80: E501 line too long (84 > 79 characters)
        "promo_flag": np.random.choice([True, False], size=n_samples, p=[0.3, 0.7]),
                                                                               ^
./models/prophet_forecaster.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Prophet forecasting model wrapper.
"""
^
./models/prophet_forecaster.py:8:1: F401 'typing.Union' imported but unused
from typing import Union, Optional, Dict, Any
^
./models/prophet_forecaster.py:12:1: D400 First line should end with a period
    """Wrapper class for Facebook Prophet forecasting model"""
^
./models/prophet_forecaster.py:29:1: D400 First line should end with a period
        """Initialize the Prophet model with appropriate components"""
^
./models/prophet_forecaster.py:35:80: E501 line too long (86 > 79 characters)
            growth="logistic",  # Added logistic growth to enforce non-negative values
                                                                               ^
./models/prophet_forecaster.py:47:1: D400 First line should end with a period
        """Add relevant regressors to the model based on configuration"""
^
./models/prophet_forecaster.py:69:1: D400 First line should end with a period
        """Prepare data for Prophet model"""
^
./models/prophet_forecaster.py:78:80: E501 line too long (86 > 79 characters)
            forecast_df = forecast_df.rename(columns={"dt": "ds", "sale_amount": "y"})
                                                                               ^
./models/prophet_forecaster.py:84:80: E501 line too long (84 > 79 characters)
            raise ValueError("Input DataFrame must have 'dt' or 'sale_date' column")
                                                                               ^
./models/prophet_forecaster.py:88:80: E501 line too long (81 > 79 characters)
                "Input DataFrame must have 'sale_amount' column to rename to 'y'"
                                                                               ^
./models/prophet_forecaster.py:115:1: D400 First line should end with a period
        """Fit the Prophet model"""
^
./models/prophet_forecaster.py:122:1: D400 First line should end with a period
        """Train the model (alias for fit)"""
^
./models/prophet_forecaster.py:143:1: D400 First line should end with a period
        """Generate forecast for future periods"""
^
./models/prophet_forecaster.py:147:80: E501 line too long (80 > 79 characters)
        forecast = self.predict(periods=periods, freq=freq, future_df=future_df)
                                                                               ^
./models/prophet_forecaster.py:151:1: D400 First line should end with a period
        """Generate forecast for the specified periods"""
^
./models/prophet_forecaster.py:154:80: E501 line too long (96 > 79 characters)
            f"DEBUG: periods={periods}, freq={freq}, future_df provided={future_df is not None}"
                                                                               ^
./models/prophet_forecaster.py:160:80: E501 line too long (83 > 79 characters)
            print(f"DEBUG: Future dataframe columns: {future_df.columns.tolist()}")
                                                                               ^
./models/prophet_forecaster.py:162:80: E501 line too long (93 > 79 characters)
            # For future data, we don't need to rename columns - just ensure ds column exists
                                                                               ^
./models/prophet_forecaster.py:174:80: E501 line too long (81 > 79 characters)
            if hasattr(self.model, "history") and self.model.history is not None:
                                                                               ^
./models/prophet_forecaster.py:182:80: E501 line too long (86 > 79 characters)
            print(f"DEBUG: Final future dataframe columns: {future.columns.tolist()}")
                                                                               ^
./models/prophet_forecaster.py:184:80: E501 line too long (87 > 79 characters)
            print("DEBUG: Creating future dataframe using model.make_future_dataframe")
                                                                               ^
./models/prophet_forecaster.py:185:80: E501 line too long (81 > 79 characters)
            future = self.model.make_future_dataframe(periods=periods, freq=freq)
                                                                               ^
./models/prophet_forecaster.py:188:80: E501 line too long (81 > 79 characters)
            if hasattr(self.model, "history") and self.model.history is not None:
                                                                               ^
./models/prophet_forecaster.py:220:1: D400 First line should end with a period
        """Plot forecast components"""
^
./models/prophet_forecaster.py:231:80: E501 line too long (88 > 79 characters)
            raise ValueError("A forecast DataFrame must be provided to get components.")
                                                                               ^
./models/prophet_forecaster.py:233:9: F841 local variable 'fig' is assigned to but never used
        fig = self.model.plot_components(forecast_df)
        ^
./models/prophet_forecaster.py:234:80: E501 line too long (104 > 79 characters)
        # Prophet's plot_components returns a matplotlib figure, not the data, so we return None for now
                                                                               ^
./models/prophet_forecaster.py:235:80: E501 line too long (93 > 79 characters)
        # If you want to extract the data, you need to access the model's seasonalities, etc.
                                                                               ^
./models/stockout_analyzer.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Stockout analysis module for estimating demand during stockout periods.
"""
^
./models/stockout_analyzer.py:6:1: F401 'numpy as np' imported but unused
import numpy as np
^
./models/stockout_analyzer.py:10:1: D400 First line should end with a period
    """
    Estimate demand during stockout periods using historical patterns

    Args:
        df: DataFrame with sales data
        product_id: Optional filter by product
        store_id: Optional filter by store

    Returns:
        DataFrame with actual sales and estimated demand
    """
^
./models/stockout_analyzer.py:84:80: E501 line too long (82 > 79 characters)
            stock_df.at[idx, "estimated_demand"] = row["sale_amount"] * adjustment
                                                                               ^
./models/stockout_analyzer.py:87:80: E501 line too long (83 > 79 characters)
    stock_df["lost_sales"] = stock_df["estimated_demand"] - stock_df["sale_amount"]
                                                                               ^
./models/stockout_analyzer.py:96:1: D400 First line should end with a period
    """
    Summarize stockout impact

    Args:
        df: DataFrame with stockout analysis results

    Returns:
        Dictionary with stockout metrics
    """
^
./models/xgboost_forecaster.py:1:1: D100 Missing docstring in public module
./notebooks/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting notebooks package.
"""
^
./scripts/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting scripts package.
"""
^
./scripts/export_dataset.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to export FreshRetailNet-50K data from Hugging Face to various formats.
"""
^
./scripts/export_dataset.py:6:1: F401 'numpy as np' imported but unused
import numpy as np  # type: ignore
^
./scripts/export_dataset.py:7:1: F401 'typing.Dict' imported but unused
from typing import Dict, List, Optional, Any
^
./scripts/export_dataset.py:7:1: F401 'typing.List' imported but unused
from typing import Dict, List, Optional, Any
^
./scripts/export_dataset.py:7:1: F401 'typing.Optional' imported but unused
from typing import Dict, List, Optional, Any
^
./scripts/export_dataset.py:7:1: F401 'typing.Any' imported but unused
from typing import Dict, List, Optional, Any
^
./scripts/export_dataset.py:8:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./scripts/export_dataset.py:8:1: F401 'datetime.timedelta' imported but unused
from datetime import datetime, timedelta
^
./scripts/export_dataset.py:9:1: F401 'logging' imported but unused
import logging
^
./scripts/export_dataset.py:23:80: E501 line too long (82 > 79 characters)
    print("Warning: datasets library not available. Using fallback data loading.")
                                                                               ^
./scripts/export_dataset.py:34:80: E501 line too long (92 > 79 characters)
        "Warning: Mapping data not found. City and store IDs won't be mapped to real names."
                                                                               ^
./scripts/export_dataset.py:39:1: D400 First line should end with a period
    """
    Load FreshRetailNet-50K data from Hugging Face

    Args:
        limit: Optional limit on number of records to load
        offset: Optional offset to start loading from

    Returns:
        DataFrame with sales data
    """
^
./scripts/export_dataset.py:75:80: E501 line too long (82 > 79 characters)
            df_train = df_train.iloc[records_to_skip_in_first_batch:].reset_index(
                                                                               ^
./scripts/export_dataset.py:94:80: E501 line too long (85 > 79 characters)
                        df_train = pd.concat([df_train, df_batch], ignore_index=True)
                                                                               ^
./scripts/export_dataset.py:98:80: E501 line too long (88 > 79 characters)
                            [df_train, df_batch.head(needed_records)], ignore_index=True
                                                                               ^
./scripts/export_dataset.py:106:80: E501 line too long (85 > 79 characters)
            print(f"Loaded {len(df_train)} records (offset {offset}, limit {limit})")
                                                                               ^
./scripts/export_dataset.py:109:80: E501 line too long (96 > 79 characters)
                "Loading full dataset - this may take a while and consume significant memory..."
                                                                               ^
./scripts/export_dataset.py:125:1: D400 First line should end with a period
    """
    Process and transform the data

    Args:
        df: Raw DataFrame from Hugging Face

    Returns:
        Processed DataFrame
    """
^
./scripts/export_dataset.py:181:80: E501 line too long (94 > 79 characters)
    # Assign holiday names (cycle through the list if there are more holiday dates than names)
                                                                               ^
./scripts/export_dataset.py:183:80: E501 line too long (88 > 79 characters)
        date: holidays[i % len(holidays)] for i, date in enumerate(unique_holiday_dates)
                                                                               ^
./scripts/export_dataset.py:207:1: D400 First line should end with a period
    """
    Export processed data to a file

    Args:
        df: Processed DataFrame
        output_path: Path to save the output file
        format: Export format (csv, json, parquet)
    """
^
./scripts/export_dataset.py:231:1: D400 First line should end with a period
    """
    Extract and export holiday data

    Args:
        df: Processed DataFrame
        output_path: Path to save the holidays file
    """
^
./scripts/export_dataset.py:245:80: E501 line too long (86 > 79 characters)
    holiday_data = holiday_data.rename(columns={"dt": "date", "holiday_name": "name"})
                                                                               ^
./scripts/export_dataset.py:256:1: D400 First line should end with a period
    """Main function to export data"""
^
./scripts/export_dataset.py:256:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to export data"""
^
./scripts/export_dataset.py:264:80: E501 line too long (85 > 79 characters)
    parser.add_argument("--offset", type=int, default=0, help="Offset to start from")
                                                                               ^
./scripts/export_dataset.py:273:80: E501 line too long (80 > 79 characters)
        "--output", type=str, default="data_export.csv", help="Output file path"
                                                                               ^
./scripts/export_dataset.py:276:80: E501 line too long (82 > 79 characters)
        "--holidays", action="store_true", help="Export holidays to separate file"
                                                                               ^
./scripts/export_dataset_clean.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to export FreshRetailNet-50K data with exactly matching table columns.
"""
^
./scripts/export_dataset_clean.py:7:1: F401 'typing.Dict' imported but unused
from typing import Dict, List, Optional, Any
^
./scripts/export_dataset_clean.py:7:1: F401 'typing.List' imported but unused
from typing import Dict, List, Optional, Any
^
./scripts/export_dataset_clean.py:7:1: F401 'typing.Optional' imported but unused
from typing import Dict, List, Optional, Any
^
./scripts/export_dataset_clean.py:7:1: F401 'typing.Any' imported but unused
from typing import Dict, List, Optional, Any
^
./scripts/export_dataset_clean.py:8:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./scripts/export_dataset_clean.py:8:1: F401 'datetime.timedelta' imported but unused
from datetime import datetime, timedelta
^
./scripts/export_dataset_clean.py:9:1: F401 'logging' imported but unused
import logging
^
./scripts/export_dataset_clean.py:10:1: F401 'os' imported but unused
import os
^
./scripts/export_dataset_clean.py:18:1: F401 'database.connection.get_db_engine' imported but unused
from database.connection import get_db_engine
^
./scripts/export_dataset_clean.py:18:1: E402 module level import not at top of file
from database.connection import get_db_engine
^
./scripts/export_dataset_clean.py:19:1: F401 'services.data_preprocessor.DataPreprocessor' imported but unused
from services.data_preprocessor import DataPreprocessor
^
./scripts/export_dataset_clean.py:19:1: E402 module level import not at top of file
from services.data_preprocessor import DataPreprocessor
^
./scripts/export_dataset_clean.py:24:80: E501 line too long (82 > 79 characters)
    print("Warning: datasets library not available. Using fallback data loading.")
                                                                               ^
./scripts/export_dataset_clean.py:29:1: D400 First line should end with a period
    """Load data from Hugging Face dataset"""
^
./scripts/export_dataset_clean.py:69:80: E501 line too long (82 > 79 characters)
                df = pd.concat([df, batch_df.head(batch_size)], ignore_index=True)
                                                                               ^
./scripts/export_dataset_clean.py:79:1: D400 First line should end with a period
    """Process data specifically for sales_data table"""
^
./scripts/export_dataset_clean.py:125:1: D400 First line should end with a period
    """Extract holiday data from sales data"""
^
./scripts/export_dataset_clean.py:164:80: E501 line too long (87 > 79 characters)
            {"date": date.strftime("%Y-%m-%d"), "name": holiday_name, "country": "USA"}
                                                                               ^
./scripts/export_dataset_clean.py:174:1: D400 First line should end with a period
    """Generate sample promotion data"""
^
./scripts/export_dataset_clean.py:197:80: E501 line too long (87 > 79 characters)
        ["Discount", "BOGO", "Bundle", "Clearance", "New Product"], size=num_promotions
                                                                               ^
./scripts/export_dataset_clean.py:205:80: E501 line too long (85 > 79 characters)
        ["End Cap", "Front", "Main Aisle", "Register", "Window"], size=num_promotions
                                                                               ^
./scripts/export_dataset_clean.py:229:1: D400 First line should end with a period
    """Export DataFrame to CSV"""
^
./scripts/export_dataset_clean.py:236:1: D400 First line should end with a period
    """Main function"""
^
./scripts/export_dataset_clean.py:236:1: D401 First line should be in imperative mood; try rephrasing
    """Main function"""
^
./scripts/export_dataset_clean.py:237:14: F821 undefined name 'argparse'
    parser = argparse.ArgumentParser(
             ^
./scripts/export_dataset_clean.py:250:80: E501 line too long (85 > 79 characters)
    parser.add_argument("--offset", type=int, default=0, help="Offset to start from")
                                                                               ^
./scripts/export_dataset_clean.py:252:80: E501 line too long (81 > 79 characters)
        "--output", type=str, help="Output file path (default: [table_name].csv)"
                                                                               ^
./scripts/export_dataset_clean.py:268:80: E501 line too long (87 > 79 characters)
        raw_data = load_data(limit=10000)  # Need a large sample to get enough holidays
                                                                               ^
./scripts/generate_promotions.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to generate sample promotion data for the Supabase database.
"""
^
./scripts/generate_promotions.py:78:9: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
    for i in range(num_promotions):
        ^
./scripts/generate_promotions.py:85:80: E501 line too long (88 > 79 characters)
        days_from_start = np.random.randint(0, (end_dt - start_dt).days - duration_days)
                                                                               ^
./scripts/generate_promotions.py:116:1: D400 First line should end with a period
    """Export DataFrame to CSV"""
^
./scripts/generate_promotions.py:122:1: D400 First line should end with a period
    """Main function"""
^
./scripts/generate_promotions.py:122:1: D401 First line should be in imperative mood; try rephrasing
    """Main function"""
^
./scripts/generate_promotions.py:123:80: E501 line too long (82 > 79 characters)
    parser = argparse.ArgumentParser(description="Generate sample promotion data")
                                                                               ^
./scripts/generate_promotions.py:125:80: E501 line too long (81 > 79 characters)
        "--count", type=int, default=100, help="Number of promotions to generate"
                                                                               ^
./scripts/generate_promotions.py:146:80: E501 line too long (85 > 79 characters)
        num_promotions=args.count, start_date=args.start_date, end_date=args.end_date
                                                                               ^
./scripts/import_hierarchies.py:1:1: D100 Missing docstring in public module
import pandas as pd
^
./scripts/import_hierarchies.py:23:80: E501 line too long (108 > 79 characters)
        "INSERT INTO store_hierarchy (store_id, city_id) VALUES (%s, %s) ON CONFLICT (store_id) DO NOTHING",
                                                                               ^
./scripts/import_hierarchies.py:32:80: E501 line too long (99 > 79 characters)
        """
        INSERT INTO product_hierarchy
        (product_id, management_group_id, first_category_id, second_category_id, third_category_id)
        VALUES (%s, 0, 0, 0, 0) ON CONFLICT (product_id) DO NOTHING
        """,
           
                                     
                             ^
./scripts/import_sales_data.py:1:1: D100 Missing docstring in public module
import pandas as pd
^
./scripts/import_sales_data.py:66:80: E501 line too long (93 > 79 characters)
        """
        INSERT INTO sales_data (
            store_id, product_id, sale_date, sale_amount, sale_qty, discount, original_price,
            stock_hour6_22_cnt, stock_hour6_14_cnt, stock_hour14_22_cnt, holiday_flag, promo_flag, created_at
        ) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
        ON CONFLICT DO NOTHING
        """,
           
                                
                                  ^
./scripts/import_sales_data.py:67:80: E501 line too long (109 > 79 characters)
        """
        INSERT INTO sales_data (
            store_id, product_id, sale_date, sale_amount, sale_qty, discount, original_price,
            stock_hour6_22_cnt, stock_hour6_14_cnt, stock_hour14_22_cnt, holiday_flag, promo_flag, created_at
        ) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
        ON CONFLICT DO NOTHING
        """,
           
                                
                                  ^
./scripts/load_data.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to load FreshRetailNet-50K data from Hugging Face into Supabase database.
"""
^
./scripts/load_data.py:2:80: E501 line too long (80 > 79 characters)
"""
Script to load FreshRetailNet-50K data from Hugging Face into Supabase database.
"""
   
                                                                           ^
./scripts/load_data.py:8:1: F401 'json' imported but unused
import json
^
./scripts/load_data.py:11:1: F401 'numpy as np' imported but unused
import numpy as np  # type: ignore
^
./scripts/load_data.py:21:1: F401 'utils.mapping_data.CITY_MAPPING' imported but unused
from utils.mapping_data import CITY_MAPPING, STORE_MAPPING
^
./scripts/load_data.py:21:1: F401 'utils.mapping_data.STORE_MAPPING' imported but unused
from utils.mapping_data import CITY_MAPPING, STORE_MAPPING
^
./scripts/load_data.py:21:1: E402 module level import not at top of file
from utils.mapping_data import CITY_MAPPING, STORE_MAPPING
^
./scripts/load_data.py:28:1: D400 First line should end with a period
    """Simple connector class to execute SQL directly via Supabase REST API"""
^
./scripts/load_data.py:30:1: D107 Missing docstring in __init__
    def __init__(self):
^
./scripts/load_data.py:37:80: E501 line too long (95 > 79 characters)
                "Missing Supabase credentials. Set SUPABASE_URL and SUPABASE_KEY in .env file."
                                                                               ^
./scripts/load_data.py:41:1: D400 First line should end with a period
        """Execute SQL query directly using REST API"""
^
./scripts/load_data.py:44:80: E501 line too long (92 > 79 characters)
            "Authorization": f"Bearer {self.service_key if self.service_key else self.key}",
                                                                               ^
./scripts/load_data.py:52:80: E501 line too long (101 > 79 characters)
            # This is a simplified approach - for complex queries, you'd need to build the proper URL
                                                                               ^
./scripts/load_data.py:53:80: E501 line too long (82 > 79 characters)
            # For demo, we're only supporting simple INSERT/CREATE/DROP operations
                                                                               ^
./scripts/load_data.py:55:80: E501 line too long (89 > 79 characters)
                "SELECT queries not supported directly. Use the Supabase client instead."
                                                                               ^
./scripts/load_data.py:77:1: D400 First line should end with a period
    """
    Generate the SQL schema creation statements

    Returns:
        str: Complete SQL schema as a string
    """
^
./scripts/load_data.py:118:80: E501 line too long (92 > 79 characters)
    create_indexes = """
    -- Create indexes
    CREATE INDEX IF NOT EXISTS idx_sales_store_product ON sales_data (store_id, product_id);
    CREATE INDEX IF NOT EXISTS idx_sales_date ON sales_data (dt);
    CREATE INDEX IF NOT EXISTS idx_sales_city ON sales_data (city_id);
    CREATE INDEX IF NOT EXISTS idx_sales_category ON sales_data (first_category_id, second_category_id, third_category_id);
    """
                        
                     
                                ^
./scripts/load_data.py:121:80: E501 line too long (123 > 79 characters)
    create_indexes = """
    -- Create indexes
    CREATE INDEX IF NOT EXISTS idx_sales_store_product ON sales_data (store_id, product_id);
    CREATE INDEX IF NOT EXISTS idx_sales_date ON sales_data (dt);
    CREATE INDEX IF NOT EXISTS idx_sales_city ON sales_data (city_id);
    CREATE INDEX IF NOT EXISTS idx_sales_category ON sales_data (first_category_id, second_category_id, third_category_id);
    """
                        
                     
                                ^
./scripts/load_data.py:171:1: D400 First line should end with a period
    """
    Create database schema in Supabase

    Args:
        db_conn: SupabaseDirectConnector instance
    """
^
./scripts/load_data.py:200:1: D400 First line should end with a period
    """
    Load FreshRetailNet-50K data from Hugging Face

    Args:
        limit: Optional limit on number of records to load (for testing)

    Returns:
        DataFrame with sales data
    """
^
./scripts/load_data.py:232:80: E501 line too long (82 > 79 characters)
            # Start from the second batch since we already processed the first one
                                                                               ^
./scripts/load_data.py:237:80: E501 line too long (88 > 79 characters)
                if i >= batches_needed - 1:  # -1 because we already processed one batch
                                                                               ^
./scripts/load_data.py:248:80: E501 line too long (96 > 79 characters)
                "Loading full dataset - this may take a while and consume significant memory..."
                                                                               ^
./scripts/load_data.py:259:80: E501 line too long (81 > 79 characters)
                    print(f"Processed {i*batch_size + len(df_train)} records...")
                                                                               ^
./scripts/load_data.py:273:1: D400 First line should end with a period
    """
    Process and transform the data for Supabase

    Args:
        df: Raw DataFrame from Hugging Face

    Returns:
        Processed DataFrame ready for database import
    """
^
./scripts/load_data.py:329:80: E501 line too long (94 > 79 characters)
    # Assign holiday names (cycle through the list if there are more holiday dates than names)
                                                                               ^
./scripts/load_data.py:331:80: E501 line too long (88 > 79 characters)
        date: holidays[i % len(holidays)] for i, date in enumerate(unique_holiday_dates)
                                                                               ^
./scripts/load_data.py:343:1: D400 First line should end with a period
    """
    Generate SQL INSERT statements for the data

    Args:
        df: Processed DataFrame
        batch_size: Number of records in each INSERT statement

    Returns:
        list: List of SQL INSERT statements
    """
^
./scripts/load_data.py:382:80: E501 line too long (87 > 79 characters)
                f"({row['city_id']}, {row['store_id']}, {row['management_group_id']}, "
                                                                               ^
./scripts/load_data.py:384:80: E501 line too long (110 > 79 characters)
            values += f"{row['first_category_id']}, {row['second_category_id']}, {row['third_category_id']}, "
                                                                               ^
./scripts/load_data.py:385:80: E501 line too long (83 > 79 characters)
            values += f"{row['product_id']}, '{row['dt']}', {row['sale_amount']}, "
                                                                               ^
./scripts/load_data.py:386:80: E501 line too long (96 > 79 characters)
            values += f"{row['stock_hour6_22_cnt']}, {row['discount']}, {row['holiday_flag']}, "
                                                                               ^
./scripts/load_data.py:388:80: E501 line too long (86 > 79 characters)
                f"{row['activity_flag']}, {row['precpt']}, {row['avg_temperature']}, "
                                                                               ^
./scripts/load_data.py:398:56: W291 trailing whitespace
            insert_query = f"""
            -- Insert batch {i+1}/{n_batches}
            INSERT INTO sales_data (
                city_id, store_id, management_group_id, 
                first_category_id, second_category_id, third_category_id,
                product_id, dt, sale_amount, stock_hour6_22_cnt, 
                discount, holiday_flag, activity_flag, precpt, 
                avg_temperature, avg_humidity, avg_wind_level
            ) 
            VALUES {', '.join(values_list)};
            """
                               
                       ^
./scripts/load_data.py:400:65: W291 trailing whitespace
            insert_query = f"""
            -- Insert batch {i+1}/{n_batches}
            INSERT INTO sales_data (
                city_id, store_id, management_group_id, 
                first_category_id, second_category_id, third_category_id,
                product_id, dt, sale_amount, stock_hour6_22_cnt, 
                discount, holiday_flag, activity_flag, precpt, 
                avg_temperature, avg_humidity, avg_wind_level
            ) 
            VALUES {', '.join(values_list)};
            """
                               
                                ^
./scripts/load_data.py:401:63: W291 trailing whitespace
            insert_query = f"""
            -- Insert batch {i+1}/{n_batches}
            INSERT INTO sales_data (
                city_id, store_id, management_group_id, 
                first_category_id, second_category_id, third_category_id,
                product_id, dt, sale_amount, stock_hour6_22_cnt, 
                discount, holiday_flag, activity_flag, precpt, 
                avg_temperature, avg_humidity, avg_wind_level
            ) 
            VALUES {', '.join(values_list)};
            """
                               
                              ^
./scripts/load_data.py:403:14: W291 trailing whitespace
            insert_query = f"""
            -- Insert batch {i+1}/{n_batches}
            INSERT INTO sales_data (
                city_id, store_id, management_group_id, 
                first_category_id, second_category_id, third_category_id,
                product_id, dt, sale_amount, stock_hour6_22_cnt, 
                discount, holiday_flag, activity_flag, precpt, 
                avg_temperature, avg_humidity, avg_wind_level
            ) 
            VALUES {', '.join(values_list)};
            """
             ^
./scripts/load_data.py:413:1: D400 First line should end with a period
    """
    Generate SQL INSERT statements for holiday data

    Args:
        df: Processed DataFrame with holiday_name column

    Returns:
        list: List of SQL INSERT statements for holidays
    """
^
./scripts/load_data.py:450:1: D400 First line should end with a period
    """
    Insert data into Supabase database using the REST API

    Args:
        db_conn: SupabaseDirectConnector instance
        df: Processed DataFrame
        batch_size: Number of records to insert in each batch
    """
^
./scripts/load_data.py:472:80: E501 line too long (88 > 79 characters)
                    success_count += len(df) - (len(insert_statements) - 1) * batch_size
                                                                               ^
./scripts/load_data.py:480:80: E501 line too long (86 > 79 characters)
                f"Inserted approximately {success_count} records before interruption."
                                                                               ^
./scripts/load_data.py:487:80: E501 line too long (87 > 79 characters)
    print(f"Data insertion completed! Inserted approximately {success_count} records.")
                                                                               ^
./scripts/load_data.py:491:1: D400 First line should end with a period
    """
    Insert holiday data into holidays table

    Args:
        db_conn: SupabaseDirectConnector instance
        df: Processed DataFrame with holiday_name column
    """
^
./scripts/load_data.py:511:80: E501 line too long (81 > 79 characters)
            print(f"Error inserting holiday {i+1}/{len(insert_statements)}: {e}")
                                                                               ^
./scripts/load_data.py:517:1: D400 First line should end with a period
    """Main function to load data from Hugging Face to Supabase"""
^
./scripts/load_data.py:517:1: D401 First line should be in imperative mood; try rephrasing
    """Main function to load data from Hugging Face to Supabase"""
^
./scripts/load_data.py:525:80: E501 line too long (85 > 79 characters)
        "--limit", type=int, default=None, help="Limit number of records for testing"
                                                                               ^
./scripts/setup_dirs.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Script to set up the directory structure for the FreshRetail Forecasting project.
"""
^
./scripts/setup_dirs.py:2:80: E501 line too long (81 > 79 characters)
"""
Script to set up the directory structure for the FreshRetail Forecasting project.
"""
   
                                                                           ^
./scripts/setup_dirs.py:6:1: F401 'sys' imported but unused
import sys
^
./scripts/setup_dirs.py:47:80: E501 line too long (84 > 79 characters)
                f.write(f'"""\nFreshRetail Forecasting {directory} package.\n"""\n')
                                                                               ^
./scripts/setup_dirs.py:53:1: D400 First line should end with a period
    """Main function"""
^
./scripts/setup_dirs.py:53:1: D401 First line should be in imperative mood; try rephrasing
    """Main function"""
^
./scripts/update_product_names.py:1:1: D100 Missing docstring in public module
import csv
^
./scripts/update_product_names.py:21:80: E501 line too long (130 > 79 characters)
    f"Updated product names written to data_export/product_hierarchy_updated.csv using {len(GROCERY_ITEMS)} unique grocery items."
                                                                               ^
./services/__init__.py:1:1: D104 Missing docstring in public package
./services/data_preprocessor.py:1:1: D205 1 blank line required between summary line and description
"""
Data preprocessing module for the FreshRetailNet-50K dataset.
Handles feature engineering, missing values, outliers, and normalization.
"""
^
./services/data_preprocessor.py:8:1: F401 'typing.Dict' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./services/data_preprocessor.py:8:1: F401 'typing.List' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./services/data_preprocessor.py:8:1: F401 'typing.Optional' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./services/data_preprocessor.py:8:1: F401 'typing.Any' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./services/data_preprocessor.py:8:1: F401 'typing.Tuple' imported but unused
from typing import Dict, List, Optional, Any, Tuple
^
./services/data_preprocessor.py:9:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./services/data_preprocessor.py:9:1: F401 'datetime.timedelta' imported but unused
from datetime import datetime, timedelta
^
./services/data_preprocessor.py:10:1: F401 'logging' imported but unused
import logging
^
./services/data_preprocessor.py:12:1: F401 'sklearn.impute.SimpleImputer' imported but unused
from sklearn.impute import SimpleImputer  # type: ignore
^
./services/data_preprocessor.py:18:1: D101 Missing docstring in public class
class DataPreprocessor:
^
./services/data_preprocessor.py:45:80: E501 line too long (80 > 79 characters)
        df["is_weekend"] = df["sale_date"].dt.dayofweek.isin([5, 6]).astype(int)
                                                                               ^
./services/data_preprocessor.py:64:80: E501 line too long (82 > 79 characters)
            df["avg_humidity"], q=4, labels=["Low", "Medium", "High", "Very High"]
                                                                               ^
./services/data_preprocessor.py:69:80: E501 line too long (87 > 79 characters)
        df["is_windy"] = (df["avg_wind_level"] > df["avg_wind_level"].median()).astype(
                                                                               ^
./services/data_preprocessor.py:86:80: E501 line too long (85 > 79 characters)
    def _get_weather_condition(self, is_rainy, is_windy, temp_level, humidity_level):
                                                                               ^
./services/data_preprocessor.py:113:80: E501 line too long (82 > 79 characters)
        df["hours_sale_list"] = df["hours_sale"].apply(self.process_sequence_data)
                                                                               ^
./services/data_preprocessor.py:126:80: E501 line too long (81 > 79 characters)
                    else ("Evening_Peak" if np.argmax(x) > 12 else "Midday_Peak")
                                                                               ^
./services/data_preprocessor.py:133:80: E501 line too long (82 > 79 characters)
                len([1 for status in x["hours_stock_status_list"] if status == 0])
                                                                               ^
./services/data_preprocessor.py:152:80: E501 line too long (86 > 79 characters)
        weather_cols = ["avg_temperature", "avg_humidity", "precpt", "avg_wind_level"]
                                                                               ^
./services/data_preprocessor.py:180:80: E501 line too long (81 > 79 characters)
            (df["sale_amount"] < lower_bound) | (df["sale_amount"] > upper_bound)
                                                                               ^
./services/data_preprocessor.py:184:80: E501 line too long (83 > 79 characters)
        df["sale_amount_capped"] = df["sale_amount"].clip(lower_bound, upper_bound)
                                                                               ^
./services/feature_builder.py:1:1: D100 Missing docstring in public module
./services/forecast_service.py:1:1: D100 Missing docstring in public module
import asyncpg  # type: ignore
^
./services/forecast_service.py:1:1: F401 'asyncpg' imported but unused
import asyncpg  # type: ignore
^
./services/forecast_service.py:2:1: F401 'datetime.datetime' imported but unused
from datetime import datetime, timedelta
^
./services/forecast_service.py:3:1: F401 'typing.List' imported but unused
from typing import Dict, List, Optional, Any
^
./services/forecast_service.py:3:1: F401 'typing.Optional' imported but unused
from typing import Dict, List, Optional, Any
^
./services/forecast_service.py:6:1: F401 'asyncio' imported but unused
import asyncio
^
./services/forecast_service.py:21:1: D200 One-line docstring should fit on one line with quotes
    """
    Generate sales forecast for specified parameters.
    """
^
./services/forecast_service.py:28:80: E501 line too long (81 > 79 characters)
    print(f"DEBUG: Model trained status: {getattr(model, 'trained', 'Unknown')}")
                                                                               ^
./services/forecast_service.py:36:80: E501 line too long (81 > 79 characters)
    weather_df = await fetch_weather_data_fn() if fetch_weather_data_fn else None
                                                                               ^
./services/forecast_service.py:40:80: E501 line too long (83 > 79 characters)
    promo_df = await fetch_promotion_data_fn() if fetch_promotion_data_fn else None
                                                                               ^
./services/forecast_service.py:45:80: E501 line too long (86 > 79 characters)
        "DEBUG: DataFrame columns:", df.columns.tolist() if df is not None else "None"
                                                                               ^
./services/forecast_service.py:89:11: F541 f-string is missing placeholders
    print(f"DEBUG: Model configuration:")
          ^
./services/forecast_service.py:90:80: E501 line too long (81 > 79 characters)
    print(f"  - include_holiday: {getattr(model, 'include_holiday', 'Not set')}")
                                                                               ^
./services/forecast_service.py:91:80: E501 line too long (81 > 79 characters)
    print(f"  - include_weather: {getattr(model, 'include_weather', 'Not set')}")
                                                                               ^
./services/forecast_service.py:92:80: E501 line too long (87 > 79 characters)
    print(f"  - include_promotions: {getattr(model, 'include_promotions', 'Not set')}")
                                                                               ^
./services/forecast_service.py:93:80: E501 line too long (83 > 79 characters)
    print(f"  - forecast_periods: {getattr(model, 'forecast_periods', 'Not set')}")
                                                                               ^
./services/forecast_service.py:137:80: E501 line too long (88 > 79 characters)
            mask = (promo_flags["ds"] >= promo_start) & (promo_flags["ds"] <= promo_end)
                                                                               ^
./services/forecast_service.py:142:80: E501 line too long (82 > 79 characters)
                promo_start = max(pd.to_datetime(promo["start_date"]), start_date)
                                                                               ^
./services/forecast_service.py:147:80: E501 line too long (80 > 79 characters)
                promo_flags.loc[mask, "discount"] = promo["discount_percentage"]
                                                                               ^
./services/forecast_service.py:148:80: E501 line too long (81 > 79 characters)
        future_features.update({"promo_flag": promo_flags[["ds", "promo_flag"]]})
                                                                               ^
./services/forecast_service.py:150:80: E501 line too long (81 > 79 characters)
            future_features.update({"discount": promo_flags[["ds", "discount"]]})
                                                                               ^
./services/forecast_service.py:151:80: E501 line too long (81 > 79 characters)
        print(f"DEBUG: Promotion features added: {list(future_features.keys())}")
                                                                               ^
./services/forecast_service.py:162:80: E501 line too long (80 > 79 characters)
    print(f"DEBUG: Base future dataframe columns: {future_df.columns.tolist()}")
                                                                               ^
./services/forecast_service.py:166:80: E501 line too long (81 > 79 characters)
            print(f"DEBUG: Merging feature '{feature}' into future dataframe...")
                                                                               ^
./services/forecast_service.py:168:80: E501 line too long (85 > 79 characters)
            print(f"DEBUG: Feature dataframe columns: {feature_df.columns.tolist()}")
                                                                               ^
./services/forecast_service.py:170:80: E501 line too long (82 > 79 characters)
            print(f"DEBUG: Future dataframe shape after merge: {future_df.shape}")
                                                                               ^
./services/forecast_service.py:181:80: E501 line too long (111 > 79 characters)
            f"DEBUG: Forecast completed. Shape: {forecast.shape if hasattr(forecast, 'shape') else 'No shape'}"
                                                                               ^
./services/forecast_service.py:184:80: E501 line too long (117 > 79 characters)
            f"DEBUG: Forecast columns: {forecast.columns.tolist() if hasattr(forecast, 'columns') else 'No columns'}"
                                                                               ^
./services/forecast_service.py:187:80: E501 line too long (97 > 79 characters)
            f"DEBUG: Forecast head: {forecast.head() if hasattr(forecast, 'head') else forecast}"
                                                                               ^
./services/forecast_service.py:194:80: E501 line too long (80 > 79 characters)
    forecast_data = forecast[["ds", "yhat", "yhat_lower", "yhat_upper"]].rename(
                                                                               ^
./services/forecast_service.py:203:80: E501 line too long (86 > 79 characters)
    print(f"DEBUG: Processed forecast data columns: {forecast_data.columns.tolist()}")
                                                                               ^
./services/forecast_service.py:210:80: E501 line too long (87 > 79 characters)
    print(f"DEBUG: Response created with {len(response['forecast'])} forecast records")
                                                                               ^
./services/forecast_service.py:229:80: E501 line too long (92 > 79 characters)
# Promotion analysis, stockout analysis, holiday impact analysis, and fetch_*_data functions
                                                                               ^
./services/forecast_service.py:242:1: D205 1 blank line required between summary line and description
    """
    Async fetch historical sales data from the database using asyncpg.
    Ensures all required columns are present in the DataFrame.
    """
^
./services/forecast_service.py:248:9: F811 redefinition of unused 'datetime' from line 2
        from datetime import datetime
        ^
./services/forecast_service.py:257:11: W291 trailing whitespace
    query = """
    SELECT 
        sd.dt as sale_date,
        sd.store_id,
        sd.product_id,
        sd.first_category_id AS category_id,
        sd.city_id,
        sd.sale_amount,
        sd.discount,
        sd.stock_hour6_22_cnt,
        sd.holiday_flag,
        sd.activity_flag as promo_flag,
        sd.precpt,
        sd.avg_temperature,
        sd.avg_humidity,
        sd.avg_wind_level,
        sd.created_at
    FROM sales_data sd
    WHERE 1=1
    """
          ^
./services/forecast_service.py:357:1: D200 One-line docstring should fit on one line with quotes
    """
    Async fetch weather data from the database using asyncpg.
    """
^
./services/forecast_service.py:362:9: F811 redefinition of unused 'datetime' from line 2
        from datetime import datetime
        ^
./services/forecast_service.py:371:11: W291 trailing whitespace
    query = """
    SELECT 
        city_id,
        date,
        temp_avg,
        humidity,
        precipitation,
        wind_speed,
        weather_condition
    FROM weather_data
    WHERE 1=1
    """
          ^
./services/forecast_service.py:415:1: D205 1 blank line required between summary line and description
    """
    Async fetch promotion data from the database using asyncpg.
    Ensures all required columns are present in the DataFrame, including store_id, product_id, start_date, end_date.
    """
^
./services/forecast_service.py:417:80: E501 line too long (116 > 79 characters)
    """
    Async fetch promotion data from the database using asyncpg.
    Ensures all required columns are present in the DataFrame, including store_id, product_id, start_date, end_date.
    """
       
                                                               
       ^
./services/forecast_service.py:421:9: F811 redefinition of unused 'datetime' from line 2
        from datetime import datetime
        ^
./services/forecast_service.py:430:11: W291 trailing whitespace
    query = """
    SELECT 
        pe.store_id,
        pe.product_id,
        ph.first_category_id,
        pe.start_date,
        pe.end_date,
        pe.promotion_type,
        pe.discount_percentage
    FROM promotion_events pe
    JOIN product_hierarchy ph ON pe.product_id = ph.product_id
    WHERE 1=1
    """
          ^
./services/forecast_service.py:504:1: D200 One-line docstring should fit on one line with quotes
    """
    Async fetch holiday data from the database using asyncpg.
    """
^
./services/forecast_service.py:509:9: F811 redefinition of unused 'datetime' from line 2
        from datetime import datetime
        ^
./services/forecast_service.py:518:11: W291 trailing whitespace
    query = """
    SELECT 
        date,
        holiday_name,
        holiday_type,
        significance
    FROM holiday_calendar
    WHERE 1=1
    """
          ^
./services/forecast_service.py:546:80: E501 line too long (143 > 79 characters)
# The analyze_* functions can be made async if they need to await DB or other async calls, otherwise they can remain sync if only using pandas.
                                                                               ^
./services/forecast_service.py:549:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def analyze_promotion_effectiveness(
^
./services/forecast_service.py:552:1: D205 1 blank line required between summary line and description
    """
    Analyze promotion effectiveness for specified parameters.
    Ensures required columns are present.
    """
^
./services/forecast_service.py:592:80: E501 line too long (88 > 79 characters)
                        df.at[idx, "discount_percentage"] = promo["discount_percentage"]
                                                                               ^
./services/forecast_service.py:630:80: E501 line too long (85 > 79 characters)
                analysis["uplift_mean"].mean() if "uplift_mean" in analysis else None
                                                                               ^
./services/forecast_service.py:633:80: E501 line too long (87 > 79 characters)
                analysis["uplift_mean"].median() if "uplift_mean" in analysis else None
                                                                               ^
./services/forecast_service.py:643:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def analyze_stockout(df: pd.DataFrame, request) -> Dict[str, Any]:
^
./services/forecast_service.py:644:1: D205 1 blank line required between summary line and description
    """
    Analyze the impact of stockouts and estimate demand during stockout periods.
    Ensures required columns are present.
    """
^
./services/forecast_service.py:645:80: E501 line too long (80 > 79 characters)
    """
    Analyze the impact of stockouts and estimate demand during stockout periods.
    Ensures required columns are present.
    """
       
                                                                       ^
./services/forecast_service.py:674:80: E501 line too long (84 > 79 characters)
            stockout_days["estimated_demand"] = pd.Series(stockout_days["dow"]).map(
                                                                               ^
./services/forecast_service.py:678:80: E501 line too long (80 > 79 characters)
                stockout_days["estimated_demand"] - stockout_days["sale_amount"]
                                                                               ^
./services/forecast_service.py:680:80: E501 line too long (83 > 79 characters)
            stockout_days["lost_sales"] = stockout_days["lost_sales"].clip(lower=0)
                                                                               ^
./services/forecast_service.py:683:80: E501 line too long (86 > 79 characters)
                columns=["sale_date", "estimated_demand", "lost_sales", "sale_amount"]
                                                                               ^
./services/forecast_service.py:689:80: E501 line too long (84 > 79 characters)
                stockout_days["lost_sales"].mean() if stockout_days_count > 0 else 0
                                                                               ^
./services/forecast_service.py:724:1: ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
async def analyze_holiday_impact(
^
./services/forecast_service.py:727:1: D200 One-line docstring should fit on one line with quotes
    """
    Analyze the impact of holidays on sales.
    """
^
./services/forecast_service.py:771:80: E501 line too long (88 > 79 characters)
            (sales_lift / comparison_avg_sales) * 100 if comparison_avg_sales > 0 else 0
                                                                               ^
./services/forecast_service.py:783:80: E501 line too long (82 > 79 characters)
                    holiday["holiday_type"] if "holiday_type" in holiday else None
                                                                               ^
./services/model_loader.py:1:1: D100 Missing docstring in public module
import os
^
./services/model_loader.py:13:1: D200 One-line docstring should fit on one line with quotes
    """
    Get or initialize the forecast model. Loads from disk if not already loaded.
    """
^
./services/model_loader.py:14:80: E501 line too long (80 > 79 characters)
    """
    Get or initialize the forecast model. Loads from disk if not already loaded.
    """
       
                                                                       ^
./services/model_loader.py:30:1: D200 One-line docstring should fit on one line with quotes
    """
    Get or initialize the promotion uplift model. Loads from disk if not already loaded.
    """
^
./services/model_loader.py:31:80: E501 line too long (88 > 79 characters)
    """
    Get or initialize the promotion uplift model. Loads from disk if not already loaded.
    """
       
                                                                       ^
./services/promotion_logic.py:1:1: D100 Missing docstring in public module
from typing import List, Dict, Any, Optional
^
./services/promotion_logic.py:2:1: F401 'datetime.timedelta' imported but unused
from datetime import datetime, timedelta
^
./services/promotion_logic.py:18:1: D205 1 blank line required between summary line and description
    """
    Simulate different discount levels and recommend promotions based on uplift model.
    Returns recommendations and summary statistics.
    """
^
./services/promotion_logic.py:19:80: E501 line too long (86 > 79 characters)
    """
    Simulate different discount levels and recommend promotions based on uplift model.
    Returns recommendations and summary statistics.
    """
       
                                                                       ^
./services/promotion_logic.py:42:49: E712 comparison to False should be 'if cond is False:' or 'if not cond:'
            combo_data[combo_data["promo_flag"] == False]["sale_amount"].mean()
                                                ^
./services/promotion_logic.py:52:80: E501 line too long (92 > 79 characters)
                # Handle different return types from model.predict with proper type checking
                                                                               ^
./services/promotion_logic.py:55:80: E501 line too long (80 > 79 characters)
                elif hasattr(pred_uplift_result, "__iter__") and not isinstance(
                                                                               ^
./services/promotion_logic.py:82:80: E501 line too long (80 > 79 characters)
                    if isinstance(value, (int, float, str)) and pd.notna(value):
                                                                               ^
./services/promotion_logic.py:92:80: E501 line too long (83 > 79 characters)
                    f"Error predicting uplift for {combo}: {str(e)}", exc_info=True
                                                                               ^
./services/promotion_logic.py:109:80: E501 line too long (88 > 79 characters)
        avg_roi = sum(float(rec["estimated_roi"]) for rec in top_recommendations) / len(
                                                                               ^
./services/promotion_logic.py:126:80: E501 line too long (85 > 79 characters)
            "target_date": target_date.strftime("%Y-%m-%d") if target_date else None,
                                                                               ^
./services/shap_explainer.py:1:1: D100 Missing docstring in public module
./setup.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Setup script for FreshRetail Forecasting.
"""
^
./setup.py:5:1: F401 'os' imported but unused
import os
^
./setup.py:19:80: E501 line too long (98 > 79 characters)
    description="Forecasting solution using FreshRetailNet-50K dataset with Supabase integration",
                                                                               ^
./tests/__init__.py:1:1: D104 Missing docstring in public package
./tests/test_forecast.py:1:1: D100 Missing docstring in public module
./utils/__init__.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
FreshRetail Forecasting utilities package.
"""
^
./utils/db_connector.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
Database connector utility for Supabase.
"""
^
./utils/db_connector.py:14:1: D205 1 blank line required between summary line and description
    """
    Connector class for Supabase operations.
    Uses environment variables for configuration.
    """
^
./utils/db_connector.py:20:1: D200 One-line docstring should fit on one line with quotes
        """
        Initialize the Supabase connector with credentials from environment variables.
        """
^
./utils/db_connector.py:21:80: E501 line too long (86 > 79 characters)
        """
        Initialize the Supabase connector with credentials from environment variables.
        """
           
                                                                   ^
./utils/db_connector.py:32:80: E501 line too long (102 > 79 characters)
                "Missing Supabase credentials. Please set SUPABASE_URL and SUPABASE_KEY in .env file."
                                                                               ^
./utils/db_connector.py:39:1: D205 1 blank line required between summary line and description
        """
        Execute a SQL statement directly using the Supabase REST API with service role.
        This is specifically for DDL statements that can't be executed through RPC.

        Args:
            query: SQL query to execute (CREATE TABLE, etc.)

        Returns:
            Boolean indicating success
        """
^
./utils/db_connector.py:40:80: E501 line too long (87 > 79 characters)
        """
        Execute a SQL statement directly using the Supabase REST API with service role.
        This is specifically for DDL statements that can't be executed through RPC.

        Args:
            query: SQL query to execute (CREATE TABLE, etc.)

        Returns:
            Boolean indicating success
        """
           
                                                                   ^
./utils/db_connector.py:41:80: E501 line too long (83 > 79 characters)
        """
        Execute a SQL statement directly using the Supabase REST API with service role.
        This is specifically for DDL statements that can't be executed through RPC.

        Args:
            query: SQL query to execute (CREATE TABLE, etc.)

        Returns:
            Boolean indicating success
        """
           
                                                                   ^
./utils/db_connector.py:51:80: E501 line too long (109 > 79 characters)
                "Warning: SUPABASE_SERVICE_KEY not set, using regular key which may have limited permissions"
                                                                               ^
./utils/db_connector.py:80:80: E501 line too long (86 > 79 characters)
                print(f"SQL execution error: {response.status_code}, {response.text}")
                                                                               ^
./utils/db_connector.py:109:80: E501 line too long (83 > 79 characters)
            response = self.client.rpc("exec_sql", {"query_text": query}).execute()
                                                                               ^
./utils/db_connector.py:165:80: E501 line too long (87 > 79 characters)
                response.data[0] if hasattr(response, "data") and response.data else {}
                                                                               ^
./utils/db_connector.py:199:80: E501 line too long (82 > 79 characters)
    def delete(self, table: str, filters: Dict[str, Any]) -> List[Dict[str, Any]]:
                                                                               ^
./utils/logger.py:1:1: D100 Missing docstring in public module
./utils/mapping_data.py:2:80: E501 line too long (88 > 79 characters)
"""
This module provides mapping dictionaries to translate encoded IDs to real-world values.

These are used to make the data more interpretable in the UI and reports.
"""
   
                                                                           ^
./utils/mapping_data.py:35:80: E501 line too long (80 > 79 characters)
    4: {"name": "Central Mart", "format": "Hypermarket", "size": "Extra Large"},
                                                                               ^
./utils/mapping_data.py:42:80: E501 line too long (82 > 79 characters)
    11: {"name": "Harbor View Market", "format": "Supermarket", "size": "Medium"},
                                                                               ^
./utils/mapping_data.py:44:80: E501 line too long (80 > 79 characters)
    13: {"name": "Parkside Grocery", "format": "Supermarket", "size": "Medium"},
                                                                               ^
./utils/mapping_data.py:45:80: E501 line too long (87 > 79 characters)
    14: {"name": "Industrial District Market", "format": "Warehouse", "size": "Large"},
                                                                               ^
./utils/mapping_data.py:48:80: E501 line too long (86 > 79 characters)
    17: {"name": "Business District Mart", "format": "Supermarket", "size": "Medium"},
                                                                               ^
./utils/mapping_data.py:50:80: E501 line too long (80 > 79 characters)
    19: {"name": "Beach Road Foods", "format": "Supermarket", "size": "Medium"},
                                                                               ^
./utils/mapping_data.py:83:1: D400 First line should end with a period
    """Convert discount rate (where 1.0 is no discount) to percentage off"""
^
./utils/validators.py:1:1: D100 Missing docstring in public module
8     ASYNC102 await inside try/finally on line 94 must have shielded cancel scope with a timeout.
6     ASYNC124 Async function with no `await` could be sync. Async functions are more expensive to call.
2     B007 Loop control variable 'feature' not used within the loop body. If this is intended, start the name with an underscore.
25    B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
16    D100 Missing docstring in public module
1     D101 Missing docstring in public class
1     D102 Missing docstring in public method
9     D103 Missing docstring in public function
3     D104 Missing docstring in public package
2     D107 Missing docstring in __init__
35    D200 One-line docstring should fit on one line with quotes
13    D205 1 blank line required between summary line and description
52    D400 First line should end with a period
7     D401 First line should be in imperative mood
9     E402 module level import not at top of file
279   E501 line too long (85 > 79 characters)
1     E712 comparison to False should be 'if cond is False:' or 'if not cond:'
74    F401 'datetime.datetime' imported but unused
1     F541 f-string is missing placeholders
4     F811 redefinition of unused 'datetime' from line 2
3     F821 undefined name 'mean_absolute_error'
4     F841 local variable 'metrics' is assigned to but never used
25    W291 trailing whitespace
Searching for test report files in directories named [test-results, failsafe-reports, test-reports, TestResults, surefire-reports] down to a depth of 4
Finished scanning for test reports. Found 0 test report files.
Merged test suites, total number tests is 0, with 0 failures and 0 errors.
